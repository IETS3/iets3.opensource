/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */


 /*
 * Do not modify!
 */



apply from: 'ddgconfig.gradle'



def java_args_config = {

  main = 'DepDataGen.build.util.ddg.cmd_tool.cmd_tool.DdgPipeRunner'

  //provide the paths to your projects here as java-args
  if(remote){
      args '---r'
      args "${url}"
  }
  else{
      args '---l'
  }

  args '---a-p-u'
  args "${plugins_location}"

  ddg_use_cases.each { use_case ->
      args "${use_case}"
  }

  //class path for ddg
  classpath file('ddg-pipe.jar')
  classpath file('./gc-client.jar')
  classpath file('./ddg.jar')
  classpath fileTree('./dm.client.lib/')

  //mps-specific class path
  classpath file('jdi.jar')

  classpath fileTree("${mps_home}/lib") // $mps_home points to the MPS installation
  classpath fileTree("${mps_home}/plugins")
}


// ############################# new-graph-version ##################

task newVersion_defaultGraph(type: JavaExec){
  main = 'ddg.util.external_graphdb_management.NewVersion_GradleOnly'
  //class path for ddg
  classpath file('ddg-pipe.jar')
  classpath file('./gc-client.jar')
  classpath file('./ddg.jar')
  classpath fileTree('./dm.client.lib/')

  args "default_graph"
  if(remote){
      args "${url}"
  }
  else{
      args "http://localhost:4434"
  }
}

// ######################### devel-test ############################

task devel(type: JavaExec) {

    configure java_args_config

    //args '---new'

    args '---vp'
    args 'DEVEL'

    args '---f'
    args '/Users/hbaechmann/repositories/dv/mps.dependency.management.server/code/languages/'
}

// ########################## composite-cases #################

task run_all_appl(){
    dependsOn {
        tasks.findAll {task -> task.name.startsWith('run_appl_')}
    }
}

task run_all_mbeddr(){
    dependsOn {
        tasks.findAll {task -> task.name.startsWith('run_mbeddr_')}
    }
}

task run_all_iets3(){
    dependsOn {
        tasks.findAll {task -> task.name.startsWith('run_iets3_')}
    }
}

task run_all_without_closed_source(){
    dependsOn {
        run_iets3_opensource
    }
    dependsOn {
        run_all_mbeddr
    }
    dependsOn {
        run_all_appl
    }
    dependsOn {
        run_all_mps_extensions
    }
    dependsOn {
        run_tools_mbeddr_eclipseDebugger
    }
}

task run_all_mps_extensions(){
    dependsOn {
        run_mps_extensions
    }
}

task run_all(){
    dependsOn {
        run_all_without_closed_source
    }
    dependsOn {
        run_iets3_core
    }
}


// #####################
// ##################### iets3 #####################

task run_iets3_opensource(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'iets3.opensource'

    args '---f'
    args "${projects_home}/iets3.opensource/code/languages/org.iets3.opensource"
}

task run_iets3_core(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'iets3.core'

    args '---f'
    args "${projects_home}/iets3.core/code/languages/org.iets3.core"
}

// #######################
// ####################### mbeddr ################


task run_mbeddr_analyses(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core'

    args '---f'
    args "${projects_home}/mbeddr.core/code/languages/com.mbeddr.analyses"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"
}

task run_mbeddr_build(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core'

    args '---f'
    args "${projects_home}/mbeddr.core/code/languages/com.mbeddr.build"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"
}

task run_mbeddr_cc(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core'

    args '---f'
    args "${projects_home}/mbeddr.core/code/languages/com.mbeddr.cc"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"
}


task run_mbeddr_core(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core'

    args '---f'
    args "${projects_home}/mbeddr.core/code/languages/com.mbeddr.core"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"

    args '---a-p-u'
    args "${application_support_plugins_location}"
}

task run_mbeddr_debugger(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core'

    args '---f'
    args "${projects_home}/mbeddr.core/code/languages/com.mbeddr.debugger"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"
}

//fails
task run_mbeddr_debugger_tests(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core'

    args '---f'
    args "${projects_home}/mbeddr.core/code/languages/com.mbeddr.debugger.tests"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"
}

task run_mbeddr_doc(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core'

    args '---f'
    args "${projects_home}/mbeddr.core/code/languages/com.mbeddr.doc"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"
}

task run_mbeddr_doc_aspect(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core'

    args '---f'
    args "${projects_home}/mbeddr.core/code/languages/com.mbeddr.doc.aspect"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"
}

task run_mbeddr_ext(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core'

    args '---f'
    args "${projects_home}/mbeddr.core/code/languages/com.mbeddr.ext"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"
}

//exception: socket closed -> maybe not all data send
task run_mbeddr_mpsutil(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core'

    args '---f'
    args "${projects_home}/mbeddr.core/code/languages/com.mbeddr.mpsutil"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"
}

task run_mbeddr_rcp(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core'

    args '---f'
    args "${projects_home}/mbeddr.core/code/languages/com.mbeddr.rcp"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"
}

task run_mbeddr_spawner(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core'

    args '---f'
    args "${projects_home}/mbeddr.core/code/languages/com.mbeddr.spawner"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"
}

task run_mbeddr_xmodel(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core'

    args '---f'
    args "${projects_home}/mbeddr.core/code/languages/com.mbeddr.xmodel"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"
}

// #################
// ################# applications #################

//fails
task run_appl_mbeddr_buildExamples(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core'

    args '---f'
    args "${projects_home}/mbeddr.core/code/applications/com.mbeddr.build-examples"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"
}

task run_appl_mbeddr_documentation(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core'

    args '---f'
    args "${projects_home}/mbeddr.core/code/applications/com.mbeddr.documentation"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"
}

task run_appl_mbeddr_embedded(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core'

    args '---f'
    args "${projects_home}/mbeddr.core/code/applications/com.mbeddr.embedded"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"
}

task run_appl_heartBleed(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core'

    args '---f'
    args "${projects_home}/mbeddr.core/code/applications/HeartBleed"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"
}

task run_appl_integratedCExample(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core'

    args '---f'
    args "${projects_home}/mbeddr.core/code/applications/IntegratedCExample"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"
}

task run_appl_pacemaker(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core'

    args '---f'
    args "${projects_home}/mbeddr.core/code/applications/Pacemaker"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"
}

task run_appl_tutorial(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core'

    args '---f'
    args "${projects_home}/mbeddr.core/code/applications/tutorial"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"
}

task run_appl_tutorialDslsExtension(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core'

    args '---f'
    args "${projects_home}/mbeddr.core/code/applications/tutorial-dsls-extensions"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"
}

// ############
// ############ tools #############

task run_tools_mbeddr_eclipseDebugger(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mbeddr.core.tools'

    args '---f'
    args "${projects_home}/mbeddr.core/tools/Eclipse.Debugger"

    args '---macro'
    args "${mgch}"
    args "${mgch_path}"
}


// ###################### MPS-extensions #######################################

task run_mps_extensions(type: JavaExec) {

    configure java_args_config

    args '---vp'
    args 'mps.extensions'

    args '---f'
    args "${projects_home}/MPS-extensions/code"
}
