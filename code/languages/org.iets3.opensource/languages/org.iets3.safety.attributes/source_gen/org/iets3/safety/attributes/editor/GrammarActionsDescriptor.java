package org.iets3.safety.attributes.editor;

/*Generated by MPS */

import com.mbeddr.mpsutil.grammarcells.runtime.AbstractGrammarActionDescriptor;
import com.mbeddr.mpsutil.grammarcells.runtime.IGrammarActionsDescriptor;
import java.util.List;
import jetbrains.mps.openapi.editor.menus.substitute.SubstituteMenuItem;
import jetbrains.mps.openapi.editor.menus.substitute.SubstituteMenuContext;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import java.util.ArrayList;
import jetbrains.mps.lang.editor.menus.EditorMenuDescriptorBase;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.smodel.SNodePointer;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import org.jetbrains.mps.openapi.language.SConcept;
import com.mbeddr.mpsutil.grammarcells.runtime.GrammarCellsUtil;
import org.jetbrains.mps.openapi.language.SEnumerationLiteral;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SEnumOperations;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import com.mbeddr.mpsutil.grammarcells.runtime.menu.GrammarCellsSubstituteMenuItem;
import org.jetbrains.mps.openapi.language.SProperty;
import org.jetbrains.mps.openapi.model.SNode;
import org.jetbrains.annotations.NotNull;
import jetbrains.mps.smodel.action.SNodeFactoryOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import jetbrains.mps.openapi.editor.menus.transformation.TransformationMenuItem;
import jetbrains.mps.openapi.editor.menus.transformation.TransformationMenuContext;
import jetbrains.mps.lang.editor.menus.transformation.MenuLocations;
import jetbrains.mps.openapi.editor.cells.SubstituteAction;
import jetbrains.mps.smodel.IOperationContext;
import jetbrains.mps.smodel.action.NodeSubstituteActionsFactoryContext;
import com.mbeddr.mpsutil.grammarcells.runtime.IToken;
import com.mbeddr.mpsutil.grammarcells.runtime.IRule;
import org.jetbrains.mps.openapi.model.SModel;
import java.util.Set;
import org.jetbrains.mps.openapi.language.SLanguage;

public class GrammarActionsDescriptor extends AbstractGrammarActionDescriptor implements IGrammarActionsDescriptor {

  public static final GrammarActionsDescriptor INSTANCE = new GrammarActionsDescriptor();

  @Override
  public List<SubstituteMenuItem> getActions(final SubstituteMenuContext _context, final SAbstractConcept expectedOutputConceptExactly) {
    final List<SubstituteMenuItem> result = ListSequence.fromList(new ArrayList<SubstituteMenuItem>());

    _context.getEditorMenuTrace().pushTraceInfo();
    _context.getEditorMenuTrace().setDescriptor(new EditorMenuDescriptorBase("org.iets3.safety.attributes.editor.GrammarActionsDescriptor.getActions", null));
    try {
      ListSequence.fromList(result).addSequence(Sequence.fromIterable(new Object() {
        public Iterable<SubstituteMenuItem> query() {
          List<SubstituteMenuItem> result = ListSequence.fromList(new ArrayList<SubstituteMenuItem>());
          _context.getEditorMenuTrace().pushTraceInfo();
          _context.getEditorMenuTrace().setDescriptor(new EditorMenuDescriptorBase("grammar.wrap in " + "ASILLevelValue", new SNodePointer("r:3b78324a-aac6-4514-8f58-7817fbbaa8f9(org.iets3.safety.attributes.editor)", "1970998948988091549")));
          try {
            if (SConceptOperations.isExactly(SNodeOperations.asSConcept(expectedOutputConceptExactly), CONCEPTS.ASILLevelValue$fW)) {
              for (SConcept subconcept : ListSequence.fromList(GrammarCellsUtil.getVisibleSubconceptsNonAbstract(CONCEPTS.ASILLevelValue$fW, _context.getModel(), ASILLevelValue_Editor.class, _context.getEditorContext()))) {
                final SConcept outputConcept = ((SConcept) subconcept);

                final SAbstractConcept expectedOutputConcept = GrammarCellsUtil.getExpectedOutputConcept(_context, expectedOutputConceptExactly);

                if (SConceptOperations.isSubConceptOf(SNodeOperations.asSConcept(outputConcept), SNodeOperations.asSConcept(expectedOutputConcept))) {
                  boolean isApplicable = GrammarCellsUtil.canBeChild(subconcept, _context);
                  if (isApplicable) {
                    List<SEnumerationLiteral> enumLiterals = SEnumOperations.getMembers(MetaAdapterFactory.getEnumeration(0x3d5cb9202b5f4dcbL, 0x834968b4bf077e63L, 0x3ce7d4897445a3c0L, "org.iets3.safety.attributes.structure.ASILLevelEnum"));

                    for (final SEnumerationLiteral literal : enumLiterals) {
                      ListSequence.fromList(result).addElement(new GrammarCellsSubstituteMenuItem(_context) {
                        private SProperty myProperty = PROPS.value$wS9f;
                        public String getMatchingText(String pattern) {
                          return SEnumOperations.getMemberPresentation(literal);
                        }


                        @Override
                        public SNode createNode(@NotNull String pattern) {
                          SNode newNode = SNodeFactoryOperations.createNewNode(outputConcept, null);
                          SPropertyOperations.assignEnum(newNode, PROPS.value$wS9f, literal);

                          return newNode;
                        }
                        @Override
                        public void select(@NotNull SNode newNode, @NotNull String pattern) {
                          super.select(newNode, pattern);
                        }
                        @Override
                        public SAbstractConcept getOutputConcept() {
                          return CONCEPTS.ASILLevelValue$fW;
                        }
                      });
                    }
                  }
                }
              }
            }
          } finally {
            _context.getEditorMenuTrace().popTraceInfo();
          }
          return ListSequence.fromList(result).where((it) -> it != null).toList();
        }
      }.query()));
      ListSequence.fromList(result).addSequence(Sequence.fromIterable(new Object() {
        public Iterable<SubstituteMenuItem> query() {
          List<SubstituteMenuItem> result = ListSequence.fromList(new ArrayList<SubstituteMenuItem>());
          _context.getEditorMenuTrace().pushTraceInfo();
          _context.getEditorMenuTrace().setDescriptor(new EditorMenuDescriptorBase("grammar.wrap in " + "ControllabilityValue", new SNodePointer("r:3b78324a-aac6-4514-8f58-7817fbbaa8f9(org.iets3.safety.attributes.editor)", "99492279538812224")));
          try {
            if (SConceptOperations.isExactly(SNodeOperations.asSConcept(expectedOutputConceptExactly), CONCEPTS.ControllabilityValue$80)) {
              for (SConcept subconcept : ListSequence.fromList(GrammarCellsUtil.getVisibleSubconceptsNonAbstract(CONCEPTS.ControllabilityValue$80, _context.getModel(), ControllabilityValue_Editor.class, _context.getEditorContext()))) {
                final SConcept outputConcept = ((SConcept) subconcept);

                final SAbstractConcept expectedOutputConcept = GrammarCellsUtil.getExpectedOutputConcept(_context, expectedOutputConceptExactly);

                if (SConceptOperations.isSubConceptOf(SNodeOperations.asSConcept(outputConcept), SNodeOperations.asSConcept(expectedOutputConcept))) {
                  boolean isApplicable = GrammarCellsUtil.canBeChild(subconcept, _context);
                  if (isApplicable) {
                    List<SEnumerationLiteral> enumLiterals = SEnumOperations.getMembers(MetaAdapterFactory.getEnumeration(0x3d5cb9202b5f4dcbL, 0x834968b4bf077e63L, 0x710b4f5487c7a161L, "org.iets3.safety.attributes.structure.ControllabilityEnum"));

                    for (final SEnumerationLiteral literal : enumLiterals) {
                      ListSequence.fromList(result).addElement(new GrammarCellsSubstituteMenuItem(_context) {
                        private SProperty myProperty = PROPS.value$Yy4w;
                        public String getMatchingText(String pattern) {
                          return SEnumOperations.getMemberPresentation(literal);
                        }


                        @Override
                        public SNode createNode(@NotNull String pattern) {
                          SNode newNode = SNodeFactoryOperations.createNewNode(outputConcept, null);
                          SPropertyOperations.assignEnum(newNode, PROPS.value$Yy4w, literal);

                          return newNode;
                        }
                        @Override
                        public void select(@NotNull SNode newNode, @NotNull String pattern) {
                          super.select(newNode, pattern);
                        }
                        @Override
                        public SAbstractConcept getOutputConcept() {
                          return CONCEPTS.ControllabilityValue$80;
                        }
                      });
                    }
                  }
                }
              }
            }
          } finally {
            _context.getEditorMenuTrace().popTraceInfo();
          }
          return ListSequence.fromList(result).where((it) -> it != null).toList();
        }
      }.query()));
      ListSequence.fromList(result).addSequence(Sequence.fromIterable(new Object() {
        public Iterable<SubstituteMenuItem> query() {
          List<SubstituteMenuItem> result = ListSequence.fromList(new ArrayList<SubstituteMenuItem>());
          _context.getEditorMenuTrace().pushTraceInfo();
          _context.getEditorMenuTrace().setDescriptor(new EditorMenuDescriptorBase("grammar.wrap in " + "ExposureValue", new SNodePointer("r:3b78324a-aac6-4514-8f58-7817fbbaa8f9(org.iets3.safety.attributes.editor)", "99492279538812246")));
          try {
            if (SConceptOperations.isExactly(SNodeOperations.asSConcept(expectedOutputConceptExactly), CONCEPTS.ExposureValue$av)) {
              for (SConcept subconcept : ListSequence.fromList(GrammarCellsUtil.getVisibleSubconceptsNonAbstract(CONCEPTS.ExposureValue$av, _context.getModel(), ExposureValue_Editor.class, _context.getEditorContext()))) {
                final SConcept outputConcept = ((SConcept) subconcept);

                final SAbstractConcept expectedOutputConcept = GrammarCellsUtil.getExpectedOutputConcept(_context, expectedOutputConceptExactly);

                if (SConceptOperations.isSubConceptOf(SNodeOperations.asSConcept(outputConcept), SNodeOperations.asSConcept(expectedOutputConcept))) {
                  boolean isApplicable = GrammarCellsUtil.canBeChild(subconcept, _context);
                  if (isApplicable) {
                    List<SEnumerationLiteral> enumLiterals = SEnumOperations.getMembers(MetaAdapterFactory.getEnumeration(0x3d5cb9202b5f4dcbL, 0x834968b4bf077e63L, 0x710b4f5487c7a133L, "org.iets3.safety.attributes.structure.ExposureEnum"));

                    for (final SEnumerationLiteral literal : enumLiterals) {
                      ListSequence.fromList(result).addElement(new GrammarCellsSubstituteMenuItem(_context) {
                        private SProperty myProperty = PROPS.value$YAJn;
                        public String getMatchingText(String pattern) {
                          return SEnumOperations.getMemberPresentation(literal);
                        }


                        @Override
                        public SNode createNode(@NotNull String pattern) {
                          SNode newNode = SNodeFactoryOperations.createNewNode(outputConcept, null);
                          SPropertyOperations.assignEnum(newNode, PROPS.value$YAJn, literal);

                          return newNode;
                        }
                        @Override
                        public void select(@NotNull SNode newNode, @NotNull String pattern) {
                          super.select(newNode, pattern);
                        }
                        @Override
                        public SAbstractConcept getOutputConcept() {
                          return CONCEPTS.ExposureValue$av;
                        }
                      });
                    }
                  }
                }
              }
            }
          } finally {
            _context.getEditorMenuTrace().popTraceInfo();
          }
          return ListSequence.fromList(result).where((it) -> it != null).toList();
        }
      }.query()));
      ListSequence.fromList(result).addSequence(Sequence.fromIterable(new Object() {
        public Iterable<SubstituteMenuItem> query() {
          List<SubstituteMenuItem> result = ListSequence.fromList(new ArrayList<SubstituteMenuItem>());
          _context.getEditorMenuTrace().pushTraceInfo();
          _context.getEditorMenuTrace().setDescriptor(new EditorMenuDescriptorBase("grammar.wrap in " + "SeverityValue", new SNodePointer("r:3b78324a-aac6-4514-8f58-7817fbbaa8f9(org.iets3.safety.attributes.editor)", "99492279538812268")));
          try {
            if (SConceptOperations.isExactly(SNodeOperations.asSConcept(expectedOutputConceptExactly), CONCEPTS.SeverityValue$XT)) {
              for (SConcept subconcept : ListSequence.fromList(GrammarCellsUtil.getVisibleSubconceptsNonAbstract(CONCEPTS.SeverityValue$XT, _context.getModel(), SeverityValue_Editor.class, _context.getEditorContext()))) {
                final SConcept outputConcept = ((SConcept) subconcept);

                final SAbstractConcept expectedOutputConcept = GrammarCellsUtil.getExpectedOutputConcept(_context, expectedOutputConceptExactly);

                if (SConceptOperations.isSubConceptOf(SNodeOperations.asSConcept(outputConcept), SNodeOperations.asSConcept(expectedOutputConcept))) {
                  boolean isApplicable = GrammarCellsUtil.canBeChild(subconcept, _context);
                  if (isApplicable) {
                    List<SEnumerationLiteral> enumLiterals = SEnumOperations.getMembers(MetaAdapterFactory.getEnumeration(0x3d5cb9202b5f4dcbL, 0x834968b4bf077e63L, 0x710b4f5487c7a116L, "org.iets3.safety.attributes.structure.SeverityEnum"));

                    for (final SEnumerationLiteral literal : enumLiterals) {
                      ListSequence.fromList(result).addElement(new GrammarCellsSubstituteMenuItem(_context) {
                        private SProperty myProperty = PROPS.value$aIqG;
                        public String getMatchingText(String pattern) {
                          return SEnumOperations.getMemberPresentation(literal);
                        }


                        @Override
                        public SNode createNode(@NotNull String pattern) {
                          SNode newNode = SNodeFactoryOperations.createNewNode(outputConcept, null);
                          SPropertyOperations.assignEnum(newNode, PROPS.value$aIqG, literal);

                          return newNode;
                        }
                        @Override
                        public void select(@NotNull SNode newNode, @NotNull String pattern) {
                          super.select(newNode, pattern);
                        }
                        @Override
                        public SAbstractConcept getOutputConcept() {
                          return CONCEPTS.SeverityValue$XT;
                        }
                      });
                    }
                  }
                }
              }
            }
          } finally {
            _context.getEditorMenuTrace().popTraceInfo();
          }
          return ListSequence.fromList(result).where((it) -> it != null).toList();
        }
      }.query()));
    } finally {
      _context.getEditorMenuTrace().popTraceInfo();
    }

    return ListSequence.fromList(result).where((it) -> it != null).toList();
  }

  @Override
  protected List<TransformationMenuItem> doGetSideTransformActions(final TransformationMenuContext _context) {
    final List<TransformationMenuItem> result = ListSequence.fromList(new ArrayList<TransformationMenuItem>());

    _context.getEditorMenuTrace().pushTraceInfo();
    _context.getEditorMenuTrace().setDescriptor(new EditorMenuDescriptorBase("org.iets3.safety.attributes.editor.GrammarActionsDescriptor.doGetSideTransformActions", null));
    try {
      {
        boolean sideEnabled = false;
        sideEnabled |= _context.getMenuLocation() == MenuLocations.LEFT_SIDE_TRANSFORM;
        sideEnabled |= _context.getMenuLocation() == MenuLocations.RIGHT_SIDE_TRANSFORM;
        if (sideEnabled) {
          ListSequence.fromList(result).addSequence(Sequence.fromIterable(new Object() {
            public Iterable<TransformationMenuItem> query(final TransformationMenuContext _context) {
              List<TransformationMenuItem> result = ListSequence.fromList(new ArrayList<TransformationMenuItem>());
              _context.getEditorMenuTrace().pushTraceInfo();
              _context.getEditorMenuTrace().setDescriptor(new EditorMenuDescriptorBase("grammar.wrap in " + "ASILLevelValue", new SNodePointer("r:3b78324a-aac6-4514-8f58-7817fbbaa8f9(org.iets3.safety.attributes.editor)", "1970998948988091549")));
              try {
              } finally {
                _context.getEditorMenuTrace().popTraceInfo();
              }
              return ListSequence.fromList(result).where((it) -> it != null).toList();
            }
          }.query(_context)));
        }
      }
      {
        boolean sideEnabled = false;
        sideEnabled |= _context.getMenuLocation() == MenuLocations.LEFT_SIDE_TRANSFORM;
        sideEnabled |= _context.getMenuLocation() == MenuLocations.RIGHT_SIDE_TRANSFORM;
        if (sideEnabled) {
          ListSequence.fromList(result).addSequence(Sequence.fromIterable(new Object() {
            public Iterable<TransformationMenuItem> query(final TransformationMenuContext _context) {
              List<TransformationMenuItem> result = ListSequence.fromList(new ArrayList<TransformationMenuItem>());
              _context.getEditorMenuTrace().pushTraceInfo();
              _context.getEditorMenuTrace().setDescriptor(new EditorMenuDescriptorBase("grammar.wrap in " + "ControllabilityValue", new SNodePointer("r:3b78324a-aac6-4514-8f58-7817fbbaa8f9(org.iets3.safety.attributes.editor)", "99492279538812224")));
              try {
              } finally {
                _context.getEditorMenuTrace().popTraceInfo();
              }
              return ListSequence.fromList(result).where((it) -> it != null).toList();
            }
          }.query(_context)));
        }
      }
      {
        boolean sideEnabled = false;
        sideEnabled |= _context.getMenuLocation() == MenuLocations.LEFT_SIDE_TRANSFORM;
        sideEnabled |= _context.getMenuLocation() == MenuLocations.RIGHT_SIDE_TRANSFORM;
        if (sideEnabled) {
          ListSequence.fromList(result).addSequence(Sequence.fromIterable(new Object() {
            public Iterable<TransformationMenuItem> query(final TransformationMenuContext _context) {
              List<TransformationMenuItem> result = ListSequence.fromList(new ArrayList<TransformationMenuItem>());
              _context.getEditorMenuTrace().pushTraceInfo();
              _context.getEditorMenuTrace().setDescriptor(new EditorMenuDescriptorBase("grammar.wrap in " + "ExposureValue", new SNodePointer("r:3b78324a-aac6-4514-8f58-7817fbbaa8f9(org.iets3.safety.attributes.editor)", "99492279538812246")));
              try {
              } finally {
                _context.getEditorMenuTrace().popTraceInfo();
              }
              return ListSequence.fromList(result).where((it) -> it != null).toList();
            }
          }.query(_context)));
        }
      }
      {
        boolean sideEnabled = false;
        sideEnabled |= _context.getMenuLocation() == MenuLocations.LEFT_SIDE_TRANSFORM;
        sideEnabled |= _context.getMenuLocation() == MenuLocations.RIGHT_SIDE_TRANSFORM;
        if (sideEnabled) {
          ListSequence.fromList(result).addSequence(Sequence.fromIterable(new Object() {
            public Iterable<TransformationMenuItem> query(final TransformationMenuContext _context) {
              List<TransformationMenuItem> result = ListSequence.fromList(new ArrayList<TransformationMenuItem>());
              _context.getEditorMenuTrace().pushTraceInfo();
              _context.getEditorMenuTrace().setDescriptor(new EditorMenuDescriptorBase("grammar.wrap in " + "SeverityValue", new SNodePointer("r:3b78324a-aac6-4514-8f58-7817fbbaa8f9(org.iets3.safety.attributes.editor)", "99492279538812268")));
              try {
              } finally {
                _context.getEditorMenuTrace().popTraceInfo();
              }
              return ListSequence.fromList(result).where((it) -> it != null).toList();
            }
          }.query(_context)));
        }
      }
    } finally {
      _context.getEditorMenuTrace().popTraceInfo();
    }

    return ListSequence.fromList(result).where((it) -> it != null).toList();
  }

  @Override
  public List<SubstituteAction> getConstantReplaceActions(final IOperationContext operationContext, final NodeSubstituteActionsFactoryContext _context, final List<IToken> elementsBefore, final List<IToken> elementsAfter) {
    final List<SubstituteAction> result = ListSequence.fromList(new ArrayList<SubstituteAction>());

    return ListSequence.fromList(result).where((it) -> it != null).toList();
  }

  @Override
  public List<IRule> getRules(final SModel contextModel) {
    final List<IRule> rules = ListSequence.fromList(new ArrayList<IRule>());

    final Set<SLanguage> visibleLanguages = GrammarCellsUtil.getVisibleLanguages(contextModel);


    return rules;
  }

  private static final class PROPS {
    /*package*/ static final SProperty value$wS9f = MetaAdapterFactory.getProperty(0x3d5cb9202b5f4dcbL, 0x834968b4bf077e63L, 0x1b5a6519ee9e81e2L, 0x1b5a6519ee9e81e6L, "value");
    /*package*/ static final SProperty value$Yy4w = MetaAdapterFactory.getProperty(0x3d5cb9202b5f4dcbL, 0x834968b4bf077e63L, 0x710b4f5487c7a15dL, 0x710b4f5487c8b047L, "value");
    /*package*/ static final SProperty value$YAJn = MetaAdapterFactory.getProperty(0x3d5cb9202b5f4dcbL, 0x834968b4bf077e63L, 0x710b4f5487c7a132L, 0x710b4f5487c8b04aL, "value");
    /*package*/ static final SProperty value$aIqG = MetaAdapterFactory.getProperty(0x3d5cb9202b5f4dcbL, 0x834968b4bf077e63L, 0x710b4f5487c7a12dL, 0x710b4f5487c7a12eL, "value");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept ASILLevelValue$fW = MetaAdapterFactory.getConcept(0x3d5cb9202b5f4dcbL, 0x834968b4bf077e63L, 0x1b5a6519ee9e81e2L, "org.iets3.safety.attributes.structure.ASILLevelValue");
    /*package*/ static final SConcept ControllabilityValue$80 = MetaAdapterFactory.getConcept(0x3d5cb9202b5f4dcbL, 0x834968b4bf077e63L, 0x710b4f5487c7a15dL, "org.iets3.safety.attributes.structure.ControllabilityValue");
    /*package*/ static final SConcept ExposureValue$av = MetaAdapterFactory.getConcept(0x3d5cb9202b5f4dcbL, 0x834968b4bf077e63L, 0x710b4f5487c7a132L, "org.iets3.safety.attributes.structure.ExposureValue");
    /*package*/ static final SConcept SeverityValue$XT = MetaAdapterFactory.getConcept(0x3d5cb9202b5f4dcbL, 0x834968b4bf077e63L, 0x710b4f5487c7a12dL, "org.iets3.safety.attributes.structure.SeverityValue");
  }
}
