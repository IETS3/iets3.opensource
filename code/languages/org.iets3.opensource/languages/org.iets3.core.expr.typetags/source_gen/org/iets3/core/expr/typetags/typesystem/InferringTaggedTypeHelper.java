package org.iets3.core.expr.typetags.typesystem;

/*Generated by MPS */

import org.iets3.core.expr.typetags.behavior.BaseTaggedTypeHelper;
import jetbrains.mps.lang.typesystem.dependencies.InferenceMethod;
import jetbrains.mps.typesystem.inference.TypeCheckingContext;
import org.jetbrains.mps.openapi.model.SNode;
import java.util.Collection;
import jetbrains.mps.internal.collections.runtime.CollectionSequence;
import java.util.ArrayList;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import org.iets3.core.expr.typetags.behavior.TaggedType__BehaviorDescriptor;
import jetbrains.mps.typesystem.inference.EquationInfo;
import org.jetbrains.mps.openapi.language.SConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;

public class InferringTaggedTypeHelper extends BaseTaggedTypeHelper {

  @InferenceMethod
  public static void inferWithFlavor(final TypeCheckingContext typeCheckingContext, final SNode nodeToType, final SNode nodeWithType, final SNode... tags) {
    final Collection<SNode> _tags = CollectionSequence.fromCollection(new ArrayList<SNode>());
    for (SNode value : tags) {
      CollectionSequence.fromCollection(_tags).addElement(value);
    }

    {
      final SNode type = typeCheckingContext.typeOf(nodeWithType, "r:42a3bc53-29b1-44d6-9767-7c921cef7ba0(org.iets3.core.expr.typetags.typesystem)", "5431729334750084904", true);
      typeCheckingContext.whenConcrete(type, () -> {
        SNode result = null;
        if (SNodeOperations.isInstanceOf(typeCheckingContext.getExpandedNode(type), CONCEPTS.TaggedType$O4)) {
          result = TaggedType__BehaviorDescriptor.addTags_id4HxogODPWH$.invoke(SNodeOperations.cast(typeCheckingContext.getExpandedNode(type), CONCEPTS.TaggedType$O4), _tags);
        } else {
          result = TaggedType__BehaviorDescriptor.create_id4HxogODQaID.invoke(SNodeOperations.asSConcept(CONCEPTS.TaggedType$O4), SNodeOperations.cast(typeCheckingContext.getExpandedNode(type), CONCEPTS.Type$WK), _tags);
        }
        {
          SNode _nodeToCheck_1029348928467 = nodeToType;
          EquationInfo _info_12389875345 = new EquationInfo(_nodeToCheck_1029348928467, null, "r:42a3bc53-29b1-44d6-9767-7c921cef7ba0(org.iets3.core.expr.typetags.typesystem)", "5431729334750085846", 0, null);
          typeCheckingContext.createEquation((SNode) typeCheckingContext.typeOf(_nodeToCheck_1029348928467, "r:42a3bc53-29b1-44d6-9767-7c921cef7ba0(org.iets3.core.expr.typetags.typesystem)", "5431729334750085647", true), (SNode) result, _info_12389875345);
        }
      }, "r:42a3bc53-29b1-44d6-9767-7c921cef7ba0(org.iets3.core.expr.typetags.typesystem)", "5431729334750084741", false, false);
    }
  }

  @InferenceMethod
  public static void assignTaggedType(final TypeCheckingContext typeCheckingContext, final SNode nodeToType, final SNode baseType, final SNode... tags) {
    final Collection<SNode> _tags = CollectionSequence.fromCollection(new ArrayList<SNode>());
    for (SNode value : tags) {
      CollectionSequence.fromCollection(_tags).addElement(value);
    }
    assignTaggedType(typeCheckingContext, nodeToType, baseType, _tags);
  }

  @InferenceMethod
  public static void assignTaggedType(final TypeCheckingContext typeCheckingContext, final SNode nodeToType, final SNode baseType, final Collection<SNode> tags) {
    SNode result = null;
    if (SNodeOperations.isInstanceOf(baseType, CONCEPTS.TaggedType$O4)) {
      result = TaggedType__BehaviorDescriptor.addTags_id4HxogODPWH$.invoke(SNodeOperations.cast(baseType, CONCEPTS.TaggedType$O4), tags);
    } else {
      result = TaggedType__BehaviorDescriptor.create_id4HxogODQaID.invoke(SNodeOperations.asSConcept(CONCEPTS.TaggedType$O4), SNodeOperations.cast(baseType, CONCEPTS.Type$WK), tags);
    }
    {
      SNode _nodeToCheck_1029348928467 = nodeToType;
      EquationInfo _info_12389875345 = new EquationInfo(_nodeToCheck_1029348928467, null, "r:42a3bc53-29b1-44d6-9767-7c921cef7ba0(org.iets3.core.expr.typetags.typesystem)", "6866407013262353607", 0, null);
      typeCheckingContext.createEquation((SNode) typeCheckingContext.typeOf(_nodeToCheck_1029348928467, "r:42a3bc53-29b1-44d6-9767-7c921cef7ba0(org.iets3.core.expr.typetags.typesystem)", "6866407013262353611", true), (SNode) result, _info_12389875345);
    }
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept TaggedType$O4 = MetaAdapterFactory.getConcept(0x5186c6ce428c4f09L, 0xa9df73d9e86c27d3L, 0x186a8ed9947750b6L, "org.iets3.core.expr.typetags.structure.TaggedType");
    /*package*/ static final SConcept Type$WK = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x670d5e92f854a614L, "org.iets3.core.expr.base.structure.Type");
  }
}
