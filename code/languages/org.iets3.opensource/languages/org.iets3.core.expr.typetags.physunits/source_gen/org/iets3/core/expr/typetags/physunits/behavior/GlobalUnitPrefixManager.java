package org.iets3.core.expr.typetags.physunits.behavior;

/*Generated by MPS */

import org.jetbrains.mps.openapi.model.SNode;
import org.jetbrains.mps.openapi.language.SEnumerationLiteral;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SEnumOperations;
import java.util.Objects;
import org.jetbrains.mps.openapi.language.SConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;

public class GlobalUnitPrefixManager {

  public static AbstractUnitPrefixManager getManager(SNode isourceUnit) {
    return getManager(isourceUnit, isourceUnit);
  }

  public static AbstractUnitPrefixManager getManager(SNode isourceUnit, SNode itargetUnit) {

    SEnumerationLiteral sourceScaling = UnitConversionUtil.getScaling(SNodeOperations.as(isourceUnit, CONCEPTS.Unit$Gq));
    SEnumerationLiteral targetScaling = UnitConversionUtil.getScaling(SNodeOperations.as(itargetUnit, CONCEPTS.Unit$Gq));

    if (!(SEnumOperations.isMember(sourceScaling, 0x244b2b88a69f2ff2L))) {
      return getManager(sourceScaling);
    } else if (!(SEnumOperations.isMember(targetScaling, 0x244b2b88a69f2ff2L))) {
      return getManager(targetScaling);
    } else {
      return DecimalMetricUnitPrefixManager.getInstance();
    }
  }

  public static AbstractUnitPrefixManager getManager(SEnumerationLiteral scalingType) {
    if (SEnumOperations.isMember(scalingType, 0x244b2b88a69f2ff3L) || SEnumOperations.isMember(scalingType, 0x244b2b88a69f2ff2L)) {
      return DecimalMetricUnitPrefixManager.getInstance();
    } else if (SEnumOperations.isMember(scalingType, 0x48da63eea2d878c3L)) {
      return PositiveDecimalMetricUnitPrefixManager.getInstance();
    } else if (SEnumOperations.isMember(scalingType, 0x48da63eea2d878c4L)) {
      return NegativeDecimalMetricUnitPrefixManager.getInstance();
    } else if (SEnumOperations.isMember(scalingType, 0x244b2b88a69f2ff6L)) {
      return BinaryIECUnitPrefixManager.getInstance();
    } else {
      return BinaryMemoryPrefixManager.getInstance();
    }
  }

  public static boolean areScalingsCompatible(SEnumerationLiteral sourceScaling, SEnumerationLiteral targetScaling) {
    if (SEnumOperations.isMember(sourceScaling, 0x244b2b88a69f2ff2L) || SEnumOperations.isMember(targetScaling, 0x244b2b88a69f2ff2L)) {
      return true;
    }

    if ((SEnumOperations.isMember(sourceScaling, 0x244b2b88a69f2ff3L) || SEnumOperations.isMember(sourceScaling, 0x48da63eea2d878c4L) || SEnumOperations.isMember(sourceScaling, 0x48da63eea2d878c3L)) && (SEnumOperations.isMember(targetScaling, 0x244b2b88a69f2ff3L) || SEnumOperations.isMember(targetScaling, 0x48da63eea2d878c4L) || SEnumOperations.isMember(targetScaling, 0x48da63eea2d878c3L))) {
      return true;
    }

    return Objects.equals(sourceScaling, targetScaling);
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept Unit$Gq = MetaAdapterFactory.getConcept(0x7ee265bd59864709L, 0x86ed2c6daa33cd8cL, 0x73b48a125b0d373fL, "org.iets3.core.expr.typetags.physunits.structure.Unit");
  }
}
