package org.iets3.core.expr.typetags.physunits.intentions;

/*Generated by MPS */

import jetbrains.mps.intentions.AbstractIntentionDescriptor;
import jetbrains.mps.openapi.intentions.IntentionFactory;
import java.util.Collection;
import jetbrains.mps.openapi.intentions.IntentionExecutable;
import jetbrains.mps.openapi.intentions.Kind;
import jetbrains.mps.smodel.SNodePointer;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.openapi.editor.EditorContext;
import java.util.Collections;
import jetbrains.mps.intentions.AbstractIntentionExecutable;
import org.iets3.core.expr.typetags.physunits.behavior.UnitConversionUtil;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.openapi.intentions.IntentionDescriptor;
import jetbrains.mps.smodel.builder.SNodeBuilder;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SReferenceLink;
import org.jetbrains.mps.openapi.language.SProperty;
import org.jetbrains.mps.openapi.language.SConcept;

public final class CreateQuantityForUnit_Intention extends AbstractIntentionDescriptor implements IntentionFactory {
  private Collection<IntentionExecutable> myCachedExecutable;

  public CreateQuantityForUnit_Intention() {
    super(Kind.NORMAL, true, new SNodePointer("r:08172548-524d-46a0-a2ce-05e98e1d278b(org.iets3.core.expr.typetags.physunits.intentions)", "7682951809393409038"));
  }

  @Override
  public String getPresentation() {
    return "CreateQuantityForUnit";
  }

  @Override
  public boolean isSurroundWith() {
    return false;
  }

  public Collection<IntentionExecutable> instances(final SNode node, final EditorContext context) {
    if (myCachedExecutable == null) {
      myCachedExecutable = Collections.<IntentionExecutable>singletonList(new IntentionImplementation());
    }
    return myCachedExecutable;
  }
  /*package*/ final class IntentionImplementation extends AbstractIntentionExecutable {
    public IntentionImplementation() {
    }

    @Override
    public String getDescription(final SNode node, final EditorContext editorContext) {
      return "Derive A Quantity";
    }

    @Override
    public void execute(final SNode node, final EditorContext editorContext) {
      SNode newSpecification = UnitConversionUtil.createQuantitySpecificationForUnit(node);
      SNode newQuantity = createQuantity_4k6yab_a0b0a(((SLinkOperations.getTarget(newSpecification, LINKS.specification$WwUP) != null) ? newSpecification : null), (SLinkOperations.getTarget(newSpecification, LINKS.specification$WwUP) != null), SPropertyOperations.getString(node, PROPS.name$MnvL) + "_Quantity");

      SLinkOperations.setTarget(node, LINKS.quantity$tnl1, newQuantity);
      SNodeOperations.insertPrevSiblingChild(node, newQuantity);
    }

    @Override
    public boolean isApplicable(final SNode node, final EditorContext editorContext) {
      if (!(isApplicableToNode(node, editorContext))) {
        return false;
      }
      return true;
    }

    private boolean isApplicableToNode(final SNode node, final EditorContext editorContext) {
      return SNodeOperations.getContainingLink(node).isMultiple() && (SLinkOperations.getTarget(node, LINKS.quantity$tnl1) == null) && CONCEPTS.Quantity$W4.isSubConceptOf(SNodeOperations.getContainingLink(node).getTargetConcept());
    }


    @Override
    public IntentionDescriptor getDescriptor() {
      return CreateQuantityForUnit_Intention.this;
    }

  }
  private static SNode createQuantity_4k6yab_a0b0a(SNode p0, boolean p1, String p2) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.Quantity$W4);
    n0.forChild(LINKS.specification$Tp$k).initNode(p0, CONCEPTS.QuantitySpecification$4N, true);
    n0.setProperty(PROPS.derived$jMUI, "" + (p1));
    n0.setProperty(PROPS.name$MnvL, p2);
    return n0.getResult();
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink specification$WwUP = MetaAdapterFactory.getContainmentLink(0x7ee265bd59864709L, 0x86ed2c6daa33cd8cL, 0x729d46b7ce8b64dcL, 0x729d46b7ce8b6885L, "specification");
    /*package*/ static final SReferenceLink quantity$tnl1 = MetaAdapterFactory.getReferenceLink(0x7ee265bd59864709L, 0x86ed2c6daa33cd8cL, 0x73b48a125b0d373fL, 0x1c3a590e2b660f1aL, "quantity");
    /*package*/ static final SContainmentLink specification$Tp$k = MetaAdapterFactory.getContainmentLink(0x7ee265bd59864709L, 0x86ed2c6daa33cd8cL, 0x668417ae62c5c36cL, 0x668417ae62c5ca21L, "specification");
  }

  private static final class PROPS {
    /*package*/ static final SProperty name$MnvL = MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name");
    /*package*/ static final SProperty derived$jMUI = MetaAdapterFactory.getProperty(0x7ee265bd59864709L, 0x86ed2c6daa33cd8cL, 0x1c3a590e2b660f17L, 0x79d6409d180fb6c1L, "derived");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept Quantity$W4 = MetaAdapterFactory.getConcept(0x7ee265bd59864709L, 0x86ed2c6daa33cd8cL, 0x1c3a590e2b660f17L, "org.iets3.core.expr.typetags.physunits.structure.Quantity");
    /*package*/ static final SConcept QuantitySpecification$4N = MetaAdapterFactory.getConcept(0x7ee265bd59864709L, 0x86ed2c6daa33cd8cL, 0x729d46b7ce8b64dcL, "org.iets3.core.expr.typetags.physunits.structure.QuantitySpecification");
  }
}
