package org.iets3.core.expr.base.behavior;

/*Generated by MPS */

import com.mbeddr.mpsutil.interpreter.rt.ICoverageAnalyzer;
import java.awt.Color;
import com.intellij.ui.JBColor;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import org.jetbrains.annotations.NotNull;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.baseLanguage.tuples.runtime.Tuples;
import jetbrains.mps.baseLanguage.closures.runtime._FunctionTypes;
import java.util.List;
import java.util.Set;
import org.jetbrains.mps.openapi.language.SLanguage;
import org.jetbrains.annotations.Nullable;

public interface IDefaultCoverageAnalyzer extends ICoverageAnalyzer {
  String COVERED = "Covered.";
  String MISSING = "Missing.";
  String PARTIAL = "Partial.";
  String IGNORED = "Ignored.";

  Color COVERED_COLOR = new JBColor(new Color(23, 191, 0), new Color(23, 191, 0));
  Color MISSING_COLOR = new JBColor(Color.red, Color.red);
  Color PARTIAL_COLOR = new JBColor(new Color(237, 134, 0), new Color(237, 134, 0));
  Color IGNORED_COLOR = new JBColor(new Color(244, 244, 244), new Color(244, 244, 244));

  Color CODE_COVERED_COLOR = new JBColor(Color.decode("#C4FFE2"), Color.decode("#C4FFE2"));
  Color CODE_MISSING_COLOR = new JBColor(Color.decode("#FFE3E7"), Color.decode("#FFE3E7"));
  Color CODE_PARTIAL_COLOR = new JBColor(Color.decode("#FEFFD4"), Color.decode("#FEFFD4"));
  Color CODE_IGNORE = new JBColor(Color.decode("#F4F4F4"), Color.decode("#F4F4F4"));

  interface IConceptData {
    void registerBranches(String[] branches);
    SAbstractConcept concept();
    void visitBranch(@NotNull String branchID);
    boolean isComplete();
    String status();
    Color color();
    void visited();
    Iterable<String> unvisitedBranches();
  }

  interface INodeCoverage {
    int getCoverageRatio();
    void updateResultStatus();
    String getStatus();
    SNode getNode();
    int totalVisitable();
  }

  interface IValueCoverage {
    String getName();
    Object getValue();
    boolean storeValueInsteadOfOldOne(Object newValue, Object oldValue);
    Object valueToBeStored(Object newValue);
    void registerValue(Object newValue);
    Tuples._2<String, Object> result();
  }

  interface IValueStatistics {
    void newValue(String key, Object newValue);
    void registerAnalyzer(IValueCoverage analyzer);
    Iterable<? extends IValueCoverage> getData();
    boolean isEmpty();
  }

  class InstanceHolder {
    private static _FunctionTypes._return_P0_E0<? extends IDefaultCoverageAnalyzer> CREATOR = () -> new DefaultCoverageAnalyzer();
    private static IDefaultCoverageAnalyzer INSTANCE;
    private static IDefaultCoverageAnalyzer get() {
      if (INSTANCE == null) {
        INSTANCE = newInstance();
      }
      return INSTANCE;
    }

  }

  InstanceHolder INSTANCE_HOLDER = new InstanceHolder();

  static void setCreator(_FunctionTypes._return_P0_E0<? extends IDefaultCoverageAnalyzer> creator) {
    INSTANCE_HOLDER.CREATOR = creator;
  }

  static IDefaultCoverageAnalyzer getInstance() {
    return INSTANCE_HOLDER.get();
  }

  static IDefaultCoverageAnalyzer newInstance() {
    return INSTANCE_HOLDER.CREATOR.invoke();
  }

  static void reset() {
    INSTANCE_HOLDER.INSTANCE = newInstance();
    INSTANCE_HOLDER.INSTANCE.setupValueStatistics();
  }
  void setupValueStatistics();

  static int ratio() {
    return getInstance().ratioEx();
  }
  int ratioEx();

  static List<SAbstractConcept> allConcepts() {
    return getInstance().getAllConcepts();
  }
  List<SAbstractConcept> getAllConcepts();

  static Iterable<? extends IConceptData> missingConceptsOrIncomplete() {
    return getInstance().getMissingConceptsOrIncomplete();
  }
  Iterable<? extends IConceptData> getMissingConceptsOrIncomplete();

  static Iterable<? extends IConceptData> allConceptsStatus() {
    return getInstance().getAllConceptsStatus();
  }
  Iterable<? extends IConceptData> getAllConceptsStatus();

  static Set<SNode> allCoveredNodes() {
    return getInstance().getAllCoveredNodes();
  }
  Set<SNode> getAllCoveredNodes();

  static boolean hasNodeCoverage(@NotNull SNode node) {
    return getInstance().hasNodeCoverageEx(node);
  }
  boolean hasNodeCoverageEx(@NotNull SNode node);

  static INodeCoverage getNodeCoverage(@NotNull SNode node) {
    return getInstance().getNodeCoverageEx(node);
  }
  @NotNull
  INodeCoverage getNodeCoverageEx(@NotNull SNode node);

  static boolean isNodeCovered(@NotNull SNode node) {
    return getInstance().isNodeCoveredEx(node);
  }
  boolean isNodeCoveredEx(@NotNull SNode node);

  static boolean isNodePartiallyCovered(@NotNull SNode node) {
    return getInstance().isNodePartiallyCoveredEx(node);
  }
  boolean isNodePartiallyCoveredEx(@NotNull SNode node);

  static boolean isNodeNotCovered(@NotNull SNode node) {
    return getInstance().isNodeNotCoveredEx(node);
  }
  boolean isNodeNotCoveredEx(@NotNull SNode node);

  static void visitNode(@NotNull SNode node) {
    getInstance().visitNodeEx(node);
  }
  void visitNodeEx(@NotNull SNode node);

  static void registerLanguage(@NotNull SLanguage l) {
    getInstance().registerLanguageEx(l);
  }
  void registerLanguageEx(@NotNull SLanguage l);

  static void registerIgnoredConcept(@NotNull SAbstractConcept c) {
    getInstance().registerIgnoredConceptEx(c);
  }
  void registerIgnoredConceptEx(@NotNull SAbstractConcept c);

  static void registerMeasuredConcept(@NotNull SAbstractConcept c) {
    getInstance().registerMeasuredConceptEx(c);
  }
  void registerMeasuredConceptEx(@NotNull SAbstractConcept c);

  static boolean isInInterestingContext(@NotNull SNode n) {
    return getInstance().isInInterestingContextEx(n);
  }
  boolean isInInterestingContextEx(@NotNull SNode n);

  static boolean isInterestingConcept(@NotNull SNode n) {
    return getInstance().isInterestingConceptEx(n);
  }
  boolean isInterestingConceptEx(@NotNull SNode n);

  static IValueStatistics getValueStatistics() {
    return getInstance().getValueStatisticsEx();
  }
  IValueStatistics getValueStatisticsEx();

  static boolean isIgnored(@NotNull SNode n) {
    return getInstance().isIgnoredEx(n);
  }
  boolean isIgnoredEx(@NotNull SNode n);

  static boolean hasData() {
    return getInstance().hasDataEx();
  }
  boolean hasDataEx();

  @Nullable
  Object getValue(@NotNull SNode n);
  @Nullable
  List<Object> getAllValues(@NotNull SNode n);

  static void recordValueStatistic(Object evaluatedValue) {
    getInstance().recordValueStatisticEx(evaluatedValue);
  }
  void recordValueStatisticEx(Object evaluatedValue);
}
