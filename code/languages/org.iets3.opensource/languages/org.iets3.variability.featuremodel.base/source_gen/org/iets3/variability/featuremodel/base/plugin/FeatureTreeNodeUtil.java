package org.iets3.variability.featuremodel.base.plugin;

/*Generated by MPS */

import org.jetbrains.mps.openapi.language.SAbstractConcept;
import org.jetbrains.mps.openapi.model.SNode;
import org.jetbrains.mps.openapi.model.SModel;
import java.util.List;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import org.iets3.core.expr.base.intentions.ConstraintHelper;
import java.util.Objects;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;

public class FeatureTreeNodeUtil {
  public static Iterable<SAbstractConcept> canReplaceNodeWithConcept(SAbstractConcept targetConcept, final SNode node, SModel model) {
    List<SAbstractConcept> subConcepts = SConceptOperations.getAllSubConcepts(((SAbstractConcept) targetConcept), model);
    return ListSequence.fromList(subConcepts).where((it) -> !(it.isAbstract())).where((it) -> ConstraintHelper.canReplaceNodeWithConcept(node, it)).distinct().where((it) -> !(Objects.equals(it, SNodeOperations.getConcept(node))));
  }
}
