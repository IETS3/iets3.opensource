package org.iets3.variability.featuremodel.base.actions;

/*Generated by MPS */

import jetbrains.mps.openapi.actions.descriptor.NodeFactory;
import org.jetbrains.mps.openapi.model.SNode;
import org.jetbrains.mps.openapi.model.SModel;
import jetbrains.mps.smodel.action.SNodeFactoryOperations;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import org.iets3.variability.featuremodel.base.plugin.FeatureTreeNodeUtil;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import org.iets3.variability.featuremodel.base.behavior.ICalculateHashForUpdateWarning__BehaviorDescriptor;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SConcept;
import org.jetbrains.mps.openapi.language.SProperty;

public class FeaturemodelNodeFactories {
  public static class NodeFactory_2340588654203481070 implements NodeFactory {
    public void setup(SNode newNode, SNode sampleNode, SNode enclosingNode, int index, SModel model) {
      if (model == null) {
        SNodeFactoryOperations.setNewChild(newNode, LINKS.root$XEj1, CONCEPTS.Feature$D7);
        return;
      }

      Iterable<SAbstractConcept> canReplaceNodeWithConcept = FeatureTreeNodeUtil.canReplaceNodeWithConcept(CONCEPTS.AbstractFeature$T, SLinkOperations.getTarget(newNode, LINKS.root$XEj1), model);
      if (Sequence.fromIterable(canReplaceNodeWithConcept).count() == 1) {
        SAbstractConcept singleConcept = Sequence.fromIterable(canReplaceNodeWithConcept).first();
        SNode newInstance = SConceptOperations.createNewNode(SNodeOperations.asInstanceConcept(singleConcept));
        SLinkOperations.setTarget(newNode, LINKS.root$XEj1, SNodeOperations.cast(newInstance, CONCEPTS.AbstractFeature$T));
      }

      ICalculateHashForUpdateWarning__BehaviorDescriptor.updateUpdateHash_id6MJy$PGs_q4.invoke(newNode);
      SPropertyOperations.set(newNode, PROPS.solverTaskRunning$ceHc, false);

    }
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink root$XEj1 = MetaAdapterFactory.getContainmentLink(0x165f1d0525064544L, 0x895e1424f54166ecL, 0x375cadc47516a211L, 0x375cadc47516a30cL, "root");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept Feature$D7 = MetaAdapterFactory.getConcept(0x165f1d0525064544L, 0x895e1424f54166ecL, 0x375cadc47516a307L, "org.iets3.variability.featuremodel.base.structure.Feature");
    /*package*/ static final SConcept AbstractFeature$T = MetaAdapterFactory.getConcept(0x165f1d0525064544L, 0x895e1424f54166ecL, 0x6b3fb620c4f9ac90L, "org.iets3.variability.featuremodel.base.structure.AbstractFeature");
  }

  private static final class PROPS {
    /*package*/ static final SProperty solverTaskRunning$ceHc = MetaAdapterFactory.getProperty(0x165f1d0525064544L, 0x895e1424f54166ecL, 0x375cadc47516a211L, 0x59a777a5038d26a0L, "solverTaskRunning");
  }
}
