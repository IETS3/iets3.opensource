package org.iets3.contextfilter.behavior;

/*Generated by MPS */

import org.jetbrains.mps.openapi.model.SNode;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import org.jetbrains.mps.openapi.language.SProperty;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;

public class ContextSelectorHelper {

  public static <T extends AbstractSelectorItem> T getSelectedItem(SNode owner, SAbstractConcept conc) {
    SNode sel = IContextFilterOwner__BehaviorDescriptor.getFirstSelectorOf_id3j0RMEs8lUK.invoke(owner, conc);

    // check if there is a selector of the given ContextSelector concept
    if ((sel != null)) {
      // check if there is a user's choice for this selector
      if (isNotEmptyString(SPropertyOperations.getString(sel, PROPS.choice$2FYK))) {
        AbstractSelectorItem selectedItem = ContextSelector__BehaviorDescriptor.getSelectedItem_id1UWdA_UjxsD.invoke(sel);
        if (ContextSelector__BehaviorDescriptor.getSelectorItemClass_id3j0RMEsazSW.invoke(sel).isInstance(selectedItem)) {
          // we have an actual result of type T
          return (T) selectedItem;
        }
      }
    }

    // no result
    return null;
  }

  private static boolean isNotEmptyString(String str) {
    return str != null && str.length() > 0;
  }

  private static final class PROPS {
    /*package*/ static final SProperty choice$2FYK = MetaAdapterFactory.getProperty(0xdcb9d48f1fb64793L, 0x88cff6f4971432a5L, 0x1ebc36697a4d55b9L, 0x1ebc36697a4e1680L, "choice");
  }
}
