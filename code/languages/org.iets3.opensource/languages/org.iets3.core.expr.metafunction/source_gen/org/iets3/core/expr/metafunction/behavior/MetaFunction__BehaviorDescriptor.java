package org.iets3.core.expr.metafunction.behavior;

/*Generated by MPS */

import jetbrains.mps.core.aspects.behaviour.BaseBHDescriptor;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import jetbrains.mps.core.aspects.behaviour.api.SMethod;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.core.aspects.behaviour.SMethodBuilder;
import jetbrains.mps.core.aspects.behaviour.SJavaCompoundTypeImpl;
import jetbrains.mps.core.aspects.behaviour.AccessPrivileges;
import java.util.List;
import java.util.Arrays;
import org.jetbrains.annotations.NotNull;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import org.iets3.core.expr.base.plugin.EffectDescriptor;
import org.iets3.core.expr.lambda.behavior.EffectTag__BehaviorDescriptor;
import org.iets3.core.expr.base.behavior.IMayHaveEffect__BehaviorDescriptor;
import jetbrains.mps.core.aspects.behaviour.api.SConstructor;
import org.jetbrains.annotations.Nullable;
import jetbrains.mps.core.aspects.behaviour.api.BHMethodNotFoundException;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import org.jetbrains.mps.openapi.language.SProperty;
import org.jetbrains.mps.openapi.language.SInterfaceConcept;

public final class MetaFunction__BehaviorDescriptor extends BaseBHDescriptor {
  private static final SAbstractConcept CONCEPT = MetaAdapterFactory.getConcept(0x711a16d799e84e1dL, 0xb20c99c0b7309cd8L, 0x53300f6d0c251610L, "org.iets3.core.expr.metafunction.structure.MetaFunction");

  public static final SMethod<SNode> addArg_id6dpaV_AQ5Xf = new SMethodBuilder<SNode>(new SJavaCompoundTypeImpl((Class<SNode>) ((Class) Object.class))).name("addArg").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(7158801157976514383L).languageId(0xb20c99c0b7309cd8L, 0x711a16d799e84e1dL).build2(SMethodBuilder.createJavaParameter(String.class, ""), SMethodBuilder.createJavaParameter((Class<SNode>) ((Class) Object.class), ""));
  public static final SMethod<String> getPresentation_idhEwIMiw = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("getPresentation").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(1213877396640L).languageId(0x9b92103b95ca8c0cL, 0xceab519525ea4f22L).build2();
  public static final SMethod<String> allowsEffectForNode_idORfz$DS6Ap = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("allowsEffectForNode").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(952298261448780185L).languageId(0xb66a309a6e1a7290L, 0xcfaa4966b7d54b69L).build2(SMethodBuilder.createJavaParameter((Class<SNode>) ((Class) Object.class), ""));

  private static final List<SMethod<?>> BH_METHODS = Arrays.<SMethod<?>>asList(addArg_id6dpaV_AQ5Xf, getPresentation_idhEwIMiw, allowsEffectForNode_idORfz$DS6Ap);

  private static void ___init___(@NotNull SNode __thisNode__) {
  }

  /*package*/ static SNode addArg_id6dpaV_AQ5Xf(@NotNull SNode __thisNode__, String name, SNode type) {
    SNode arg = SLinkOperations.addNewChild(__thisNode__, LINKS.args$M3Dr, null);
    SPropertyOperations.assign(arg, PROPS.name$MnvL, name);
    SLinkOperations.setTarget(arg, LINKS.type$EhVN, type);
    return __thisNode__;
  }
  /*package*/ static String getPresentation_idhEwIMiw(@NotNull SNode __thisNode__) {
    if (SPropertyOperations.getString(__thisNode__, PROPS.description$c_vH) != null) {
      return SPropertyOperations.getString(__thisNode__, PROPS.description$c_vH);
    }
    return SNodeOperations.getConcept(SNodeOperations.getNodeAncestor(__thisNode__, CONCEPTS.IMetaFunctionContext$aL, false, false)).getName();
  }
  /*package*/ static String allowsEffectForNode_idORfz$DS6Ap(@NotNull SNode __thisNode__, SNode n) {
    if (SLinkOperations.getTarget(__thisNode__, LINKS.effect$J9aq) == null) {
      return "no effects allowed";
    }
    if (!(SNodeOperations.isInstanceOf(n, CONCEPTS.IMayHaveEffect$Gp))) {
      return null;
    }
    EffectDescriptor allowed = EffectTag__BehaviorDescriptor.createDescriptor_id4qVjx3k0U6M.invoke(SLinkOperations.getTarget(__thisNode__, LINKS.effect$J9aq));
    EffectDescriptor needed = IMayHaveEffect__BehaviorDescriptor.effectDescriptor_id6GySMNjjWfO.invoke(SNodeOperations.cast(n, CONCEPTS.IMayHaveEffect$Gp));
    if (allowed.allows(needed)) {
      return null;
    }
    return "required " + needed + " is not allowed by allowed " + allowed;
  }

  /*package*/ MetaFunction__BehaviorDescriptor() {
  }

  @Override
  protected void initNode(@NotNull SNode node, @NotNull SConstructor constructor, @Nullable Object[] parameters) {
    ___init___(node);
  }

  @Override
  protected <T> T invokeSpecial0(@NotNull SNode node, @NotNull SMethod<T> method, @Nullable Object[] parameters) {
    int methodIndex = BH_METHODS.indexOf(method);
    if (methodIndex < 0) {
      throw new BHMethodNotFoundException(this, method);
    }
    switch (methodIndex) {
      case 0:
        return (T) ((SNode) addArg_id6dpaV_AQ5Xf(node, (String) parameters[0], (SNode) parameters[1]));
      case 1:
        return (T) ((String) getPresentation_idhEwIMiw(node));
      case 2:
        return (T) ((String) allowsEffectForNode_idORfz$DS6Ap(node, (SNode) parameters[0]));
      default:
        throw new BHMethodNotFoundException(this, method);
    }
  }

  @Override
  protected <T> T invokeSpecial0(@NotNull SAbstractConcept concept, @NotNull SMethod<T> method, @Nullable Object[] parameters) {
    int methodIndex = BH_METHODS.indexOf(method);
    if (methodIndex < 0) {
      throw new BHMethodNotFoundException(this, method);
    }
    switch (methodIndex) {
      default:
        throw new BHMethodNotFoundException(this, method);
    }
  }

  @NotNull
  @Override
  public List<SMethod<?>> getDeclaredMethods() {
    return BH_METHODS;
  }

  @NotNull
  @Override
  public SAbstractConcept getConcept() {
    return CONCEPT;
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink args$M3Dr = MetaAdapterFactory.getContainmentLink(0x711a16d799e84e1dL, 0xb20c99c0b7309cd8L, 0x53300f6d0c251610L, 0x53300f6d0c251cd3L, "args");
    /*package*/ static final SContainmentLink type$EhVN = MetaAdapterFactory.getContainmentLink(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x622163b5c76a6c48L, 0x7a477bfec24be9a9L, "type");
    /*package*/ static final SContainmentLink effect$J9aq = MetaAdapterFactory.getContainmentLink(0x711a16d799e84e1dL, 0xb20c99c0b7309cd8L, 0x53300f6d0c251610L, 0x34aae0bbdc4877afL, "effect");
  }

  private static final class PROPS {
    /*package*/ static final SProperty name$MnvL = MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name");
    /*package*/ static final SProperty description$c_vH = MetaAdapterFactory.getProperty(0x711a16d799e84e1dL, 0xb20c99c0b7309cd8L, 0x53300f6d0c251610L, 0x4b6c2d32790dfe24L, "description");
  }

  private static final class CONCEPTS {
    /*package*/ static final SInterfaceConcept IMetaFunctionContext$aL = MetaAdapterFactory.getInterfaceConcept(0x711a16d799e84e1dL, 0xb20c99c0b7309cd8L, 0x53300f6d0c25a72bL, "org.iets3.core.expr.metafunction.structure.IMetaFunctionContext");
    /*package*/ static final SInterfaceConcept IMayHaveEffect$Gp = MetaAdapterFactory.getInterfaceConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x6c21639b50c5f96eL, "org.iets3.core.expr.base.structure.IMayHaveEffect");
  }
}
