package org.iets3.core.expr.simpleTypes.plugin;

/*Generated by MPS */

import org.iets3.core.expr.base.plugin.PrimitiveTypeMapper;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.iets3.core.expr.simpleTypes.behavior.NumberType__BehaviorDescriptor;
import org.iets3.core.expr.base.behavior.ISupportHexValues__BehaviorDescriptor;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import org.iets3.core.expr.base.plugin.InfHelper;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import org.iets3.core.expr.simpleTypes.behavior.NumberLiteral__BehaviorDescriptor;
import java.util.List;
import jetbrains.mps.typesystem.inference.SubtypingManager;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.baseLanguage.closures.runtime.Wrappers;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import java.util.ArrayList;
import java.util.Set;
import jetbrains.mps.internal.collections.runtime.SetSequence;
import java.util.HashSet;
import org.iets3.core.expr.base.behavior.JoinType__BehaviorDescriptor;
import java.util.function.Predicate;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import java.util.Iterator;
import java.math.BigInteger;
import java.math.BigDecimal;
import jetbrains.mps.smodel.builder.SNodeBuilder;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import org.jetbrains.mps.openapi.language.SProperty;
import org.jetbrains.mps.openapi.language.SConcept;

public class SimpleTypesPrimitiveTypeMapper extends PrimitiveTypeMapper {
  public int getPriorityLevel() {
    return 0;
  }
  public SNode createBooleanType() {
    return SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x670d5e92f854a617L, "org.iets3.core.expr.simpleTypes.structure.BooleanType"));
  }

  public SNode createIntegerType(String value) {
    return createIntegerType(value, false);
  }

  public SNode createIntegerType(String value, boolean isHexadecimal) {
    SNode numberType = SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x7211e50064d40ea8L, "org.iets3.core.expr.simpleTypes.structure.NumberType"));
    NumberType__BehaviorDescriptor.setSingletonRange_id3p6$WoEqbyP.invoke(numberType, value);
    NumberType__BehaviorDescriptor.setPrecision_id19PglA21KtA.invoke(numberType, ((int) 0));
    if (isHexadecimal) {
      ISupportHexValues__BehaviorDescriptor.setHexValue_id6QsMU1GWQsW.invoke(SLinkOperations.getTarget(numberType, LINKS.range$RnOa), PROPS.min$7OOG, SPropertyOperations.getString(SLinkOperations.getTarget(numberType, LINKS.range$RnOa), PROPS.min$7OOG), ((boolean) true));
      ISupportHexValues__BehaviorDescriptor.setHexValue_id6QsMU1GWQsW.invoke(SLinkOperations.getTarget(numberType, LINKS.range$RnOa), PROPS.max$7P3H, SPropertyOperations.getString(SLinkOperations.getTarget(numberType, LINKS.range$RnOa), PROPS.max$7P3H), ((boolean) true));
    }
    return numberType;
  }

  public SNode createIntegerType(String min, String max) {
    SNode numberType = SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x7211e50064d40ea8L, "org.iets3.core.expr.simpleTypes.structure.NumberType"));
    if (min == null) {
      min = InfHelper.NEGINF;
    }
    if (max == null) {
      max = InfHelper.POSINF;
    }
    NumberType__BehaviorDescriptor.setRange_id6NHlpK$OKdB.invoke(numberType, min, max);
    NumberType__BehaviorDescriptor.setPrecision_id19PglA21KtA.invoke(numberType, ((int) 0));
    return numberType;

  }

  public SNode createIntegerType(String min, boolean minIsHexadecimal, String max, boolean maxIsHexadecimal) {
    SNode numberType = SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x7211e50064d40ea8L, "org.iets3.core.expr.simpleTypes.structure.NumberType"));
    if (min == null) {
      min = InfHelper.NEGINF;
    }
    if (max == null) {
      max = InfHelper.POSINF;
    }
    NumberType__BehaviorDescriptor.setRange_id6NHlpK$OKdB.invoke(numberType, min, max);
    NumberType__BehaviorDescriptor.setPrecision_id19PglA21KtA.invoke(numberType, ((int) 0));

    if (minIsHexadecimal) {
      ISupportHexValues__BehaviorDescriptor.setHexValue_id6QsMU1GWQsW.invoke(SLinkOperations.getTarget(numberType, LINKS.range$RnOa), PROPS.min$7OOG, SPropertyOperations.getString(SLinkOperations.getTarget(numberType, LINKS.range$RnOa), PROPS.min$7OOG), ((boolean) true));
    }
    if (maxIsHexadecimal) {
      ISupportHexValues__BehaviorDescriptor.setHexValue_id6QsMU1GWQsW.invoke(SLinkOperations.getTarget(numberType, LINKS.range$RnOa), PROPS.max$7P3H, SPropertyOperations.getString(SLinkOperations.getTarget(numberType, LINKS.range$RnOa), PROPS.max$7P3H), ((boolean) true));
    }

    return numberType;

  }

  @Override
  public SNode createFalseLiteral() {
    return createFalseLiteral_o7o1hp_a0a11();
  }

  @Override
  public SNode createTrueLiteral() {
    return createTrueLiteral_o7o1hp_a0a31();
  }
  @Override
  public SNode widenToInfinityIfNumber(SNode type) {
    if (SNodeOperations.isInstanceOf(type, CONCEPTS.NumberType$n)) {
      SNode numberType = SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x7211e50064d40ea8L, "org.iets3.core.expr.simpleTypes.structure.NumberType"));
      NumberType__BehaviorDescriptor.setInfinityRange_id3p6$WoElgXM.invoke(numberType);
      NumberType__BehaviorDescriptor.setPrecision_id19PglA21KtA.invoke(numberType, ((int) (int) NumberType__BehaviorDescriptor.precision_id19PglA20ASE.invoke(SNodeOperations.cast(type, CONCEPTS.NumberType$n))));
      return numberType;
    } else {
      return type;
    }
  }

  @Override
  public SNode setInfinitePrecisionIfNotInteger(SNode type) {
    if (SNodeOperations.isInstanceOf(type, CONCEPTS.NumberType$n) && !((boolean) NumberType__BehaviorDescriptor.isInt_id3p6$WoEh1ch.invoke(SNodeOperations.cast(type, CONCEPTS.NumberType$n)))) {
      SNode numberType = SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x7211e50064d40ea8L, "org.iets3.core.expr.simpleTypes.structure.NumberType"));
      NumberType__BehaviorDescriptor.setRange_id6NHlpK$OKdB.invoke(numberType, NumberType__BehaviorDescriptor.lowerBound_id19PglA20zCc.invoke(SNodeOperations.cast(type, CONCEPTS.NumberType$n)), NumberType__BehaviorDescriptor.upperBound_id19PglA20_Su.invoke(SNodeOperations.cast(type, CONCEPTS.NumberType$n)));
      NumberType__BehaviorDescriptor.setInfinitePrecision_id7Wa2sv3G6bK.invoke(numberType);
      return numberType;
    }
    return type;
  }

  public SNode createRealType(String value) {
    if (value == null) {
      return SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x46ff3b3d86d0e74cL, "org.iets3.core.expr.simpleTypes.structure.RealType"));
    } else {
      SNode numberType = SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x7211e50064d40ea8L, "org.iets3.core.expr.simpleTypes.structure.NumberType"));
      NumberType__BehaviorDescriptor.setSingletonRange_id3p6$WoEqbyP.invoke(numberType, value);
      NumberType__BehaviorDescriptor.setPrecisionFromValue_id2RZ2I9pAbPi.invoke(numberType, value);
      return numberType;
    }
  }

  public SNode createStringType() {
    return SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x46ff3b3d86d3edc7L, "org.iets3.core.expr.simpleTypes.structure.StringType"));
  }
  @Override
  public SNode createEmptyType() {
    return SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x374c7c7bc06564e8L, "org.iets3.core.expr.base.structure.EmptyType"));
  }
  public boolean isOtherwiseLiteral(SNode expr) {
    return SNodeOperations.isInstanceOf(expr, CONCEPTS.OtherwiseLiteral$Cj);
  }
  public boolean isTrueLiteral(SNode expr) {
    return SNodeOperations.isInstanceOf(expr, CONCEPTS.TrueLiteral$_K);
  }
  public boolean isFalseLiteral(SNode expr) {
    return SNodeOperations.isInstanceOf(expr, CONCEPTS.FalseLiteral$ik);
  }

  public boolean isRealType(SNode type) {
    if (SNodeOperations.isInstanceOf(type, CONCEPTS.NumberType$n) && (int) NumberType__BehaviorDescriptor.precision_id19PglA20ASE.invoke(SNodeOperations.cast(type, CONCEPTS.NumberType$n)) > 0) {
      return true;
    }
    return super.isRealType(type);
  }

  public SNode createNumberLiteral(String value) {
    return (SNode) NumberLiteral__BehaviorDescriptor.set_id2oUyrt$Tg3c.invoke(SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x46ff3b3d86d0e6daL, "org.iets3.core.expr.simpleTypes.structure.NumberLiteral")), value);
  }

  @Override
  public SNode computeSupertype(List<SNode> types, boolean goToInfinity, SubtypingManager mgr) {

    List<SNode> numberTypes = Sequence.fromIterable(SNodeOperations.ofConcept(types, CONCEPTS.NumberType$n)).toList();
    List<SNode> tupleTypes = Sequence.fromIterable(SNodeOperations.ofConcept(types, CONCEPTS.TupleType$8E)).toList();
    final Wrappers._T<List<SNode>> resultTypes = new Wrappers._T<List<SNode>>(ListSequence.fromList(types).subtract(ListSequence.fromList(numberTypes)).subtract(ListSequence.fromList(tupleTypes)).toList());

    List<SNode> resultTupleTypes = new ArrayList<SNode>();
    if (ListSequence.fromList(tupleTypes).count() > 0) {
      ListSequence.fromList(resultTupleTypes).addSequence(Sequence.fromIterable(computeSupertypeOfTuples(tupleTypes, goToInfinity, mgr)));
    }

    if (ListSequence.fromList(numberTypes).count() > 0) {
      ListSequence.fromList(resultTypes.value).addElement(computeSupertypeOfNumberTypes(numberTypes, goToInfinity));
    }

    resultTypes.value = removeStringTypeWithConstraint(resultTypes.value);

    // The next part is a hack:
    // Because DotExpression  does only operate on sets containing 2 elements,
    // we need to extract the elements from  _field reference  and pass them to the function successively.
    // s.a.: https://youtrack.jetbrains.com/issue/MPSI-45/leastCommonSupertypes-does-not-calculate-correctly-on-tuples-with-multiple-values
    Set<SNode> set = SetSequence.fromSet(new HashSet<SNode>());
    SetSequence.fromSet(set).addElement(ListSequence.fromList(resultTypes.value).first());
    for (SNode type : ListSequence.fromList(resultTypes.value).where((it) -> it != ListSequence.fromList(resultTypes.value).first())) {
      SetSequence.fromSet(set).addElement(type);
      Set<SNode> least = mgr.leastCommonSupertypes(set, false);
      SetSequence.fromSet(set).clear();
      least.removeIf((SNode nn) -> nn.getConcept().isAbstract());
      // No common supertype available:
      if (least.isEmpty()) {
        break;
      }
      // More than one supertype should never occur:
      if (least.size() > 1) {
        // fall back to join-Type
        break;
      } else {
        SetSequence.fromSet(set).addSequence(SetSequence.fromSet(least));
      }
    }
    //  END OF the hack.
    //  Now the set contains the supertype as only element if there is one.
    SNode jt = SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x7edef95a36fc3555L, "org.iets3.core.expr.base.structure.JoinType"));
    if (SetSequence.fromSet(set).count() == 1) {
      ListSequence.fromList(SLinkOperations.getChildren(jt, LINKS.types$MP0E)).addElement(SNodeOperations.as(SetSequence.fromSet(set).iterator().next(), CONCEPTS.Type$WK));
    } else {
      ListSequence.fromList(SLinkOperations.getChildren(jt, LINKS.types$MP0E)).addSequence(Sequence.fromIterable(SNodeOperations.ofConcept(resultTypes.value, CONCEPTS.Type$WK)));
    }
    if (ListSequence.fromList(resultTupleTypes).count() > 0) {
      ListSequence.fromList(SLinkOperations.getChildren(jt, LINKS.types$MP0E)).addSequence(Sequence.fromIterable(SNodeOperations.ofConcept(resultTupleTypes, CONCEPTS.Type$WK)));
    }
    JoinType__BehaviorDescriptor.sortTypes_idH8GgRpqbgk.invoke(jt);
    boolean stringTypeFound = false;
    for (SNode type : ListSequence.fromList(SLinkOperations.getChildren(jt, LINKS.types$MP0E))) {
      if (SNodeOperations.isInstanceOf(type, CONCEPTS.StringType$B3)) {
        if (!(stringTypeFound)) {
          stringTypeFound = true;
        } else {
          ListSequence.fromList(SLinkOperations.getChildren(jt, LINKS.types$MP0E)).removeElement(type);
        }
      }
    }
    SNode emptyType = ListSequence.fromList(SLinkOperations.getChildren(jt, LINKS.types$MP0E)).findFirst((it) -> isEmptyType(it));
    SLinkOperations.getChildren(jt, LINKS.types$MP0E).removeIf(new Predicate<SNode>() {
      @Override
      public boolean test(SNode p1) {
        {
          final SNode t = p1;
          if (SNodeOperations.isInstanceOf(t, CONCEPTS.Type$WK)) {
            return isEmptyType(t);
          }
        }
        return false;
      }
    });
    if (ListSequence.fromList(SLinkOperations.getChildren(jt, LINKS.types$MP0E)).isEmpty()) {
      if ((emptyType != null)) {
        return emptyType;
      }
      return createEmptyType();
    }

    if (ListSequence.fromList(SLinkOperations.getChildren(jt, LINKS.types$MP0E)).count() == 1) {
      return ListSequence.fromList(SLinkOperations.getChildren(jt, LINKS.types$MP0E)).first();
    } else {
      return jt;
    }
  }

  protected List<SNode> removeStringTypeWithConstraint(List<SNode> resultTypes) {
    // the constraint-less supertype string for all string types is not enough, we need to remove the constraint manually
    ListSequence.fromList(resultTypes).visitAll((resultType) -> ListSequence.fromList(SNodeOperations.getNodeDescendants(resultType, CONCEPTS.StringTypeWithConstraint$H$, false, new SAbstractConcept[]{})).visitAll((it) -> SNodeOperations.replaceWithAnother(it, SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x46ff3b3d86d3edc7L, "org.iets3.core.expr.simpleTypes.structure.StringType")))));
    return ListSequence.fromList(resultTypes).select((it) -> {
      if (SNodeOperations.isInstanceOf(it, CONCEPTS.StringTypeWithConstraint$H$)) {
        return SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x46ff3b3d86d3edc7L, "org.iets3.core.expr.simpleTypes.structure.StringType"));
      } else {
        return it;
      }
    }).toList();
  }

  private SNode computeSupertypeOfNumberTypes(List<SNode> types, boolean goToInfinity) {
    SNode res = SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x7211e50064d40ea8L, "org.iets3.core.expr.simpleTypes.structure.NumberType"));
    if (goToInfinity) {
      NumberType__BehaviorDescriptor.setInfinityRange_id3p6$WoElgXM.invoke(res);
    } else {
      String lower = InfHelper.min(ListSequence.fromList(types).select((it) -> NumberType__BehaviorDescriptor.range_id2NHHcg2Ff6S.invoke(it)._0()));
      String upper = InfHelper.max(ListSequence.fromList(types).select((it) -> NumberType__BehaviorDescriptor.range_id2NHHcg2Ff6S.invoke(it)._1()));
      SNode r = SLinkOperations.setNewChild(res, LINKS.range$RnOa, null);
      SPropertyOperations.assign(r, PROPS.min$7OOG, lower);
      SPropertyOperations.assign(r, PROPS.max$7P3H, upper);
    }
    if (ListSequence.fromList(types).any((it) -> (boolean) NumberType__BehaviorDescriptor.isInfinitePrecision_id7Wa2sv3Gi_T.invoke(it))) {
      NumberType__BehaviorDescriptor.setInfinitePrecision_id7Wa2sv3G6bK.invoke(res);
    } else {
      NumberType__BehaviorDescriptor.setPrecision_id19PglA21KtA.invoke(res, ((int) InfHelper.maxInt(ListSequence.fromList(types).select((it) -> (int) NumberType__BehaviorDescriptor.precision_id19PglA20ASE.invoke(it)))));
    }

    return res;
  }

  private SNode computeSupertypeofTwoTuples(SNode tupleAType, SNode tupleBType, boolean goToInfinity, SubtypingManager mgr) {
    List<SNode> resultTypes = new ArrayList<SNode>();
    if (ListSequence.fromList(SLinkOperations.getChildren(tupleAType, LINKS.elementTypes$gWta)).count() == ListSequence.fromList(SLinkOperations.getChildren(tupleBType, LINKS.elementTypes$gWta)).count()) {
      List<SNode> elementTypes = new ArrayList<SNode>();
      Iterator<SNode> itrA = ListSequence.fromList(SLinkOperations.getChildren(tupleAType, LINKS.elementTypes$gWta)).iterator();
      Iterator<SNode> itrB = ListSequence.fromList(SLinkOperations.getChildren(tupleBType, LINKS.elementTypes$gWta)).iterator();
      while (itrA.hasNext() && itrB.hasNext()) {
        ListSequence.fromList(elementTypes).clear();
        ListSequence.fromList(elementTypes).addElement(SNodeOperations.copyNode(itrA.next()));
        ListSequence.fromList(elementTypes).addElement(SNodeOperations.copyNode(itrB.next()));
        ListSequence.fromList(resultTypes).addElement(SNodeOperations.as(computeSupertype(elementTypes, goToInfinity, mgr), CONCEPTS.Type$WK));
      }
      // We do not allow JoinTypes within tuples and handle RuntimeErrors (i.e. commonType got null) 
      boolean noTypeErrorsAndNoJoinTypes = ListSequence.fromList(resultTypes).where((it) -> it == null || SNodeOperations.isInstanceOf(it, CONCEPTS.JoinType$TL)).count() == 0;
      if (noTypeErrorsAndNoJoinTypes) {
        SNode tuple = SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0xe247742183174baL, "org.iets3.core.expr.base.structure.TupleType"));
        ListSequence.fromList(SLinkOperations.getChildren(tuple, LINKS.elementTypes$gWta)).addSequence(ListSequence.fromList(resultTypes));
        return tuple;
      }
    }
    ListSequence.fromList(resultTypes).clear();
    ListSequence.fromList(resultTypes).addElement(tupleAType);
    ListSequence.fromList(resultTypes).addElement(tupleBType);
    SNode jt = SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x7edef95a36fc3555L, "org.iets3.core.expr.base.structure.JoinType"));
    ListSequence.fromList(SLinkOperations.getChildren(jt, LINKS.types$MP0E)).addSequence(ListSequence.fromList(resultTypes));
    JoinType__BehaviorDescriptor.sortTypes_idH8GgRpqbgk.invoke(jt);
    return jt;
  }

  private Iterable<SNode> computeSupertypeOfTuples(List<SNode> tupleTypes, boolean goToInfinity, SubtypingManager mgr) {
    List<SNode> resultTypes = new ArrayList<SNode>();
    Set<Integer> collected = SetSequence.fromSet(new HashSet<Integer>());

    int idxA = 0;
    while (idxA < ListSequence.fromList(tupleTypes).count()) {
      if (!(SetSequence.fromSet(collected).contains(idxA))) {
        ListSequence.fromList(resultTypes).addElement(ListSequence.fromList(tupleTypes).getElement(idxA));
        SetSequence.fromSet(collected).addElement(idxA);
        int idxB = idxA + 1;
        while (idxB < ListSequence.fromList(tupleTypes).count()) {
          if (!(SetSequence.fromSet(collected).contains(idxB))) {
            SNode computedSupertype = SNodeOperations.as(computeSupertypeofTwoTuples(ListSequence.fromList(resultTypes).last(), ListSequence.fromList(tupleTypes).getElement(idxB), goToInfinity, mgr), CONCEPTS.Type$WK);
            if (SNodeOperations.isInstanceOf(computedSupertype, CONCEPTS.TupleType$8E)) {
              ListSequence.fromList(resultTypes).removeLastElement();
              ListSequence.fromList(resultTypes).addElement(SNodeOperations.as(computedSupertype, CONCEPTS.TupleType$8E));
              SetSequence.fromSet(collected).addElement(idxB);
            }
          }
          idxB++;
        }
      }
      idxA++;
    }
    assert SetSequence.fromSet(collected).count() == ListSequence.fromList(tupleTypes).count();
    return resultTypes;
  }

  @Override
  public SNode reverseValue(SNode expectedType, Object javaValue) {
    if (SNodeOperations.isInstanceOf(expectedType, CONCEPTS.StringType$B3) && javaValue instanceof String) {
      return createStringLiteral_o7o1hp_a0a0a04(((String) javaValue));
    }
    if (SNodeOperations.isInstanceOf(expectedType, CONCEPTS.NumberType$n) && javaValue instanceof Integer) {
      return createNumberLiteral_o7o1hp_a0a1a04(((String) javaValue));
    }
    if (SNodeOperations.isInstanceOf(expectedType, CONCEPTS.NumberType$n) && javaValue instanceof BigInteger) {
      return createNumberLiteral_o7o1hp_a0a2a04(((BigInteger) javaValue).toString());
    }
    if (SNodeOperations.isInstanceOf(expectedType, CONCEPTS.NumberType$n) && javaValue instanceof BigDecimal) {
      return NumberLiteral__BehaviorDescriptor.set_id2oUyrt$Tg3c.invoke(SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x46ff3b3d86d0e6daL, "org.iets3.core.expr.simpleTypes.structure.NumberLiteral")), ((BigDecimal) javaValue).toString());
    }
    if (SNodeOperations.isInstanceOf(expectedType, CONCEPTS.NumberType$n) && javaValue instanceof Float) {
      return NumberLiteral__BehaviorDescriptor.set_id2oUyrt$Tg3c.invoke(SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x46ff3b3d86d0e6daL, "org.iets3.core.expr.simpleTypes.structure.NumberLiteral")), ((Float) javaValue).toString());
    }
    if (SNodeOperations.isInstanceOf(expectedType, CONCEPTS.NumberType$n) && javaValue instanceof Double) {
      return NumberLiteral__BehaviorDescriptor.set_id2oUyrt$Tg3c.invoke(SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x46ff3b3d86d0e6daL, "org.iets3.core.expr.simpleTypes.structure.NumberLiteral")), ((Double) javaValue).toString());

    }
    if (SNodeOperations.isInstanceOf(expectedType, CONCEPTS.BooleanType$eL) && javaValue instanceof Boolean) {
      if (javaValue instanceof Boolean) {
        if (((Boolean) javaValue)) {
          return createTrueLiteral_o7o1hp_a0a0a0a6a04();
        } else {
          return createFalseLiteral_o7o1hp_a0a0a0a0g0ob();
        }
      }
    }
    return null;
  }
  @Override
  public SNode createGenericIntegerType() {
    return createIntegerType_o7o1hp_a0a14();
  }
  private static SNode createFalseLiteral_o7o1hp_a0a11() {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.FalseLiteral$ik);
    return n0.getResult();
  }
  private static SNode createTrueLiteral_o7o1hp_a0a31() {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.TrueLiteral$_K);
    return n0.getResult();
  }
  private static SNode createStringLiteral_o7o1hp_a0a0a04(String p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.StringLiteral$By);
    n0.setProperty(PROPS.value$zwlK, p0);
    return n0.getResult();
  }
  private static SNode createNumberLiteral_o7o1hp_a0a1a04(String p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.NumberLiteral$wE);
    n0.setProperty(PROPS.value$iWTK, p0);
    return n0.getResult();
  }
  private static SNode createNumberLiteral_o7o1hp_a0a2a04(String p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.NumberLiteral$wE);
    n0.setProperty(PROPS.value$iWTK, p0);
    return n0.getResult();
  }
  private static SNode createTrueLiteral_o7o1hp_a0a0a0a6a04() {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.TrueLiteral$_K);
    return n0.getResult();
  }
  private static SNode createFalseLiteral_o7o1hp_a0a0a0a0g0ob() {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.FalseLiteral$ik);
    return n0.getResult();
  }
  private static SNode createIntegerType_o7o1hp_a0a14() {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.IntegerType$m0);
    return n0.getResult();
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink range$RnOa = MetaAdapterFactory.getContainmentLink(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x7211e50064d40ea8L, 0x127541598201af78L, "range");
    /*package*/ static final SContainmentLink types$MP0E = MetaAdapterFactory.getContainmentLink(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x7edef95a36fc3555L, 0x7edef95a36fc3556L, "types");
    /*package*/ static final SContainmentLink elementTypes$gWta = MetaAdapterFactory.getContainmentLink(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0xe247742183174baL, 0xe247742183174bbL, "elementTypes");
  }

  private static final class PROPS {
    /*package*/ static final SProperty min$7OOG = MetaAdapterFactory.getProperty(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x127541598201af65L, 0x127541598201af6fL, "min");
    /*package*/ static final SProperty max$7P3H = MetaAdapterFactory.getProperty(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x127541598201af65L, 0x127541598201af70L, "max");
    /*package*/ static final SProperty value$zwlK = MetaAdapterFactory.getProperty(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x46ff3b3d86d3edc8L, 0x46ff3b3d86d3edcbL, "value");
    /*package*/ static final SProperty value$iWTK = MetaAdapterFactory.getProperty(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x46ff3b3d86d0e6daL, 0x46ff3b3d86d0e6ddL, "value");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept NumberType$n = MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x7211e50064d40ea8L, "org.iets3.core.expr.simpleTypes.structure.NumberType");
    /*package*/ static final SConcept OtherwiseLiteral$Cj = MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x6ea1ae96e114065eL, "org.iets3.core.expr.simpleTypes.structure.OtherwiseLiteral");
    /*package*/ static final SConcept TrueLiteral$_K = MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x670d5e92f854cb59L, "org.iets3.core.expr.simpleTypes.structure.TrueLiteral");
    /*package*/ static final SConcept FalseLiteral$ik = MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x670d5e92f854cb76L, "org.iets3.core.expr.simpleTypes.structure.FalseLiteral");
    /*package*/ static final SConcept TupleType$8E = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0xe247742183174baL, "org.iets3.core.expr.base.structure.TupleType");
    /*package*/ static final SConcept Type$WK = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x670d5e92f854a614L, "org.iets3.core.expr.base.structure.Type");
    /*package*/ static final SConcept StringType$B3 = MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x46ff3b3d86d3edc7L, "org.iets3.core.expr.simpleTypes.structure.StringType");
    /*package*/ static final SConcept StringTypeWithConstraint$H$ = MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x2875f33f196375acL, "org.iets3.core.expr.simpleTypes.structure.StringTypeWithConstraint");
    /*package*/ static final SConcept JoinType$TL = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x7edef95a36fc3555L, "org.iets3.core.expr.base.structure.JoinType");
    /*package*/ static final SConcept BooleanType$eL = MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x670d5e92f854a617L, "org.iets3.core.expr.simpleTypes.structure.BooleanType");
    /*package*/ static final SConcept StringLiteral$By = MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x46ff3b3d86d3edc8L, "org.iets3.core.expr.simpleTypes.structure.StringLiteral");
    /*package*/ static final SConcept NumberLiteral$wE = MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x46ff3b3d86d0e6daL, "org.iets3.core.expr.simpleTypes.structure.NumberLiteral");
    /*package*/ static final SConcept IntegerType$m0 = MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x46ff3b3d86d0e6d9L, "org.iets3.core.expr.simpleTypes.structure.IntegerType");
  }
}
