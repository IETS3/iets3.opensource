package org.iets3.core.expr.simpleTypes.tests.behavior;

/*Generated by MPS */

import org.jetbrains.mps.openapi.model.SNode;
import java.util.Random;
import java.util.List;
import java.util.ArrayList;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.iets3.core.expr.tests.behavior.TestSubjectAdapter__BehaviorDescriptor;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.typechecking.TypecheckingFacade;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.internal.collections.runtime.Sequence;
import org.iets3.core.expr.path.behavior.ICanHaveMembersType__BehaviorDescriptor;
import jetbrains.mps.smodel.builder.SNodeBuilder;
import org.jetbrains.mps.openapi.language.SConcept;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import org.jetbrains.mps.openapi.language.SReferenceLink;

public class RandomVectorProducer {

  private int count;
  private SNode subject;
  private Random rand = new Random(System.currentTimeMillis());

  private final int OPTION_ONE_IN = 5;
  private boolean myOnlyInteresting;
  public static final int UNBOUNDED_COLL_MAX_LEN = 10;

  public RandomVectorProducer(SNode sbj, int cnt, boolean onlyInteresting) {
    count = cnt;
    subject = sbj;
    myOnlyInteresting = onlyInteresting;
  }

  public List<SNode> run() {
    List<SNode> vectors = new ArrayList<SNode>();
    for (int i = 0; i < count; i++) {
      ListSequence.fromList(vectors).addElement(createVector());
    }
    return vectors;
  }

  public SNode createVector() {
    SNode vector = SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0xd441fba0f46b43cdL, 0xb723dad7b65da615L, 0x12e0beaa8ee3141fL, "org.iets3.core.expr.tests.structure.TestVector"));
    for (SNode arg : ListSequence.fromList(TestSubjectAdapter__BehaviorDescriptor.arguments_id1bwJEEeSLhl.invoke(subject))) {
      SNode type = SNodeOperations.cast(TypecheckingFacade.getFromContext().getTypeOf(arg), CONCEPTS.Type$WK);
      ListSequence.fromList(SLinkOperations.getChildren(vector, LINKS.values$8V1O)).addElement(createInputValue_ayfpwc_a0a1a1a31(new ValueProducer(type, myOnlyInteresting).newValue(), arg));
    }
    return vector;
  }


  public boolean supportsType(SNode type) {
    if (SNodeOperations.isInstanceOf(type, CONCEPTS.BooleanType$eL)) {
      return true;
    } else if (SNodeOperations.isInstanceOf(type, CONCEPTS.OptionType$eU)) {
      return supportsType(SLinkOperations.getTarget(SNodeOperations.cast(type, CONCEPTS.OptionType$eU), LINKS.baseType$Cv_a));
    } else if (SNodeOperations.isInstanceOf(type, CONCEPTS.RecordType$z_)) {
      return Sequence.fromIterable(ICanHaveMembersType__BehaviorDescriptor.members_id6LLGpXJ1KQb.invoke(SNodeOperations.cast(type, CONCEPTS.RecordType$z_))).all((it) -> supportsType(SNodeOperations.cast(TypecheckingFacade.getFromContext().getTypeOf(it), CONCEPTS.Type$WK)));
    } else if (SNodeOperations.isInstanceOf(type, CONCEPTS.CollectionType$kS)) {
      return supportsType(SLinkOperations.getTarget(SNodeOperations.cast(type, CONCEPTS.CollectionType$kS), LINKS.baseType$5NOJ));
    } else if (SNodeOperations.isInstanceOf(type, CONCEPTS.IntegerType$m0)) {
      return true;
    } else if (SNodeOperations.isInstanceOf(type, CONCEPTS.EnumType$z)) {
      return true;
    } else if (SNodeOperations.isInstanceOf(type, CONCEPTS.NumberType$n)) {
      return true;
    } else if (SNodeOperations.isInstanceOf(type, CONCEPTS.RealType$36)) {
      return true;
    } else if (SNodeOperations.isInstanceOf(type, CONCEPTS.StringType$B3)) {
      return true;
    }
    return false;
  }

  private static SNode createInputValue_ayfpwc_a0a1a1a31(SNode p0, SNode p1) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.InputValue$oX);
    n0.forChild(LINKS.value$xPWu).initNode(p0, CONCEPTS.Expression$D_, true);
    n0.setReferenceTarget(LINKS.argument$xPus, p1);
    return n0.getResult();
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept Type$WK = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x670d5e92f854a614L, "org.iets3.core.expr.base.structure.Type");
    /*package*/ static final SConcept BooleanType$eL = MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x670d5e92f854a617L, "org.iets3.core.expr.simpleTypes.structure.BooleanType");
    /*package*/ static final SConcept OptionType$eU = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x26f4f2a81ca93310L, "org.iets3.core.expr.base.structure.OptionType");
    /*package*/ static final SConcept RecordType$z_ = MetaAdapterFactory.getConcept(0x71934284d7d145eeL, 0xa0548c072591085fL, 0x7a477bfec237e8c2L, "org.iets3.core.expr.toplevel.structure.RecordType");
    /*package*/ static final SConcept CollectionType$kS = MetaAdapterFactory.getConcept(0x2f7e2e356e744c43L, 0x9fa52465d68f5996L, 0x68d69d36ba495885L, "org.iets3.core.expr.collections.structure.CollectionType");
    /*package*/ static final SConcept IntegerType$m0 = MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x46ff3b3d86d0e6d9L, "org.iets3.core.expr.simpleTypes.structure.IntegerType");
    /*package*/ static final SConcept EnumType$z = MetaAdapterFactory.getConcept(0x71934284d7d145eeL, 0xa0548c072591085fL, 0x61fe216664a730bbL, "org.iets3.core.expr.toplevel.structure.EnumType");
    /*package*/ static final SConcept NumberType$n = MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x7211e50064d40ea8L, "org.iets3.core.expr.simpleTypes.structure.NumberType");
    /*package*/ static final SConcept RealType$36 = MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x46ff3b3d86d0e74cL, "org.iets3.core.expr.simpleTypes.structure.RealType");
    /*package*/ static final SConcept StringType$B3 = MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x46ff3b3d86d3edc7L, "org.iets3.core.expr.simpleTypes.structure.StringType");
    /*package*/ static final SConcept InputValue$oX = MetaAdapterFactory.getConcept(0xd441fba0f46b43cdL, 0xb723dad7b65da615L, 0x12e0beaa8f0adb15L, "org.iets3.core.expr.tests.structure.InputValue");
    /*package*/ static final SConcept Expression$D_ = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x670d5e92f854a047L, "org.iets3.core.expr.base.structure.Expression");
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink values$8V1O = MetaAdapterFactory.getContainmentLink(0xd441fba0f46b43cdL, 0xb723dad7b65da615L, 0x12e0beaa8ee3141fL, 0x12e0beaa8ee31420L, "values");
    /*package*/ static final SContainmentLink baseType$Cv_a = MetaAdapterFactory.getContainmentLink(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x26f4f2a81ca93310L, 0x26f4f2a81ca93311L, "baseType");
    /*package*/ static final SContainmentLink baseType$5NOJ = MetaAdapterFactory.getContainmentLink(0x2f7e2e356e744c43L, 0x9fa52465d68f5996L, 0x68d69d36ba495885L, 0x68d69d36ba495886L, "baseType");
    /*package*/ static final SContainmentLink value$xPWu = MetaAdapterFactory.getContainmentLink(0xd441fba0f46b43cdL, 0xb723dad7b65da615L, 0x12e0beaa8f0adb15L, 0x12e0beaa8f0adb36L, "value");
    /*package*/ static final SReferenceLink argument$xPus = MetaAdapterFactory.getReferenceLink(0xd441fba0f46b43cdL, 0xb723dad7b65da615L, 0x12e0beaa8f0adb15L, 0x12e0beaa8f0adb34L, "argument");
  }
}
