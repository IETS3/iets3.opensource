package org.iets3.core.expr.natlang.editor;

/*Generated by MPS */

import jetbrains.mps.lang.editor.cellProviders.SingleRoleCellProvider;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.openapi.editor.EditorContext;
import jetbrains.mps.openapi.editor.cells.EditorCell;
import jetbrains.mps.openapi.editor.cells.DefaultSubstituteInfo;
import jetbrains.mps.nodeEditor.cellMenu.SChildSubstituteInfo;

public class SingleChildCellProvider extends SingleRoleCellProvider {
  private SContainmentLink myLink;
  private SNode myOwnerNode;

  public SingleChildCellProvider(SNode ownerNode, SContainmentLink containmentLink, EditorContext context) {
    super(containmentLink, context);
    myLink = containmentLink;
    myOwnerNode = ownerNode;
  }
  protected EditorCell createChildCell(SNode child) {
    EditorCell editorCell = super.createChildCell(child);
    installCellInfo(child, editorCell);
    return editorCell;
  }
  private void installCellInfo(SNode child, EditorCell editorCell) {
    if (editorCell.getSubstituteInfo() == null || editorCell.getSubstituteInfo() instanceof DefaultSubstituteInfo) {
      editorCell.setSubstituteInfo(new SChildSubstituteInfo(editorCell));
    }

    if (editorCell.getSRole() == null) {
      editorCell.setSRole(myLink);
    }
  }
  @Override
  public SNode getNode() {
    return myOwnerNode;
  }
  @Override
  protected EditorCell createEmptyCell() {
    EditorCell editorCell = super.createEmptyCell();
    editorCell.setCellId(myLink.getName());

    installCellInfo(null, editorCell);
    return editorCell;
  }
  protected String getNoTargetText() {
    return "<no " + myLink.getName() + ">";
  }
}
