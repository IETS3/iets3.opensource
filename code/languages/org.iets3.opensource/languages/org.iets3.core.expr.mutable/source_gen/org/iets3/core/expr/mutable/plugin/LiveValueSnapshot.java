package org.iets3.core.expr.mutable.plugin;

/*Generated by MPS */

import org.iets3.core.expr.base.plugin.IRenderable;
import org.iets3.core.expr.base.plugin.IDiffable;
import java.util.Map;
import jetbrains.mps.internal.collections.runtime.MapSequence;
import java.util.HashMap;
import org.iets3.core.expr.base.plugin.ValueStructureRenderer;
import org.iets3.core.expr.base.plugin.RenderNode;
import java.util.Set;
import jetbrains.mps.internal.collections.runtime.SetSequence;
import java.util.Objects;

public class LiveValueSnapshot implements IRenderable, IDiffable {

  /*package*/ Map<String, Object> values = MapSequence.fromMap(new HashMap<String, Object>());
  private String myDescr;
  private String myId;

  public LiveValueSnapshot(String id, String descr) {
    myId = id;
    myDescr = descr;
  }

  public void add(String name, Object value) {
    MapSequence.fromMap(values).put(name, value);
  }

  @Override
  public String toString() {
    return new ValueStructureRenderer(this).toString();
  }

  @Override
  public RenderNode renderTree(ValueStructureRenderer renderer) {
    RenderNode root = new RenderNode(this, myDescr);
    Set<Map.Entry<Object, Object>> entrySet = ((Map) values).entrySet();
    for (Map.Entry<Object, Object> entry : SetSequence.fromSet(entrySet)) {
      renderer.render(entry, root);
    }
    return root;
  }
  @Override
  public String id() {
    return this.myId;
  }

  @Override
  public boolean equals(Object object) {
    if (object == null) {
      return false;
    }
    if (!(object instanceof LiveValueSnapshot)) {
      return false;
    }
    LiveValueSnapshot other = ((LiveValueSnapshot) object);
    return Objects.equals(this.values, other.values);
  }

}
