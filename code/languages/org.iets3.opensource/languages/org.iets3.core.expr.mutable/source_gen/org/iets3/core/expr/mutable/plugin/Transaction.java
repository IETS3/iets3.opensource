package org.iets3.core.expr.mutable.plugin;

/*Generated by MPS */

import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import java.util.Map;
import jetbrains.mps.internal.collections.runtime.MapSequence;
import java.util.HashMap;
import jetbrains.mps.internal.collections.runtime.SetSequence;

public class Transaction {

  public static SNode KEY = SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x10802efe25aL, "jetbrains.mps.lang.core.structure.BaseConcept"));

  private SNode transaction;
  private Map<ITransactionalValue, Object> oldValues = MapSequence.fromMap(new HashMap<ITransactionalValue, Object>());


  public Transaction(SNode tx) {
    transaction = tx;
  }

  public void commit() {
  }

  public void rollback() {
    for (ITransactionalValue k : SetSequence.fromSet(MapSequence.fromMap(oldValues).keySet())) {
      k.setValue(MapSequence.fromMap(oldValues).get(k));
    }
  }

  public void registerChange(ITransactionalValue txValue) {
    if (!(MapSequence.fromMap(oldValues).containsKey(txValue))) {
      MapSequence.fromMap(oldValues).put(txValue, txValue.getValue());
    }
  }

}
