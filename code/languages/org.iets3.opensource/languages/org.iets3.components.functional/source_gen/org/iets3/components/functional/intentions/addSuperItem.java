package org.iets3.components.functional.intentions;

/*Generated by MPS */

import de.itemis.mps.selection.runtime.intentions.AbstractSelectionIntentionFactory;
import java.util.List;
import de.itemis.mps.selection.runtime.intentions.ISelectionIntentionExecutable;
import jetbrains.mps.nodeEditor.selection.NodeRangeSelection;
import de.itemis.mps.selection.runtime.intentions.AbstractSelectionIntentionExecutable;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import org.iets3.components.functional.behavior.DataItem__BehaviorDescriptor;
import java.util.Collections;
import jetbrains.mps.smodel.builder.SNodeBuilder;
import org.jetbrains.mps.openapi.language.SProperty;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import org.jetbrains.mps.openapi.language.SReferenceLink;
import org.jetbrains.mps.openapi.language.SConcept;

public class addSuperItem extends AbstractSelectionIntentionFactory {
  public addSuperItem() {
  }

  @Override
  public List<ISelectionIntentionExecutable> getInstances(Object selection) {
    if (selection instanceof NodeRangeSelection) {
      ISelectionIntentionExecutable intention = new AbstractSelectionIntentionExecutable<NodeRangeSelection>() {
        @Override
        public void execute(NodeRangeSelection selection) {
          List<SNode> nodes = ((List<SNode>) selection.getSelectedNodes());
          final SNode parent = createDataItem_vmbmx2_a0b0a(SPropertyOperations.getString(ListSequence.fromList(nodes).first(), PROPS.name$MnvL) + "_super");
          SNodeOperations.insertPrevSiblingChild(ListSequence.fromList(nodes).first(), parent);
          ListSequence.fromList(nodes).visitAll((it) -> {
            SNode e = SLinkOperations.setNewChild(it, LINKS.extends$SaYz, null);
            SLinkOperations.setTarget(e, LINKS.parent$Dfj0, parent);
          });

        }
        @Override
        public String getDescription(NodeRangeSelection selection) {
          return "Introduce Super-Item";
        }
        @Override
        public boolean isApplicable(NodeRangeSelection selection) {
          List<SNode> nodes = selection.getSelectedNodes();
          return ListSequence.fromList(nodes).all((it) -> SNodeOperations.isInstanceOf(it, CONCEPTS.DataItem$8n) && DataItem__BehaviorDescriptor.parentItem_id2_pHDKxjC_b.invoke(SNodeOperations.cast(it, CONCEPTS.DataItem$8n)) == null);
        }
      };
      return Collections.singletonList(intention);
    } else {
      return Collections.<ISelectionIntentionExecutable>emptyList();
    }
  }
  private static SNode createDataItem_vmbmx2_a0b0a(String p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.DataItem$8n);
    n0.setProperty(PROPS.name$MnvL, p0);
    return n0.getResult();
  }

  private static final class PROPS {
    /*package*/ static final SProperty name$MnvL = MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name");
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink extends$SaYz = MetaAdapterFactory.getContainmentLink(0x257976063fb647b8L, 0xbc3cb4384df7da44L, 0x6c4f9fd23e4bfa58L, 0x2959b69c214ada34L, "extends");
    /*package*/ static final SReferenceLink parent$Dfj0 = MetaAdapterFactory.getReferenceLink(0x257976063fb647b8L, 0xbc3cb4384df7da44L, 0x2959b69c214a97d3L, 0x2959b69c214a97d4L, "parent");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept DataItem$8n = MetaAdapterFactory.getConcept(0x257976063fb647b8L, 0xbc3cb4384df7da44L, 0x6c4f9fd23e4bfa58L, "org.iets3.components.functional.structure.DataItem");
  }
}
