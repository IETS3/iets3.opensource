package org.iets3.variability.artifacts.base.behavior;

/*Generated by MPS */

import org.iets3.variability.artifacts.base.plugin.IInstantiation;
import org.jetbrains.mps.openapi.model.SNode;
import java.util.Objects;
import jetbrains.mps.lang.core.behavior.BaseConcept__BehaviorDescriptor;

public class Segment implements IInstantiation {
  private SNode pivotNode;
  private String name;
  private SNode fmInclude;
  private SNode targetIVAA;

  /**
   * Constructor for a segment with instantiation and pivot node.
   * 
   * @param n the pivot node pointing from including IVAA to instantiated IVAA
   * @param name name of pivot node in path
   * @param fmInclude the feature model include used for the instantiation
   * @param target the instantiated IVAA
   */
  public Segment(SNode n, String name, SNode fmInclude, SNode target) {
    this.pivotNode = n;
    this.name = name;
    this.fmInclude = fmInclude;
    this.targetIVAA = target;
  }

  /**
   * Constructor for a segment without instantiation (just a dependent IVAA on same level of the artifact).
   * 
   * @param fmInclude the feature model include used for the target IVAA
   * @param target the target IVAA
   */
  public Segment(SNode fmInclude, SNode target) {
    this.pivotNode = null;
    this.name = null;
    this.fmInclude = fmInclude;
    this.targetIVAA = target;
  }

  public boolean hasTarget(SNode ivaa) {
    return Objects.equals(ivaa, targetIVAA);
  }

  public boolean isDirect() {
    return (pivotNode == null);
  }

  public SNode getPivot() {
    return this.pivotNode;
  }

  public String getName() {
    return this.name;
  }

  public SNode getFMInclude() {
    return this.fmInclude;
  }

  public SNode getTarget() {
    return this.targetIVAA;
  }

  @Override
  public SNode pivot() {
    return this.getPivot();
  }

  @Override
  public int hashCode() {
    if (isDirect()) {
      int hash = this.targetIVAA.hashCode();
      if ((this.fmInclude != null)) {
        hash = 31 * hash + this.fmInclude.hashCode();
      }
      return hash;
    } else {
      return this.pivotNode.hashCode();
    }
  }

  @Override
  public boolean equals(Object obj) {
    if (obj == this) {
      return true;
    }
    if (!(obj instanceof Segment)) {
      return false;
    }
    Segment other = (Segment) obj;
    if (isDirect()) {
      if (!(Objects.equals(this.fmInclude, other.fmInclude))) {
        return false;
      }
      if (!(Objects.equals(this.targetIVAA, other.targetIVAA))) {
        return false;
      }
      return true;
    } else {
      return this.pivotNode == other.pivotNode;
    }
  }

  @Override
  public String toString() {
    String tn = IVariabilityAwareArtifact__BehaviorDescriptor.artifactName_id7eAm6HphX4A.invoke(targetIVAA);
    if (isDirect()) {
      return tn;
    } else {
      String namePart = (name == null ? "-:" : name + ":");
      String pivotPart = ((this.pivotNode == null) ? "-" : BaseConcept__BehaviorDescriptor.getPresentation_idhEwIMiw.invoke(this.pivotNode));
      return namePart + tn + ":" + BaseConcept__BehaviorDescriptor.getPresentation_idhEwIMiw.invoke(fmInclude) + ":" + pivotPart;
    }
  }
}
