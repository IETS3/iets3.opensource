package org.iets3.variability.artifacts.base.behavior;

/*Generated by MPS */

import jetbrains.mps.core.aspects.behaviour.BaseBHDescriptor;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import jetbrains.mps.core.aspects.behaviour.api.SMethod;
import jetbrains.mps.core.aspects.behaviour.SMethodBuilder;
import jetbrains.mps.core.aspects.behaviour.SJavaCompoundTypeImpl;
import jetbrains.mps.core.aspects.behaviour.AccessPrivileges;
import com.mbeddr.mpsutil.interpreter.rt.IContext;
import org.jetbrains.mps.openapi.model.SNode;
import java.util.Optional;
import java.util.List;
import java.util.Arrays;
import org.jetbrains.annotations.NotNull;
import jetbrains.mps.lang.core.behavior.BaseConcept__BehaviorDescriptor;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import org.iets3.variability.configuration.base.behavior.FeatureExprEvaluator;
import jetbrains.mps.baseLanguage.logging.rt.LogContext;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.internal.collections.runtime.Sequence;
import de.itemis.mps.utils.serializer.xml.serializer.NodeSerializer;
import org.iets3.core.expr.path.behavior.IPathPart__BehaviorDescriptor;
import jetbrains.mps.internal.collections.runtime.NotNullWhereFilter;
import jetbrains.mps.typechecking.TypecheckingFacade;
import jetbrains.mps.core.aspects.behaviour.api.SConstructor;
import org.jetbrains.annotations.Nullable;
import jetbrains.mps.core.aspects.behaviour.api.BHMethodNotFoundException;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import org.jetbrains.mps.openapi.language.SReferenceLink;
import org.jetbrains.mps.openapi.language.SConcept;
import org.jetbrains.mps.openapi.language.SInterfaceConcept;

public final class IConditionVarPoint__BehaviorDescriptor extends BaseBHDescriptor {
  private static final SAbstractConcept CONCEPT = MetaAdapterFactory.getInterfaceConcept(0xf08835038eaa4bc8L, 0x8846eb63220ab1ddL, 0xe86d1af52aae5ceL, "org.iets3.variability.artifacts.base.structure.IConditionVarPoint");

  public static final SMethod<String> getConditionAsString_id7Ca9tj9CeW1 = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("getConditionAsString").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(8793882818240376577L).languageId(0x8846eb63220ab1ddL, 0xf08835038eaa4bc8L).build2();
  public static final SMethod<Boolean> isPresent_idU6OqXiEInN = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.TYPE)).name("isPresent").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(1046754514346632691L).languageId(0x8846eb63220ab1ddL, 0xf08835038eaa4bc8L).build2(SMethodBuilder.createJavaParameter(IContext.class, ""));
  public static final SMethod<Boolean> isPresentTernary_id1R5hpWYhU60 = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.class)).name("isPresentTernary").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(2145197347758907776L).languageId(0x8846eb63220ab1ddL, 0xf08835038eaa4bc8L).build2(SMethodBuilder.createJavaParameter(IContext.class, ""));
  public static final SMethod<SNode> extractFeatureModelInclude_id5LihCoMh79S = new SMethodBuilder<SNode>(new SJavaCompoundTypeImpl((Class<SNode>) ((Class) Object.class))).name("extractFeatureModelInclude").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6652457141762552440L).languageId(0x8846eb63220ab1ddL, 0xf08835038eaa4bc8L).build2();
  public static final SMethod<SNode> getSingleFeatureInclude_id5LihCoMgKPo = new SMethodBuilder<SNode>(new SJavaCompoundTypeImpl((Class<SNode>) ((Class) Object.class))).name("getSingleFeatureInclude").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6652457141762461016L).languageId(0x8846eb63220ab1ddL, 0xf08835038eaa4bc8L).build2();
  public static final SMethod<SNode> conditionedNode_id1S98ztUiKtj = new SMethodBuilder<SNode>(new SJavaCompoundTypeImpl((Class<SNode>) ((Class) Object.class))).name("conditionedNode").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(2164298717598517075L).languageId(0x8846eb63220ab1ddL, 0xf08835038eaa4bc8L).build2();
  public static final SMethod<SNode> featureExpression_id3MG6jbHWLn_ = new SMethodBuilder<SNode>(new SJavaCompoundTypeImpl((Class<SNode>) ((Class) Object.class))).name("featureExpression").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(4371897044801099237L).languageId(0x8846eb63220ab1ddL, 0xf08835038eaa4bc8L).build2();
  public static final SMethod<Optional<SNode>> getPresenceCondition_id4G1C74Q8D4_ = new SMethodBuilder<Optional<SNode>>(new SJavaCompoundTypeImpl(Optional.class)).name("getPresenceCondition").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(5404777435921289509L).languageId(0x96377955ccbfec22L, 0xc6ff3b3baff6455eL).build2();
  public static final SMethod<Integer> computeHash_id6s5puhjUPSP = new SMethodBuilder<Integer>(new SJavaCompoundTypeImpl(Integer.TYPE)).name("computeHash").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(7423451592125013557L).languageId(0x8846eb63220ab1ddL, 0xf08835038eaa4bc8L).build2();
  public static final SMethod<Iterable<SNode>> occuringFeatures_idwoVoSdvbmN = new SMethodBuilder<Iterable<SNode>>(new SJavaCompoundTypeImpl((Class<Iterable<SNode>>) ((Class) Object.class))).name("occuringFeatures").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(583477346111894963L).languageId(0x8846eb63220ab1ddL, 0xf08835038eaa4bc8L).build2();
  public static final SMethod<Iterable<SNode>> featureModelRefs_id5BGbpGNak1r = new SMethodBuilder<Iterable<SNode>>(new SJavaCompoundTypeImpl((Class<Iterable<SNode>>) ((Class) Object.class))).name("featureModelRefs").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6479604108480823387L).languageId(0x8846eb63220ab1ddL, 0xf08835038eaa4bc8L).build2();
  /*package*/ static final SMethod<SNode> featureType_idwoVoSdviMI = new SMethodBuilder<SNode>(new SJavaCompoundTypeImpl((Class<SNode>) ((Class) Object.class))).name("featureType").modifiers(0, AccessPrivileges.PRIVATE).concept(CONCEPT).baseMethodId(583477346111925422L).languageId(0x8846eb63220ab1ddL, 0xf08835038eaa4bc8L).build2(SMethodBuilder.createJavaParameter((Class<SNode>) ((Class) Object.class), ""));

  private static final List<SMethod<?>> BH_METHODS = Arrays.<SMethod<?>>asList(getConditionAsString_id7Ca9tj9CeW1, isPresent_idU6OqXiEInN, isPresentTernary_id1R5hpWYhU60, extractFeatureModelInclude_id5LihCoMh79S, getSingleFeatureInclude_id5LihCoMgKPo, conditionedNode_id1S98ztUiKtj, featureExpression_id3MG6jbHWLn_, getPresenceCondition_id4G1C74Q8D4_, computeHash_id6s5puhjUPSP, occuringFeatures_idwoVoSdvbmN, featureModelRefs_id5BGbpGNak1r, featureType_idwoVoSdviMI);

  private static void ___init___(@NotNull SNode __thisNode__) {
  }

  /*package*/ static String getConditionAsString_id7Ca9tj9CeW1(@NotNull SNode __thisNode__) {
    return (String) BaseConcept__BehaviorDescriptor.getPresentation_idhEwIMiw.invoke(SLinkOperations.getTarget(__thisNode__, LINKS.featureExpr$cJRc));
  }
  @Deprecated
  /*package*/ static boolean isPresent_idU6OqXiEInN(@NotNull SNode __thisNode__, IContext context) {
    // evaluate the presence condition at this variation point
    Boolean val = FeatureExprEvaluator.evaluateCondition(SLinkOperations.getTarget(__thisNode__, LINKS.featureExpr$cJRc), context);
    if (val == null) {
      // the expression could not be evaluated, default to "not present"
      return false;
    } else {
      return val;
    }
  }
  /*package*/ static Boolean isPresentTernary_id1R5hpWYhU60(@NotNull SNode __thisNode__, IContext context) {
    Boolean result;
    try {
      // evaluate the presence condition at this variation point
      result = FeatureExprEvaluator.evaluateConditionTernary(SLinkOperations.getTarget(__thisNode__, LINKS.featureExpr$cJRc), context);
      return result;
    } catch (Exception ex) {
      // something went wrong during evaluation, report error and rethrow exception
      LogContext.with(IConditionVarPoint__BehaviorDescriptor.class, ex, null, null).error("Runtime error during evaluation of presence condition");
      throw new RuntimeException(ex);
    }
  }
  /*package*/ static SNode extractFeatureModelInclude_id5LihCoMh79S(@NotNull SNode __thisNode__) {
    List<SNode> sfdts = SNodeOperations.getNodeDescendants(SLinkOperations.getTarget(__thisNode__, LINKS.featureExpr$cJRc), CONCEPTS.SubFeatureDotTarget$5P, false, new SAbstractConcept[]{});
    if (ListSequence.fromList(sfdts).count() == 1) {
      SNode f = SLinkOperations.getTarget(ListSequence.fromList(sfdts).first(), LINKS.feature$hhv5);
      {
        final SNode fmi = f;
        if (SNodeOperations.isInstanceOf(fmi, CONCEPTS.FeatureModelInclude$Iq)) {
          return fmi;
        }
      }
    }
    return null;
  }
  /*package*/ static SNode getSingleFeatureInclude_id5LihCoMgKPo(@NotNull SNode __thisNode__) {
    List<SNode> sfdts = SNodeOperations.getNodeDescendants(SLinkOperations.getTarget(__thisNode__, LINKS.featureExpr$cJRc), CONCEPTS.SubFeatureDotTarget$5P, false, new SAbstractConcept[]{});
    Iterable<SNode> includes = SNodeOperations.ofConcept(ListSequence.fromList(sfdts).select((it) -> SLinkOperations.getTarget(it, LINKS.feature$hhv5)), CONCEPTS.FeatureModelInclude$Iq);
    if (Sequence.fromIterable(includes).count() == 1) {
      return Sequence.fromIterable(includes).first();
    }
    return null;
  }
  @Deprecated
  /*package*/ static SNode conditionedNode_id1S98ztUiKtj(@NotNull SNode __thisNode__) {
    return ((SNode) IVariationPointBase__BehaviorDescriptor.artifactNode_id3q2wVepCV0v.invoke(__thisNode__));
  }
  /*package*/ static SNode featureExpression_id3MG6jbHWLn_(@NotNull SNode __thisNode__) {
    return SLinkOperations.getTarget(__thisNode__, LINKS.featureExpr$cJRc);
  }
  /*package*/ static Optional<SNode> getPresenceCondition_id4G1C74Q8D4_(@NotNull SNode __thisNode__) {
    return Optional.of(SLinkOperations.getTarget(__thisNode__, LINKS.featureExpr$cJRc));
  }
  /*package*/ static int computeHash_id6s5puhjUPSP(@NotNull SNode __thisNode__) {
    NodeSerializer s = new NodeSerializer(SLinkOperations.getTarget(__thisNode__, LINKS.featureExpr$cJRc), true, "__");
    return (s.getXMLAsString()).hashCode();
  }
  /*package*/ static Iterable<SNode> occuringFeatures_idwoVoSdvbmN(@NotNull final SNode __thisNode__) {
    Iterable<SNode> targets = ListSequence.fromList((SNodeOperations.getNodeDescendants(SLinkOperations.getTarget(__thisNode__, LINKS.featureExpr$cJRc), CONCEPTS.IPathPart$v0, false, new SAbstractConcept[]{}))).select((it) -> (SNode) IPathPart__BehaviorDescriptor.target_id4fgA7QrEdeJ.invoke(it));
    return Sequence.fromIterable((Sequence.fromIterable(targets).select((it) -> ((SNode) IConditionVarPoint__BehaviorDescriptor.featureType_idwoVoSdviMI.invokeSpecial(__thisNode__, it))))).where(new NotNullWhereFilter()).distinct();
  }
  /*package*/ static Iterable<SNode> featureModelRefs_id5BGbpGNak1r(@NotNull final SNode __thisNode__) {
    return ListSequence.fromList(SNodeOperations.getNodeDescendants(SLinkOperations.getTarget(__thisNode__, LINKS.featureExpr$cJRc), null, false, new SAbstractConcept[]{})).where((it) -> (IConditionVarPoint__BehaviorDescriptor.featureType_idwoVoSdviMI.invokeSpecial(__thisNode__, it) != null));
  }
  /*package*/ static SNode featureType_idwoVoSdviMI(@NotNull SNode __thisNode__, SNode node) {
    {
      final SNode ft = TypecheckingFacade.getFromContext().getTypeOf(node);
      if (SNodeOperations.isInstanceOf(ft, CONCEPTS.FeatureType$_L)) {
        return SLinkOperations.getTarget(ft, LINKS.feature$SwK2);
      }
    }
    return null;
  }

  /*package*/ IConditionVarPoint__BehaviorDescriptor() {
  }

  @Override
  protected void initNode(@NotNull SNode node, @NotNull SConstructor constructor, @Nullable Object[] parameters) {
    ___init___(node);
  }

  @Override
  protected <T> T invokeSpecial0(@NotNull SNode node, @NotNull SMethod<T> method, @Nullable Object[] parameters) {
    int methodIndex = BH_METHODS.indexOf(method);
    if (methodIndex < 0) {
      throw new BHMethodNotFoundException(this, method);
    }
    switch (methodIndex) {
      case 0:
        return (T) ((String) getConditionAsString_id7Ca9tj9CeW1(node));
      case 1:
        return (T) ((Boolean) isPresent_idU6OqXiEInN(node, (IContext) parameters[0]));
      case 2:
        return (T) ((Boolean) isPresentTernary_id1R5hpWYhU60(node, (IContext) parameters[0]));
      case 3:
        return (T) ((SNode) extractFeatureModelInclude_id5LihCoMh79S(node));
      case 4:
        return (T) ((SNode) getSingleFeatureInclude_id5LihCoMgKPo(node));
      case 5:
        return (T) ((SNode) conditionedNode_id1S98ztUiKtj(node));
      case 6:
        return (T) ((SNode) featureExpression_id3MG6jbHWLn_(node));
      case 7:
        return (T) ((Optional<SNode>) getPresenceCondition_id4G1C74Q8D4_(node));
      case 8:
        return (T) ((Integer) computeHash_id6s5puhjUPSP(node));
      case 9:
        return (T) ((Iterable<SNode>) occuringFeatures_idwoVoSdvbmN(node));
      case 10:
        return (T) ((Iterable<SNode>) featureModelRefs_id5BGbpGNak1r(node));
      case 11:
        return (T) ((SNode) featureType_idwoVoSdviMI(node, (SNode) parameters[0]));
      default:
        throw new BHMethodNotFoundException(this, method);
    }
  }

  @Override
  protected <T> T invokeSpecial0(@NotNull SAbstractConcept concept, @NotNull SMethod<T> method, @Nullable Object[] parameters) {
    int methodIndex = BH_METHODS.indexOf(method);
    if (methodIndex < 0) {
      throw new BHMethodNotFoundException(this, method);
    }
    switch (methodIndex) {
      default:
        throw new BHMethodNotFoundException(this, method);
    }
  }

  @NotNull
  @Override
  public List<SMethod<?>> getDeclaredMethods() {
    return BH_METHODS;
  }

  @NotNull
  @Override
  public SAbstractConcept getConcept() {
    return CONCEPT;
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink featureExpr$cJRc = MetaAdapterFactory.getContainmentLink(0xf08835038eaa4bc8L, 0x8846eb63220ab1ddL, 0xe86d1af52aae5ceL, 0x55275f0cc818c452L, "featureExpr");
    /*package*/ static final SReferenceLink feature$hhv5 = MetaAdapterFactory.getReferenceLink(0x165f1d0525064544L, 0x895e1424f54166ecL, 0x7cde27c7fd85baccL, 0x7cde27c7fd85bad9L, "feature");
    /*package*/ static final SReferenceLink feature$SwK2 = MetaAdapterFactory.getReferenceLink(0x165f1d0525064544L, 0x895e1424f54166ecL, 0x7cde27c7fd8487c2L, 0x7cde27c7fd8487ccL, "feature");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept SubFeatureDotTarget$5P = MetaAdapterFactory.getConcept(0x165f1d0525064544L, 0x895e1424f54166ecL, 0x7cde27c7fd85baccL, "org.iets3.variability.featuremodel.base.structure.SubFeatureDotTarget");
    /*package*/ static final SConcept FeatureModelInclude$Iq = MetaAdapterFactory.getConcept(0x165f1d0525064544L, 0x895e1424f54166ecL, 0x375cadc475172168L, "org.iets3.variability.featuremodel.base.structure.FeatureModelInclude");
    /*package*/ static final SInterfaceConcept IPathPart$v0 = MetaAdapterFactory.getInterfaceConcept(0xf3eafff030d246d6L, 0x9150f0f3b880ce27L, 0x43d0987d9ba8d387L, "org.iets3.core.expr.path.structure.IPathPart");
    /*package*/ static final SConcept FeatureType$_L = MetaAdapterFactory.getConcept(0x165f1d0525064544L, 0x895e1424f54166ecL, 0x7cde27c7fd8487c2L, "org.iets3.variability.featuremodel.base.structure.FeatureType");
  }
}
