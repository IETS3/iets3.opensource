package org.iets3.components.core.editor;

/*Generated by MPS */

import jetbrains.mps.editor.runtime.descriptor.AbstractEditorBuilder;
import org.jetbrains.annotations.NotNull;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.openapi.editor.EditorContext;
import jetbrains.mps.openapi.editor.cells.EditorCell;
import jetbrains.mps.nodeEditor.cells.EditorCell_Collection;
import jetbrains.mps.nodeEditor.cellLayout.CellLayout_Vertical;
import jetbrains.mps.nodeEditor.AbstractCellProvider;
import jetbrains.mps.baseLanguage.closures.runtime._FunctionTypes;
import com.mbeddr.core.base.editor.VerticalWhitespaceCell;
import jetbrains.mps.baseLanguage.closures.runtime.Wrappers;
import de.itemis.mps.editor.diagram.runtime.jgraph.BaseDiagramECell;
import de.itemis.mps.editor.diagram.runtime.EditorUtil;
import de.itemis.mps.editor.diagram.runtime.jgraph.DiagramCreationContext;
import de.itemis.mps.editor.diagram.runtime.DiagramContext;
import de.itemis.mps.editor.diagram.runtime.ContextVariables;
import de.itemis.mps.editor.diagram.runtime.model.DiagramModel;
import de.itemis.mps.editor.diagram.runtime.jgraph.ElkLayouter;
import de.itemis.mps.editor.diagram.runtime.jgraph.LayeredLayouter;
import org.eclipse.elk.core.options.Direction;
import jetbrains.mps.openapi.editor.style.Style;
import jetbrains.mps.editor.runtime.style.StyleImpl;
import de.itemis.mps.editor.diagram.runtime.model.IDiagramAccessor;
import de.itemis.mps.editor.diagram.runtime.model.AbstractDiagramAccessor;
import java.util.List;
import de.itemis.mps.editor.diagram.runtime.model.IDiagramElementAccessor;
import de.itemis.mps.editor.diagram.runtime.model.IAccessorFactory;
import java.util.ArrayList;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import org.iets3.components.core.behavior.Component__BehaviorDescriptor;
import org.iets3.components.core.behavior.AbstractComponentInterface__BehaviorDescriptor;
import java.util.Collections;
import de.itemis.mps.editor.diagram.runtime.model.Port;
import de.itemis.mps.editor.diagram.runtime.shape.IShape;
import de.itemis.mps.editor.diagram.shapes.EmptyShape;
import de.itemis.mps.editor.diagram.runtime.model.AbstractBoxAccessor;
import de.itemis.mps.editor.diagram.runtime.model.AccessorKey;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import org.jetbrains.annotations.Nullable;
import org.iets3.components.core.behavior.PortCategory__BehaviorDescriptor;
import org.iets3.components.core.behavior.IPortType__BehaviorDescriptor;
import de.itemis.mps.editor.diagram.runtime.jgraph.MyGraph;
import de.itemis.mps.editor.diagram.runtime.model.IConnectionType;
import de.itemis.mps.editor.diagram.runtime.model.GeneratedConnectionType;
import de.itemis.mps.editor.diagram.runtime.model.IConnectionEndpoint;
import org.iets3.components.core.behavior.AbstractComponentInstanceBase__BehaviorDescriptor;
import java.util.Objects;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import jetbrains.mps.smodel.action.NodeFactoryManager;
import com.mxgraph.swing.mxGraphComponent;
import java.awt.Color;
import de.itemis.mps.editor.diagram.runtime.jgraph.MyGraphComponent;
import de.itemis.mps.editor.diagram.runtime.model.IPaletteEntryProvider;
import de.itemis.mps.editor.diagram.runtime.model.CompositePaletteEntryProvider;
import de.itemis.mps.editor.diagram.runtime.model.AbstractPaletteEntryProvider;
import de.itemis.mps.editor.diagram.runtime.model.IPaletteEntry;
import com.mbeddr.core.base.behavior.IVisibleElementProvider__BehaviorDescriptor;
import de.itemis.mps.editor.diagram.runtime.model.AbstractPaletteEntry;
import javax.swing.Icon;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import jetbrains.mps.internal.collections.runtime.IterableUtils;
import com.intellij.openapi.application.ApplicationManager;
import javax.swing.JOptionPane;
import org.iets3.components.core.behavior.IComponentsChunkContent__BehaviorDescriptor;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import de.itemis.mps.editor.diagram.runtime.substitute.SubstituteInfoFactory;
import de.itemis.mps.editor.diagram.runtime.jgraph.SubDiagramECell;
import de.itemis.mps.editor.diagram.runtime.jgraph.RootDiagramECell;
import javax.swing.JButton;
import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;
import jetbrains.mps.project.Project;
import jetbrains.mps.ide.project.ProjectHelper;
import de.itemis.mps.editor.diagram.runtime.jgraph.DiagramActionsUtil;
import jetbrains.mps.nodeEditor.cells.EditorCell_Component;
import de.itemis.mps.editor.diagram.runtime.jgraph.RootDCell;
import jetbrains.mps.lang.editor.tooltips.runtime.LazyTooltipCellEvaluator;
import jetbrains.mps.lang.editor.tooltips.runtime.TooltipWrapper;
import jetbrains.mps.lang.editor.tooltips.runtime.TooltipTimingProperties;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SEnumOperations;
import jetbrains.mps.nodeEditor.cells.EditorCell_Constant;
import jetbrains.mps.nodeEditor.cellLayout.CellLayout_Indent;
import jetbrains.mps.editor.runtime.style.StyleAttributes;
import org.jetbrains.mps.openapi.language.SProperty;
import jetbrains.mps.openapi.editor.menus.transformation.SPropertyInfo;
import jetbrains.mps.nodeEditor.cells.EditorCell_Property;
import jetbrains.mps.nodeEditor.cells.SPropertyAccessor;
import jetbrains.mps.nodeEditor.MPSFonts;
import jetbrains.mps.nodeEditor.cellMenu.SPropertySubstituteInfo;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.IAttributeDescriptor;
import jetbrains.mps.lang.core.behavior.PropertyAttribute__BehaviorDescriptor;
import jetbrains.mps.nodeEditor.EditorManager;
import jetbrains.mps.openapi.editor.update.AttributeKind;
import de.itemis.mps.editor.diagram.runtime.shape.ShapeEditorCell;
import org.iets3.components.core.behavior.Port__BehaviorDescriptor;
import jetbrains.mps.editor.runtime.style.CellAlign;
import jetbrains.mps.smodel.builder.SNodeBuilder;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import org.jetbrains.mps.openapi.language.SReferenceLink;
import org.jetbrains.mps.openapi.language.SInterfaceConcept;
import org.jetbrains.mps.openapi.language.SConcept;

/*package*/ class ComponentSubstructure_wiringDiagram_EditorBuilder_a extends AbstractEditorBuilder {
  @NotNull
  private SNode myNode;

  public ComponentSubstructure_wiringDiagram_EditorBuilder_a(@NotNull EditorContext context, @NotNull SNode node) {
    super(context);
    myNode = node;
  }

  @NotNull
  @Override
  public SNode getNode() {
    return myNode;
  }

  /*package*/ EditorCell createCell() {
    return createCollection_0();
  }

  private EditorCell createCollection_0() {
    EditorCell_Collection editorCell = new EditorCell_Collection(getEditorContext(), myNode, new CellLayout_Vertical());
    editorCell.setCellId("Collection_3b3739_a");
    editorCell.setBig(true);
    setCellContext(editorCell);
    try {
      getCellFactory().pushCellContext();
      getCellFactory().addCellContextHints(new String[]{"org.iets3.components.core.editor.org.iets3.components.isInDiagram"});
      editorCell.addEditorCell(createCustom_0());
      editorCell.addEditorCell(createDiagram_1());
      setInnerCellsContext(editorCell);
    } finally {
      getCellFactory().popCellContext();
    }
    return editorCell;
  }
  private EditorCell createCustom_0() {
    AbstractCellProvider provider = ((_FunctionTypes._return_P0_E0<VerticalWhitespaceCell>) () -> new VerticalWhitespaceCell(myNode, 10)).invoke();
    EditorCell editorCell = provider.createEditorCell(getEditorContext());
    editorCell.setCellId("Custom_3b3739_a0");
    return editorCell;
  }
  private EditorCell createDiagram_0(final EditorContext editorContext, final SNode node) {
    final Wrappers._T<BaseDiagramECell> editorCell = new Wrappers._T<BaseDiagramECell>(null);
    final Wrappers._T<EditorCell> alternativeCell = new Wrappers._T<EditorCell>(null);

    EditorUtil.noCaching(editorContext, () -> {
      DiagramCreationContext.createDiagram(() -> {
        DiagramContext.withContext(node, () -> editorCell.value, () -> {
          ContextVariables.withValue("thisNode", node, () -> {
            final ContextVariables _variablesContext = ContextVariables.getCurrent();
            DiagramModel model = DiagramModel.getModel(editorContext, node, "509610514783642690");
            final ElkLayouter layouter = new LayeredLayouter(Direction.RIGHT);
            layouter.toggleConnectBoxesWithoutDummyPort(false);
            ((_FunctionTypes._void_P0_E0) () -> {
              // the closure is necessary so that we can declare the style variable again in the current scope
              Style style = new StyleImpl();
              layouter.setParentsStyle(style);
            }).invoke();


            IDiagramAccessor accessor = new AbstractDiagramAccessor(node) {
              public List<? extends IDiagramElementAccessor> getElements(IAccessorFactory accessorFactory) {
                final List<IDiagramElementAccessor> elements = new ArrayList<IDiagramElementAccessor>();
                for (SNode e : Sequence.fromIterable(new Object() {
                  public Iterable<SNode> query() {
                    return ListSequence.fromList(SLinkOperations.getChildren(node, LINKS.contents$7e9r)).where((it) -> !(SNodeOperations.isInstanceOf(it, CONCEPTS.IEmpty$6_)));
                  }
                }.query())) {
                  elements.addAll(accessorFactory.fromSNode(e, false));
                }
                for (final SNode parameterObject : new Object() {
                  public Iterable<SNode> query() {
                    SNode compInterface = Component__BehaviorDescriptor.compInterface_idx8tpSA1cCO.invoke(SNodeOperations.cast(SNodeOperations.getParent(((SNode) _variablesContext.getValue("thisNode"))), CONCEPTS.Component$gR));
                    return ((compInterface != null) ? AbstractComponentInterface__BehaviorDescriptor.ports_idx8tpSA8agB.invoke(compInterface) : Sequence.fromIterable(Collections.<SNode>emptyList()));
                  }
                }.query()) {
                  ContextVariables.withParentAndValue(_variablesContext, "parameterObject", parameterObject, new Runnable() {
                    public void run() {
                      final ContextVariables _variablesContext = ContextVariables.getCurrent();
                      final EditorCell editorCell = new Inline_Builder_3b3739_a1b0(editorContext, parameterObject).createCell();

                      final List<Port> ports = new ArrayList<Port>();

                      final IShape shape = new EmptyShape();

                      AbstractBoxAccessor accessor = new AbstractBoxAccessor(new AccessorKey("port_" + SPropertyOperations.getString(((SNode) _variablesContext.getValue("parameterObject")), PROPS.name$MnvL) + ((SNode) _variablesContext.getValue("parameterObject")).getNodeId())) {
                        @Nullable
                        public SNode getSNode() {
                          return parameterObject;
                        }
                        public void delete() {
                          Sequence.fromIterable(SNodeOperations.ofConcept(SLinkOperations.getChildren(((SNode) _variablesContext.getValue("thisNode")), LINKS.contents$7e9r), CONCEPTS.ExportConnector$hw)).where((it) -> SLinkOperations.getTarget(it, LINKS.outerPort$ffZi) == ((SNode) _variablesContext.getValue("parameterObject"))).visitAll((it) -> SNodeOperations.deleteNode(it));
                          Sequence.fromIterable(SNodeOperations.ofConcept(SLinkOperations.getChildren(((SNode) _variablesContext.getValue("thisNode")), LINKS.contents$7e9r), CONCEPTS.ImportConnector$8o)).where((it) -> SLinkOperations.getTarget(it, LINKS.outerPort$3H4p) == ((SNode) _variablesContext.getValue("parameterObject"))).visitAll((it) -> SNodeOperations.deleteNode(it));
                          SNodeOperations.deleteNode(((SNode) _variablesContext.getValue("parameterObject")));
                        }
                        @NotNull
                        @Override
                        public List<EditorCell> getContentCells() {
                          return Collections.singletonList(editorCell);
                        }
                        @NotNull
                        @Override
                        public List<Port> getPorts() {
                          return ports;
                        }
                        @Override
                        public boolean isPreservePortOrder() {
                          return (boolean) PortCategory__BehaviorDescriptor.preserverOrder_id4a5BwhuNU42.invoke(SLinkOperations.getTarget(((SNode) _variablesContext.getValue("parameterObject")), LINKS.category$WD4l));
                        }
                        @Override
                        public IShape getShape() {
                          return shape;
                        }
                        @NotNull
                        @Override
                        public Iterable<SNode> getNavigationTargets() {
                          Iterable<SNode> result = Sequence.fromIterable(Collections.<SNode>emptyList());
                          result = Sequence.fromIterable(result).concat(Sequence.fromIterable(Sequence.<SNode>singleton(IPortType__BehaviorDescriptor.getReferencedNode_idsiw10GjEcX.invoke(SLinkOperations.getTarget(((SNode) _variablesContext.getValue("parameterObject")), LINKS.type$5Gl6)))));
                          return result;
                        }
                      };
                      accessor.setRootCell(editorCell);
                      MyGraph rootGraph = DiagramCreationContext.getRootGraph();
                      if (rootGraph != null) {
                        ElkLayouter layouter = (ElkLayouter) rootGraph.getRootDiagramModel().getLayouter();
                        layouter.addNodesStyle(accessor.getStyle(), accessor.getId());
                      }

                      elements.add(accessor);
                    }
                  });
                }
                return elements;
              }
              @Override
              public List<IConnectionType> getConnectionTypes() {
                List<IConnectionType> connectionTypes = new ArrayList<IConnectionType>();
                connectionTypes.addAll(Collections.singletonList(new GeneratedConnectionType() {
                  public String getName() {
                    return "Connector";
                  }
                  @Override
                  public boolean canCreate(final IConnectionEndpoint from, final IConnectionEndpoint to, final List<String> reasons) {
                    SNode fromNode = from.getSNode();
                    SNode toNode = to.getSNode();
                    if (SNodeOperations.isInstanceOf(fromNode, CONCEPTS.Port$gs) && SNodeOperations.isInstanceOf(toNode, CONCEPTS.AbstractComponentInstanceBase$QW)) {
                      if (isEmptyString(to.getPortName())) {
                        return true;
                      }
                      SNode fromPort = SNodeOperations.cast(fromNode, CONCEPTS.Port$gs);
                      SNode toPort = AbstractComponentInstanceBase__BehaviorDescriptor.findPortByID_idsiw10GLvYX.invoke(SNodeOperations.cast(toNode, CONCEPTS.AbstractComponentInstanceBase$QW), to.getPortName());
                      return Objects.equals(SNodeOperations.getConcept(SLinkOperations.getTarget(fromPort, LINKS.category$WD4l)), SNodeOperations.getConcept(SLinkOperations.getTarget(toPort, LINKS.category$WD4l))) && IPortType__BehaviorDescriptor.getReferencedNode_idsiw10GjEcX.invoke(SLinkOperations.getTarget(fromPort, LINKS.type$5Gl6)) == IPortType__BehaviorDescriptor.getReferencedNode_idsiw10GjEcX.invoke(SLinkOperations.getTarget(toPort, LINKS.type$5Gl6));
                    }
                    if (SNodeOperations.isInstanceOf(fromNode, CONCEPTS.AbstractComponentInstanceBase$QW) && SNodeOperations.isInstanceOf(toNode, CONCEPTS.Port$gs)) {
                      if (isEmptyString(from.getPortName())) {
                        return true;
                      }
                      SNode fromPort = AbstractComponentInstanceBase__BehaviorDescriptor.findPortByID_idsiw10GLvYX.invoke(SNodeOperations.cast(fromNode, CONCEPTS.AbstractComponentInstanceBase$QW), from.getPortName());
                      SNode toPort = SNodeOperations.cast(toNode, CONCEPTS.Port$gs);
                      return Objects.equals(SNodeOperations.getConcept(SLinkOperations.getTarget(fromPort, LINKS.category$WD4l)), SNodeOperations.getConcept(SLinkOperations.getTarget(toPort, LINKS.category$WD4l))) && IPortType__BehaviorDescriptor.getReferencedNode_idsiw10GjEcX.invoke(SLinkOperations.getTarget(fromPort, LINKS.type$5Gl6)) == IPortType__BehaviorDescriptor.getReferencedNode_idsiw10GjEcX.invoke(SLinkOperations.getTarget(toPort, LINKS.type$5Gl6));
                    }
                    if (SNodeOperations.isInstanceOf(fromNode, CONCEPTS.AbstractComponentInstanceBase$QW) && SNodeOperations.isInstanceOf(toNode, CONCEPTS.AbstractComponentInstanceBase$QW)) {
                      if (isEmptyString(from.getPortName()) && isEmptyString(to.getPortName())) {
                        return false;
                      }
                      SNode fromPort = AbstractComponentInstanceBase__BehaviorDescriptor.findPortByID_idsiw10GLvYX.invoke(SNodeOperations.cast(fromNode, CONCEPTS.AbstractComponentInstanceBase$QW), from.getPortName());
                      SNode toPort = AbstractComponentInstanceBase__BehaviorDescriptor.findPortByID_idsiw10GLvYX.invoke(SNodeOperations.cast(toNode, CONCEPTS.AbstractComponentInstanceBase$QW), to.getPortName());
                      if (SNodeOperations.getParent(fromNode) == SNodeOperations.getParent(toNode)) {
                        if ((fromPort != null) && (toPort != null)) {
                          return SNodeOperations.isInstanceOf(SLinkOperations.getTarget(toPort, LINKS.category$WD4l), SNodeOperations.asSConcept(PortCategory__BehaviorDescriptor.oppositeCategory_idmIQkxfpv6J.invoke(SLinkOperations.getTarget(fromPort, LINKS.category$WD4l)))) && IPortType__BehaviorDescriptor.getReferencedNode_idsiw10GjEcX.invoke(SLinkOperations.getTarget(fromPort, LINKS.type$5Gl6)) == IPortType__BehaviorDescriptor.getReferencedNode_idsiw10GjEcX.invoke(SLinkOperations.getTarget(toPort, LINKS.type$5Gl6));
                        } else {
                          return true;
                        }
                      } else if (SNodeOperations.getNodeAncestor(fromNode, CONCEPTS.Component$gR, false, false) == AbstractComponentInstanceBase__BehaviorDescriptor.component_id77HYM7H$sfU.invoke(SNodeOperations.cast(toNode, CONCEPTS.AbstractComponentInstanceBase$QW)) || SNodeOperations.getNodeAncestor(toNode, CONCEPTS.Component$gR, false, false) == AbstractComponentInstanceBase__BehaviorDescriptor.component_id77HYM7H$sfU.invoke(SNodeOperations.cast(fromNode, CONCEPTS.AbstractComponentInstanceBase$QW))) {
                        if ((fromPort != null) && (toPort != null)) {
                          return Objects.equals(SNodeOperations.getConcept(SLinkOperations.getTarget(toPort, LINKS.category$WD4l)), SNodeOperations.getConcept(SLinkOperations.getTarget(fromPort, LINKS.category$WD4l))) && IPortType__BehaviorDescriptor.getReferencedNode_idsiw10GjEcX.invoke(SLinkOperations.getTarget(fromPort, LINKS.type$5Gl6)) == IPortType__BehaviorDescriptor.getReferencedNode_idsiw10GjEcX.invoke(SLinkOperations.getTarget(toPort, LINKS.type$5Gl6));
                        } else {
                          return true;
                        }
                      }
                    }
                    return false;
                  }
                  @Override
                  public void create(final IConnectionEndpoint from, final IConnectionEndpoint to) {
                    SNode fromNode = from.getSNode();
                    SNode toNode = to.getSNode();

                    if (SNodeOperations.isInstanceOf(fromNode, CONCEPTS.Port$gs) && SNodeOperations.isInstanceOf(toNode, CONCEPTS.AbstractComponentInstanceBase$QW)) {
                      ComponentSubstructureDiagramHelper.createConnector(SNodeOperations.cast(fromNode, CONCEPTS.Port$gs), SNodeOperations.cast(toNode, CONCEPTS.AbstractComponentInstanceBase$QW), to.getPortName());
                    }

                    if (SNodeOperations.isInstanceOf(fromNode, CONCEPTS.AbstractComponentInstanceBase$QW) && SNodeOperations.isInstanceOf(toNode, CONCEPTS.Port$gs)) {
                      ComponentSubstructureDiagramHelper.createConnector(SNodeOperations.cast(toNode, CONCEPTS.Port$gs), SNodeOperations.cast(fromNode, CONCEPTS.AbstractComponentInstanceBase$QW), from.getPortName());
                    }

                    if (SNodeOperations.isInstanceOf(fromNode, CONCEPTS.AbstractComponentInstanceBase$QW) && SNodeOperations.isInstanceOf(toNode, CONCEPTS.AbstractComponentInstanceBase$QW)) {
                      SNode toInstance = SNodeOperations.cast(toNode, CONCEPTS.AbstractComponentInstanceBase$QW);
                      SNode fromInstance = SNodeOperations.cast(fromNode, CONCEPTS.AbstractComponentInstanceBase$QW);
                      SNode fromComponent = AbstractComponentInstanceBase__BehaviorDescriptor.component_id77HYM7H$sfU.invoke(fromInstance);
                      if (SNodeOperations.getParent(fromNode) == SNodeOperations.getParent(toNode)) {
                        SNode fromPort;
                        SNode toPort;
                        if (isEmptyString(from.getPortName())) {
                          toPort = AbstractComponentInstanceBase__BehaviorDescriptor.findPortByID_idsiw10GLvYX.invoke(toInstance, to.getPortName());
                          fromPort = createPort_3b3739_a0b0c0d0h0a0b0(SNodeOperations.copyNode(SLinkOperations.getTarget(toPort, LINKS.type$5Gl6)), SConceptOperations.createNewNode(SNodeOperations.asInstanceConcept(PortCategory__BehaviorDescriptor.oppositeCategory_idmIQkxfpv6J.invoke(SLinkOperations.getTarget(toPort, LINKS.category$WD4l)))));
                          NodeFactoryManager.setupNode(CONCEPTS.Port$gs, fromPort, null, Component__BehaviorDescriptor.ensureCompInterface_idx8tpSAdmRF.invoke(fromComponent), SNodeOperations.getModel(fromComponent));
                          ListSequence.fromList(Component__BehaviorDescriptor.interfaceContent_idx8tpSAdLM$.invoke(fromComponent)).addElement(fromPort);
                        } else {
                          fromPort = AbstractComponentInstanceBase__BehaviorDescriptor.findPortByID_idsiw10GLvYX.invoke(fromInstance, from.getPortName());
                          if (isEmptyString(to.getPortName())) {
                            SNode toComponent = AbstractComponentInstanceBase__BehaviorDescriptor.component_id77HYM7H$sfU.invoke(toInstance);
                            toPort = createPort_3b3739_a0b0b0a2a3a7a0a1a(SNodeOperations.copyNode(SLinkOperations.getTarget(fromPort, LINKS.type$5Gl6)), SConceptOperations.createNewNode(SNodeOperations.asInstanceConcept(PortCategory__BehaviorDescriptor.oppositeCategory_idmIQkxfpv6J.invoke(SLinkOperations.getTarget(fromPort, LINKS.category$WD4l)))));
                            NodeFactoryManager.setupNode(CONCEPTS.Port$gs, toPort, null, Component__BehaviorDescriptor.ensureCompInterface_idx8tpSAdmRF.invoke(toComponent), SNodeOperations.getModel(toComponent));
                            ListSequence.fromList(Component__BehaviorDescriptor.interfaceContent_idx8tpSAdLM$.invoke(toComponent)).addElement(toPort);
                          } else {
                            toPort = AbstractComponentInstanceBase__BehaviorDescriptor.findPortByID_idsiw10GLvYX.invoke(toInstance, to.getPortName());
                          }
                        }

                        SNode ss = SNodeOperations.getNodeAncestor(toNode, CONCEPTS.ComponentSubstructure$oB, false, false);
                        if ((boolean) PortCategory__BehaviorDescriptor.actsAsSourceOfConnector_idmIQkxfpv6p.invoke(SLinkOperations.getTarget(fromPort, LINKS.category$WD4l))) {
                          SNode assemblyConnector = createAssemblyConnector_3b3739_a0a0f0d0h0a0b0(IPortType__BehaviorDescriptor.createConnectorType_id4KDeVD8s9TJ.invoke(SLinkOperations.getTarget(fromPort, LINKS.type$5Gl6)), fromInstance, fromPort, toInstance, toPort);
                          NodeFactoryManager.setupNode(CONCEPTS.AssemblyConnector$qU, assemblyConnector, null, ss, SNodeOperations.getModel(ss));
                          ListSequence.fromList(SLinkOperations.getChildren(ss, LINKS.contents$7e9r)).addElement(assemblyConnector);
                        } else {
                          SNode assemblyConnector = createAssemblyConnector_3b3739_a0a0a5a3a7a0a1a(IPortType__BehaviorDescriptor.createConnectorType_id4KDeVD8s9TJ.invoke(SLinkOperations.getTarget(fromPort, LINKS.type$5Gl6)), toInstance, toPort, fromInstance, fromPort);
                          NodeFactoryManager.setupNode(CONCEPTS.AssemblyConnector$qU, assemblyConnector, null, ss, SNodeOperations.getModel(ss));
                          ListSequence.fromList(SLinkOperations.getChildren(ss, LINKS.contents$7e9r)).addElement(assemblyConnector);
                        }
                      } else {
                        SNode fromPort = AbstractComponentInstanceBase__BehaviorDescriptor.findPortByID_idsiw10GLvYX.invoke(fromInstance, from.getPortName());
                        SNode toPort = AbstractComponentInstanceBase__BehaviorDescriptor.findPortByID_idsiw10GLvYX.invoke(toInstance, to.getPortName());
                        if (SNodeOperations.getNodeAncestor(toNode, CONCEPTS.Component$gR, false, false) == fromComponent) {
                          ComponentSubstructureDiagramHelper.createConnector(fromPort, toInstance, to.getPortName());
                        } else {
                          ComponentSubstructureDiagramHelper.createConnector(toPort, fromInstance, from.getPortName());
                        }
                      }
                    }
                  }

                }));
                return connectionTypes;
              }





















              @Override
              public boolean runAutoLayoutOnInit() {
                boolean autoLayoutFlag = false;
                return autoLayoutFlag;
              }

              @Override
              public boolean runAutoLayoutOnChange() {
                boolean autoLayoutFlag = false;
                return autoLayoutFlag;
              }

              @Override
              public boolean fitToSizeOnInit() {
                boolean fitToSize = false;
                return fitToSize;
              }

              @Override
              public boolean disableNodeEditing() {
                boolean disableEditing = false;
                return disableEditing;
              }

              @Override
              public boolean syncWithModelOnlyOnOpening() {
                boolean flag = false;
                return flag;
              }

              @Override
              public boolean allowElementsToBeBelowRequiredSize() {
                boolean flag = false;
                return flag;
              }

              @Override
              public boolean showGrid() {
                boolean flag = false;
                return flag;
              }

              @Override
              public int getGridSize() {
                int size = 10;
                return size;
              }


              @Override
              public int getGridStyle() {
                try {
                  return mxGraphComponent.class.getDeclaredField("GRID_STYLE_DOT").getInt(null);
                } catch (Exception ex) {
                  return 0;
                }
              }

              @Override
              public Color getGridColor() {
                Color color = null;
                return color;
              }

              @Override
              public boolean useGridSnapping() {
                boolean flag = false;
                return flag;
              }


              @Override
              public double getArrowKeyMoveAmount() {
                double amount = MyGraphComponent.DEFAULT_ARROW_KEY_MOVE_AMOUNT;
                return amount;
              }

              @Override
              public double getArrowKeyMoveAmountSlow() {
                double amount = MyGraphComponent.DEFAULT_ARROW_KEY_MOVE_AMOUNT_SLOW;
                return amount;
              }

              @Override
              public double getPanAmount() {
                double amount = MyGraphComponent.DEFAULT_PAN_AMOUNT;
                return amount;
              }

              @Override
              public double getPanAmountSlow() {
                double amount = MyGraphComponent.DEFAULT_PAN_AMOUNT_SLOW;
                return amount;
              }

              @Override
              public double getMinimumScale() {
                double scale = MyGraphComponent.DEFAULT_MINIMUM_SCALE;
                return scale;
              }
            };

            model.setDiagramAccessor(accessor);

            IPaletteEntryProvider paletteEntryProvider = new CompositePaletteEntryProvider(new AbstractPaletteEntryProvider() {
              @Override
              public Iterable<IPaletteEntry> getEntries() {
                Iterable<SNode> components = SNodeOperations.ofConcept(IVisibleElementProvider__BehaviorDescriptor.visibleContentsOfTypeAsSequence_id3g6LnlWuSo8.invoke(SNodeOperations.getNodeAncestor(node, CONCEPTS.IVisibleElementProvider$$O, false, false), CONCEPTS.Component$gR), CONCEPTS.Component$gR);
                return Sequence.fromIterable(components).select((final SNode it) -> {
                  return new AbstractPaletteEntry() {
                    public Icon getIcon() {
                      return (Icon) Component__BehaviorDescriptor.getComponentIconSmall_id7jwD7MQjeSk.invoke(it);
                    }
                    @NotNull
                    public String getText() {
                      return SPropertyOperations.getString(it, PROPS.name$MnvL);
                    }
                    @Nullable
                    public SAbstractConcept getOutputConcept() {
                      return CONCEPTS.ComponentInstance$7c;
                    }
                    @Nullable
                    public SNode execute() {
                      Iterable<SNode> compNesting = ListSequence.fromList(DiagramContext.getAllDiagramNodes()).select(new _FunctionTypes._return_P1_E0<SNode, SNode>() {
                        public SNode invoke(SNode it) {
                          if (SNodeOperations.isInstanceOf(it, CONCEPTS.ComponentInstance$7c)) {
                            return SLinkOperations.getTarget(SLinkOperations.getTarget(SNodeOperations.cast(it, CONCEPTS.ComponentInstance$7c), LINKS.component$xlLY), LINKS.ref$KPLr);
                          } else {
                            return SNodeOperations.getNodeAncestor(it, CONCEPTS.Component$gR, false, false);
                          }
                        }
                      });
                      if (Sequence.fromIterable(compNesting).contains(it)) {
                        final String nestedPath = IterableUtils.join(Sequence.fromIterable(compNesting).concat(Sequence.fromIterable(Sequence.<SNode>singleton(it))).skip(Sequence.fromIterable(compNesting).indexOf(it)).select(new _FunctionTypes._return_P1_E0<String, SNode>() {
                          public String invoke(SNode it) {
                            return SPropertyOperations.getString(it, PROPS.name$MnvL);
                          }
                        }), " -> ");
                        ApplicationManager.getApplication().invokeLater(() -> JOptionPane.showMessageDialog(null, "Attempted to create recursive nesting of components:\n" + nestedPath, "Illegal nesting", JOptionPane.WARNING_MESSAGE));
                        return null;
                      }
                      SNode ci = createComponentInstance_3b3739_a0c0d0a0a0a0a1a0b0(it);
                      NodeFactoryManager.setupNode(CONCEPTS.ComponentInstance$7c, ci, null, node, SNodeOperations.getModel(node));
                      ListSequence.fromList(SLinkOperations.getChildren(node, LINKS.contents$7e9r)).addElement(ci);
                      return ci;
                    }
                    public String getFolderName() {
                      return SPropertyOperations.getString(SNodeOperations.getNodeAncestor(it, CONCEPTS.Chunk$sT, false, false), PROPS.name$MnvL);
                    }
                  };
                });
              }
            }, new AbstractPaletteEntryProvider() {
              @Override
              public Iterable<IPaletteEntry> getEntries() {
                IPaletteEntry newSubcompEntry = new AbstractPaletteEntry() {
                  @Nullable
                  public Icon getIcon() {
                    return (Icon) IComponentsChunkContent__BehaviorDescriptor.getIcon_id2JYumEA$tiF.invoke(SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x6c4f9fd23e484601L, "org.iets3.components.core.structure.Component")));
                  }
                  @NotNull
                  public String getText() {
                    return "New Subcomponent";
                  }
                  @Nullable
                  public SAbstractConcept getOutputConcept() {
                    return CONCEPTS.ComponentInstance$7c;
                  }
                  @Nullable
                  public SNode execute() {
                    SNode existingComponent = SNodeOperations.getNodeAncestor(node, CONCEPTS.Component$gR, false, false);
                    SAbstractConcept componentConcept = ValidReplacementHelper.findValidReplacementConcept(existingComponent, CONCEPTS.Component$gR, new SubstituteInfoFactory(getEditorContext(), node));
                    SNode newComponent = SNodeOperations.cast(NodeFactoryManager.createNode(componentConcept, null, SNodeOperations.getParent(existingComponent), SNodeOperations.getModel(existingComponent)), CONCEPTS.Component$gR);
                    if (isEmptyString(SPropertyOperations.getString(newComponent, PROPS.name$MnvL))) {
                      SPropertyOperations.assign(newComponent, PROPS.name$MnvL, "NewComponent");
                    }

                    SNodeOperations.insertNextSiblingChild(existingComponent, newComponent);
                    SNode ci = createComponentInstance_3b3739_a0g0d0a0a0a1b0(newComponent);
                    NodeFactoryManager.setupNode(CONCEPTS.ComponentInstance$7c, ci, null, node, SNodeOperations.getModel(node));
                    ListSequence.fromList(SLinkOperations.getChildren(node, LINKS.contents$7e9r)).addElement(ci);
                    return ci;
                  }
                };
                return Sequence.<IPaletteEntry>singleton(newSubcompEntry);
              }
            });
            model.setPaletteEntryProvider(paletteEntryProvider);

            if (DiagramCreationContext.isSubdiagram()) {
              editorCell.value = new SubDiagramECell(editorContext, node, model);
            } else {
              editorCell.value = new RootDiagramECell(editorContext, node, model);
              RootDiagramECell rootCell = (RootDiagramECell) editorCell.value;
              if (rootCell.showInViewer()) {
                JButton openedInViewer = new JButton("open diagram in editor");
                openedInViewer.setOpaque(false);
                openedInViewer.addActionListener(new ActionListener() {
                  @Override
                  public void actionPerformed(ActionEvent e) {
                    Project mpsProject = ProjectHelper.getProject(editorContext.getRepository());
                    if (mpsProject == null) {
                      return;
                    }
                    com.intellij.openapi.project.Project ideaProject = ProjectHelper.toIdeaProject(mpsProject);
                    if (ideaProject == null) {
                      return;
                    }

                    DiagramActionsUtil.updateViewer(ideaProject, rootCell, editorContext.getEditorComponent());
                  }
                });
                alternativeCell.value = new EditorCell_Component(editorContext, node, openedInViewer);
                return;
              }
              rootCell.runAutoLayouterOnInit(node, accessor.runAutoLayoutOnInit());
              rootCell.fitToSizeOnInit(node, accessor.fitToSizeOnInit());
              if (accessor.disableNodeEditing()) {
                rootCell.getGraph().getGraphComponent().getCellEditor().setDisabled(true);
              }
            }
            editorCell.value.setCellId("Diagram_3b3739_b0");

            if (editorCell.value.getContextGraph() != null) {
              Object defaultParent = editorCell.value.getContextGraph().getDefaultParent();
              if (defaultParent instanceof RootDCell) {
                RootDCell rootDCell = ((RootDCell) defaultParent);
                rootDCell.resetButtonConfig();
              }
            }
          });
        });
      });
    });


    if (alternativeCell.value != null) {
      return alternativeCell.value;
    }
    return editorCell.value;
  }
  private EditorCell createDiagram_1() {
    return createDiagram_0(getEditorContext(), myNode);
  }
  /*package*/ static class Inline_Builder_3b3739_a1b0 extends AbstractEditorBuilder {
    @NotNull
    private SNode myNode;

    /*package*/ Inline_Builder_3b3739_a1b0(@NotNull EditorContext context, @NotNull SNode node) {
      super(context);
      myNode = node;
    }

    /*package*/ EditorCell createCell() {
      return createTooltip_1();
    }

    @NotNull
    @Override
    public SNode getNode() {
      return myNode;
    }

    private EditorCell createTooltip_0(final EditorContext editorContext, final SNode node) {
      LazyTooltipCellEvaluator tooltip = new LazyTooltipCellEvaluator(editorContext, node, "org.iets3.components.core.editor.GeneratedHints.tooltipHint_3b3739_a0b1a", false);
      EditorCell visibleCell = createCollection_1();

      TooltipWrapper editorCell = new TooltipWrapper(editorContext, node, visibleCell, tooltip, TooltipTimingProperties.DEFAULT);
      editorCell.setCellId("Tooltip_3b3739_a0b1a");
      return editorCell;
    }
    private EditorCell createTooltip_1() {
      return createTooltip_0(getEditorContext(), myNode);
    }
    private EditorCell createCollection_1() {
      EditorCell_Collection editorCell = new EditorCell_Collection(getEditorContext(), myNode, new CellLayout_Vertical());
      editorCell.setCellId("Collection_3b3739_a0a1b0");
      editorCell.addEditorCell(createConstant_0());
      if (nodeCondition_3b3739_a1a0a1b0()) {
        editorCell.addEditorCell(createCollection_2());
      }
      if (nodeCondition_3b3739_a2a0a1b0()) {
        editorCell.addEditorCell(createCollection_5());
      }
      if (nodeCondition_3b3739_a3a0a1b0()) {
        editorCell.addEditorCell(createCollection_8());
      }
      if (nodeCondition_3b3739_a4a0a1b0()) {
        editorCell.addEditorCell(createCollection_11());
      }
      return editorCell;
    }
    private boolean nodeCondition_3b3739_a1a0a1b0() {
      return PortCategory__BehaviorDescriptor.kind_idsiw10H0omi.invoke(SLinkOperations.getTarget(myNode, LINKS.category$WD4l)).equals(SEnumOperations.getMember(MetaAdapterFactory.getEnumeration(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x71280102d0188dfL, "org.iets3.components.core.structure.PortCategoryKind"), 0x71280102d0188e0L, "left"));
    }
    private boolean nodeCondition_3b3739_a2a0a1b0() {
      return PortCategory__BehaviorDescriptor.kind_idsiw10H0omi.invoke(SLinkOperations.getTarget(myNode, LINKS.category$WD4l)).equals(SEnumOperations.getMember(MetaAdapterFactory.getEnumeration(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x71280102d0188dfL, "org.iets3.components.core.structure.PortCategoryKind"), 0x71280102d0188f9L, "right"));
    }
    private boolean nodeCondition_3b3739_a3a0a1b0() {
      return PortCategory__BehaviorDescriptor.kind_idsiw10H0omi.invoke(SLinkOperations.getTarget(myNode, LINKS.category$WD4l)).equals(SEnumOperations.getMember(MetaAdapterFactory.getEnumeration(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x71280102d0188dfL, "org.iets3.components.core.structure.PortCategoryKind"), 0x71280102d0188fcL, "top"));
    }
    private boolean nodeCondition_3b3739_a4a0a1b0() {
      return PortCategory__BehaviorDescriptor.kind_idsiw10H0omi.invoke(SLinkOperations.getTarget(myNode, LINKS.category$WD4l)).equals(SEnumOperations.getMember(MetaAdapterFactory.getEnumeration(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x71280102d0188dfL, "org.iets3.components.core.structure.PortCategoryKind"), 0x71280102d018900L, "bottom"));
    }
    private EditorCell createConstant_0() {
      EditorCell_Constant editorCell = new EditorCell_Constant(getEditorContext(), myNode, "");
      editorCell.setCellId("Constant_3b3739_a0a0b1a");
      editorCell.setDefaultText("");
      return editorCell;
    }
    private EditorCell createCollection_2() {
      EditorCell_Collection editorCell = new EditorCell_Collection(getEditorContext(), myNode, new CellLayout_Indent());
      editorCell.setCellId("Collection_3b3739_b0a0b1a");
      editorCell.addEditorCell(createCollection_3());
      return editorCell;
    }
    private EditorCell createCollection_3() {
      EditorCell_Collection editorCell = new EditorCell_Collection(getEditorContext(), myNode, new CellLayout_Indent());
      editorCell.setCellId("Collection_3b3739_a1a0a1b0");
      Style style = new StyleImpl();
      style.set(StyleAttributes.SELECTABLE, false);
      editorCell.getStyle().putAll(style);
      editorCell.addEditorCell(createCollection_4());
      editorCell.addEditorCell(createShape_1());
      return editorCell;
    }
    private EditorCell createCollection_4() {
      EditorCell_Collection editorCell = new EditorCell_Collection(getEditorContext(), myNode, new CellLayout_Indent());
      editorCell.setCellId("Collection_3b3739_a0b0a0b1a");
      editorCell.addEditorCell(createProperty_0());
      editorCell.addEditorCell(createConstant_1());
      return editorCell;
    }
    private EditorCell createProperty_0() {
      getCellFactory().pushCellContext();
      try {
        final SProperty property = PROPS.name$MnvL;
        getCellFactory().setPropertyInfo(new SPropertyInfo(myNode, property));
        EditorCell_Property editorCell = EditorCell_Property.create(getEditorContext(), new SPropertyAccessor(myNode, property, false, false), myNode);
        editorCell.setDefaultText("<no name>");
        editorCell.setCellId("property_name");
        Style style = new StyleImpl();
        style.set(StyleAttributes.FONT_STYLE, MPSFonts.BOLD);
        editorCell.getStyle().putAll(style);
        editorCell.setSubstituteInfo(new SPropertySubstituteInfo(editorCell, property));
        setCellContext(editorCell);
        Iterable<SNode> propertyAttributes = SNodeOperations.ofConcept(new IAttributeDescriptor.AllAttributes().list(myNode), CONCEPTS.PropertyAttribute$Gb);
        Iterable<SNode> currentPropertyAttributes = Sequence.fromIterable(propertyAttributes).where((it) -> Objects.equals(PropertyAttribute__BehaviorDescriptor.getProperty_id1avfQ4BBzOo.invoke(it), property));
        if (Sequence.fromIterable(currentPropertyAttributes).isNotEmpty()) {
          EditorManager manager = EditorManager.getInstanceFromContext(getEditorContext());
          return manager.createNodeRoleAttributeCell(Sequence.fromIterable(currentPropertyAttributes).first(), AttributeKind.PROPERTY, editorCell);
        } else
        return editorCell;
      } finally {
        getCellFactory().popCellContext();
      }
    }
    private EditorCell createConstant_1() {
      EditorCell_Constant editorCell = new EditorCell_Constant(getEditorContext(), myNode, " ");
      editorCell.setCellId("Constant_3b3739_b0a1a0a1b0");
      Style style = new StyleImpl();
      style.set(StyleAttributes.SELECTABLE, false);
      editorCell.getStyle().putAll(style);
      editorCell.setDefaultText("");
      return editorCell;
    }
    private EditorCell createShape_0(final EditorContext editorContext, final SNode node) {
      final Wrappers._T<ShapeEditorCell> editorCell = new Wrappers._T<ShapeEditorCell>();
      ContextVariables.withValue("thisNode", node, () -> {
        final ContextVariables _variablesContext = ContextVariables.getCurrent();
        editorCell.value = new ShapeEditorCell(editorContext, node, new PortShape((boolean) Port__BehaviorDescriptor.isOptional_idmIQkxf$r$2.invoke(((SNode) _variablesContext.getValue("parameterObject"))), IPortType__BehaviorDescriptor.characteristicColor_idmIQkxg4rmC.invoke(SLinkOperations.getTarget(((SNode) _variablesContext.getValue("parameterObject")), LINKS.type$5Gl6)), PortCategory__BehaviorDescriptor.shapeRenderer_idmIQkxgiY42.invoke(SLinkOperations.getTarget(((SNode) _variablesContext.getValue("parameterObject")), LINKS.category$WD4l))));
        editorCell.value.setDefaultWidth(20);
        editorCell.value.setDefaultHeight(20);
        editorCell.value.setCellId("Shape_3b3739_b0b0a0b1a");
        Style style = new StyleImpl();
        style.set(StyleAttributes.HORIZONTAL_ALIGN, CellAlign.RIGHT);
        editorCell.value.getStyle().putAll(style);
      });
      return editorCell.value;
    }
    private EditorCell createShape_1() {
      return createShape_0(getEditorContext(), myNode);
    }
    private EditorCell createCollection_5() {
      EditorCell_Collection editorCell = new EditorCell_Collection(getEditorContext(), myNode, new CellLayout_Indent());
      editorCell.setCellId("Collection_3b3739_c0a0b1a");
      editorCell.addEditorCell(createCollection_6());
      return editorCell;
    }
    private EditorCell createCollection_6() {
      EditorCell_Collection editorCell = new EditorCell_Collection(getEditorContext(), myNode, new CellLayout_Indent());
      editorCell.setCellId("Collection_3b3739_a2a0a1b0");
      Style style = new StyleImpl();
      style.set(StyleAttributes.SELECTABLE, false);
      editorCell.getStyle().putAll(style);
      editorCell.addEditorCell(createShape_3());
      editorCell.addEditorCell(createCollection_7());
      return editorCell;
    }
    private EditorCell createShape_2(final EditorContext editorContext, final SNode node) {
      final Wrappers._T<ShapeEditorCell> editorCell = new Wrappers._T<ShapeEditorCell>();
      ContextVariables.withValue("thisNode", node, () -> {
        final ContextVariables _variablesContext = ContextVariables.getCurrent();
        editorCell.value = new ShapeEditorCell(editorContext, node, new PortShape((boolean) Port__BehaviorDescriptor.isOptional_idmIQkxf$r$2.invoke(((SNode) _variablesContext.getValue("parameterObject"))), IPortType__BehaviorDescriptor.characteristicColor_idmIQkxg4rmC.invoke(SLinkOperations.getTarget(((SNode) _variablesContext.getValue("parameterObject")), LINKS.type$5Gl6)), PortCategory__BehaviorDescriptor.shapeRenderer_idmIQkxgiY42.invoke(SLinkOperations.getTarget(((SNode) _variablesContext.getValue("parameterObject")), LINKS.category$WD4l))));
        editorCell.value.setDefaultWidth(20);
        editorCell.value.setDefaultHeight(20);
        editorCell.value.setCellId("Shape_3b3739_a0c0a0b1a");
        Style style = new StyleImpl();
        style.set(StyleAttributes.HORIZONTAL_ALIGN, CellAlign.RIGHT);
        editorCell.value.getStyle().putAll(style);
      });
      return editorCell.value;
    }
    private EditorCell createShape_3() {
      return createShape_2(getEditorContext(), myNode);
    }
    private EditorCell createCollection_7() {
      EditorCell_Collection editorCell = new EditorCell_Collection(getEditorContext(), myNode, new CellLayout_Indent());
      editorCell.setCellId("Collection_3b3739_b0c0a0b1a");
      editorCell.addEditorCell(createConstant_2());
      editorCell.addEditorCell(createProperty_1());
      return editorCell;
    }
    private EditorCell createConstant_2() {
      EditorCell_Constant editorCell = new EditorCell_Constant(getEditorContext(), myNode, " ");
      editorCell.setCellId("Constant_3b3739_a1a2a0a1b0");
      Style style = new StyleImpl();
      style.set(StyleAttributes.SELECTABLE, false);
      editorCell.getStyle().putAll(style);
      editorCell.setDefaultText("");
      return editorCell;
    }
    private EditorCell createProperty_1() {
      getCellFactory().pushCellContext();
      try {
        final SProperty property = PROPS.name$MnvL;
        getCellFactory().setPropertyInfo(new SPropertyInfo(myNode, property));
        EditorCell_Property editorCell = EditorCell_Property.create(getEditorContext(), new SPropertyAccessor(myNode, property, false, false), myNode);
        editorCell.setDefaultText("<no name>");
        editorCell.setCellId("property_name1");
        Style style = new StyleImpl();
        style.set(StyleAttributes.FONT_STYLE, MPSFonts.BOLD);
        editorCell.getStyle().putAll(style);
        editorCell.setSubstituteInfo(new SPropertySubstituteInfo(editorCell, property));
        setCellContext(editorCell);
        Iterable<SNode> propertyAttributes = SNodeOperations.ofConcept(new IAttributeDescriptor.AllAttributes().list(myNode), CONCEPTS.PropertyAttribute$Gb);
        Iterable<SNode> currentPropertyAttributes = Sequence.fromIterable(propertyAttributes).where((it) -> Objects.equals(PropertyAttribute__BehaviorDescriptor.getProperty_id1avfQ4BBzOo.invoke(it), property));
        if (Sequence.fromIterable(currentPropertyAttributes).isNotEmpty()) {
          EditorManager manager = EditorManager.getInstanceFromContext(getEditorContext());
          return manager.createNodeRoleAttributeCell(Sequence.fromIterable(currentPropertyAttributes).first(), AttributeKind.PROPERTY, editorCell);
        } else
        return editorCell;
      } finally {
        getCellFactory().popCellContext();
      }
    }
    private EditorCell createCollection_8() {
      EditorCell_Collection editorCell = new EditorCell_Collection(getEditorContext(), myNode, new CellLayout_Indent());
      editorCell.setCellId("Collection_3b3739_d0a0b1a");
      editorCell.addEditorCell(createCollection_9());
      return editorCell;
    }
    private EditorCell createCollection_9() {
      EditorCell_Collection editorCell = new EditorCell_Collection(getEditorContext(), myNode, new CellLayout_Vertical());
      editorCell.setCellId("Collection_3b3739_a3a0a1b0");
      Style style = new StyleImpl();
      style.set(StyleAttributes.SELECTABLE, false);
      editorCell.getStyle().putAll(style);
      editorCell.addEditorCell(createCollection_10());
      editorCell.addEditorCell(createShape_5());
      return editorCell;
    }
    private EditorCell createCollection_10() {
      EditorCell_Collection editorCell = new EditorCell_Collection(getEditorContext(), myNode, new CellLayout_Indent());
      editorCell.setCellId("Collection_3b3739_a0d0a0b1a");
      editorCell.addEditorCell(createProperty_2());
      return editorCell;
    }
    private EditorCell createProperty_2() {
      getCellFactory().pushCellContext();
      try {
        final SProperty property = PROPS.name$MnvL;
        getCellFactory().setPropertyInfo(new SPropertyInfo(myNode, property));
        EditorCell_Property editorCell = EditorCell_Property.create(getEditorContext(), new SPropertyAccessor(myNode, property, false, false), myNode);
        editorCell.setDefaultText("<no name>");
        editorCell.setCellId("property_name2");
        Style style = new StyleImpl();
        style.set(StyleAttributes.FONT_STYLE, MPSFonts.BOLD);
        editorCell.getStyle().putAll(style);
        editorCell.setSubstituteInfo(new SPropertySubstituteInfo(editorCell, property));
        setCellContext(editorCell);
        Iterable<SNode> propertyAttributes = SNodeOperations.ofConcept(new IAttributeDescriptor.AllAttributes().list(myNode), CONCEPTS.PropertyAttribute$Gb);
        Iterable<SNode> currentPropertyAttributes = Sequence.fromIterable(propertyAttributes).where((it) -> Objects.equals(PropertyAttribute__BehaviorDescriptor.getProperty_id1avfQ4BBzOo.invoke(it), property));
        if (Sequence.fromIterable(currentPropertyAttributes).isNotEmpty()) {
          EditorManager manager = EditorManager.getInstanceFromContext(getEditorContext());
          return manager.createNodeRoleAttributeCell(Sequence.fromIterable(currentPropertyAttributes).first(), AttributeKind.PROPERTY, editorCell);
        } else
        return editorCell;
      } finally {
        getCellFactory().popCellContext();
      }
    }
    private EditorCell createShape_4(final EditorContext editorContext, final SNode node) {
      final Wrappers._T<ShapeEditorCell> editorCell = new Wrappers._T<ShapeEditorCell>();
      ContextVariables.withValue("thisNode", node, () -> {
        final ContextVariables _variablesContext = ContextVariables.getCurrent();
        editorCell.value = new ShapeEditorCell(editorContext, node, new PortShape((boolean) Port__BehaviorDescriptor.isOptional_idmIQkxf$r$2.invoke(((SNode) _variablesContext.getValue("parameterObject"))), IPortType__BehaviorDescriptor.characteristicColor_idmIQkxg4rmC.invoke(SLinkOperations.getTarget(((SNode) _variablesContext.getValue("parameterObject")), LINKS.type$5Gl6)), PortCategory__BehaviorDescriptor.shapeRenderer_idmIQkxgiY42.invoke(SLinkOperations.getTarget(((SNode) _variablesContext.getValue("parameterObject")), LINKS.category$WD4l))));
        editorCell.value.setDefaultWidth(20);
        editorCell.value.setDefaultHeight(20);
        editorCell.value.setCellId("Shape_3b3739_b0d0a0b1a");
        Style style = new StyleImpl();
        style.set(StyleAttributes.HORIZONTAL_ALIGN, CellAlign.RIGHT);
        editorCell.value.getStyle().putAll(style);
      });
      return editorCell.value;
    }
    private EditorCell createShape_5() {
      return createShape_4(getEditorContext(), myNode);
    }
    private EditorCell createCollection_11() {
      EditorCell_Collection editorCell = new EditorCell_Collection(getEditorContext(), myNode, new CellLayout_Indent());
      editorCell.setCellId("Collection_3b3739_e0a0b1a");
      editorCell.addEditorCell(createCollection_12());
      return editorCell;
    }
    private EditorCell createCollection_12() {
      EditorCell_Collection editorCell = new EditorCell_Collection(getEditorContext(), myNode, new CellLayout_Vertical());
      editorCell.setCellId("Collection_3b3739_a4a0a1b0");
      Style style = new StyleImpl();
      style.set(StyleAttributes.SELECTABLE, false);
      editorCell.getStyle().putAll(style);
      editorCell.addEditorCell(createShape_7());
      editorCell.addEditorCell(createCollection_13());
      return editorCell;
    }
    private EditorCell createShape_6(final EditorContext editorContext, final SNode node) {
      final Wrappers._T<ShapeEditorCell> editorCell = new Wrappers._T<ShapeEditorCell>();
      ContextVariables.withValue("thisNode", node, () -> {
        final ContextVariables _variablesContext = ContextVariables.getCurrent();
        editorCell.value = new ShapeEditorCell(editorContext, node, new PortShape((boolean) Port__BehaviorDescriptor.isOptional_idmIQkxf$r$2.invoke(((SNode) _variablesContext.getValue("parameterObject"))), IPortType__BehaviorDescriptor.characteristicColor_idmIQkxg4rmC.invoke(SLinkOperations.getTarget(((SNode) _variablesContext.getValue("parameterObject")), LINKS.type$5Gl6)), PortCategory__BehaviorDescriptor.shapeRenderer_idmIQkxgiY42.invoke(SLinkOperations.getTarget(((SNode) _variablesContext.getValue("parameterObject")), LINKS.category$WD4l))));
        editorCell.value.setDefaultWidth(20);
        editorCell.value.setDefaultHeight(20);
        editorCell.value.setCellId("Shape_3b3739_a0e0a0b1a");
        Style style = new StyleImpl();
        style.set(StyleAttributes.HORIZONTAL_ALIGN, CellAlign.RIGHT);
        editorCell.value.getStyle().putAll(style);
      });
      return editorCell.value;
    }
    private EditorCell createShape_7() {
      return createShape_6(getEditorContext(), myNode);
    }
    private EditorCell createCollection_13() {
      EditorCell_Collection editorCell = new EditorCell_Collection(getEditorContext(), myNode, new CellLayout_Indent());
      editorCell.setCellId("Collection_3b3739_b0e0a0b1a");
      editorCell.addEditorCell(createProperty_3());
      return editorCell;
    }
    private EditorCell createProperty_3() {
      getCellFactory().pushCellContext();
      try {
        final SProperty property = PROPS.name$MnvL;
        getCellFactory().setPropertyInfo(new SPropertyInfo(myNode, property));
        EditorCell_Property editorCell = EditorCell_Property.create(getEditorContext(), new SPropertyAccessor(myNode, property, false, false), myNode);
        editorCell.setDefaultText("<no name>");
        editorCell.setCellId("property_name3");
        Style style = new StyleImpl();
        style.set(StyleAttributes.FONT_STYLE, MPSFonts.BOLD);
        editorCell.getStyle().putAll(style);
        editorCell.setSubstituteInfo(new SPropertySubstituteInfo(editorCell, property));
        setCellContext(editorCell);
        Iterable<SNode> propertyAttributes = SNodeOperations.ofConcept(new IAttributeDescriptor.AllAttributes().list(myNode), CONCEPTS.PropertyAttribute$Gb);
        Iterable<SNode> currentPropertyAttributes = Sequence.fromIterable(propertyAttributes).where((it) -> Objects.equals(PropertyAttribute__BehaviorDescriptor.getProperty_id1avfQ4BBzOo.invoke(it), property));
        if (Sequence.fromIterable(currentPropertyAttributes).isNotEmpty()) {
          EditorManager manager = EditorManager.getInstanceFromContext(getEditorContext());
          return manager.createNodeRoleAttributeCell(Sequence.fromIterable(currentPropertyAttributes).first(), AttributeKind.PROPERTY, editorCell);
        } else
        return editorCell;
      } finally {
        getCellFactory().popCellContext();
      }
    }
  }
  private static SNode createPort_3b3739_a0b0c0d0h0a0b0(SNode p0, SNode p1) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.Port$gs);
    n0.forChild(LINKS.type$5Gl6).initNode(p0, CONCEPTS.IPortType$DL, true);
    n0.forChild(LINKS.category$WD4l).initNode(p1, CONCEPTS.PortCategory$Wm, true);
    return n0.getResult();
  }
  private static SNode createPort_3b3739_a0b0b0a2a3a7a0a1a(SNode p0, SNode p1) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.Port$gs);
    n0.forChild(LINKS.type$5Gl6).initNode(p0, CONCEPTS.IPortType$DL, true);
    n0.forChild(LINKS.category$WD4l).initNode(p1, CONCEPTS.PortCategory$Wm, true);
    return n0.getResult();
  }
  private static SNode createAssemblyConnector_3b3739_a0a0f0d0h0a0b0(SNode p0, SNode p1, SNode p2, SNode p3, SNode p4) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.AssemblyConnector$qU);
    n0.forChild(LINKS.connectorType$8zQx).initNode(p0, CONCEPTS.IConnectorType$F7, true);
    {
      SNodeBuilder n1 = n0.forChild(LINKS.sourceInstance$LjmV).init(CONCEPTS.InstanceRef$Gm);
      n1.setReferenceTarget(LINKS.ref$H$FL, p1);
    }
    n0.setReferenceTarget(LINKS.sourcePort$ZLvQ, p2);
    {
      SNodeBuilder n2 = n0.forChild(LINKS.targetInstance$RipR).init(CONCEPTS.InstanceRef$Gm);
      n2.setReferenceTarget(LINKS.ref$H$FL, p3);
    }
    n0.setReferenceTarget(LINKS.targetPort$ZZ$M, p4);
    return n0.getResult();
  }
  private static SNode createAssemblyConnector_3b3739_a0a0a5a3a7a0a1a(SNode p0, SNode p1, SNode p2, SNode p3, SNode p4) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.AssemblyConnector$qU);
    n0.forChild(LINKS.connectorType$8zQx).initNode(p0, CONCEPTS.IConnectorType$F7, true);
    {
      SNodeBuilder n1 = n0.forChild(LINKS.sourceInstance$LjmV).init(CONCEPTS.InstanceRef$Gm);
      n1.setReferenceTarget(LINKS.ref$H$FL, p1);
    }
    n0.setReferenceTarget(LINKS.sourcePort$ZLvQ, p2);
    {
      SNodeBuilder n2 = n0.forChild(LINKS.targetInstance$RipR).init(CONCEPTS.InstanceRef$Gm);
      n2.setReferenceTarget(LINKS.ref$H$FL, p3);
    }
    n0.setReferenceTarget(LINKS.targetPort$ZZ$M, p4);
    return n0.getResult();
  }
  private static SNode createComponentInstance_3b3739_a0c0d0a0a0a0a1a0b0(SNode p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.ComponentInstance$7c);
    {
      SNodeBuilder n1 = n0.forChild(LINKS.component$xlLY).init(CONCEPTS.ComponentRef$BR);
      n1.setReferenceTarget(LINKS.ref$KPLr, p0);
    }
    return n0.getResult();
  }
  private static SNode createComponentInstance_3b3739_a0g0d0a0a0a1b0(SNode p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.ComponentInstance$7c);
    {
      SNodeBuilder n1 = n0.forChild(LINKS.component$xlLY).init(CONCEPTS.ComponentRef$BR);
      n1.setReferenceTarget(LINKS.ref$KPLr, p0);
    }
    return n0.getResult();
  }
  private static boolean isEmptyString(String str) {
    return str == null || str.isEmpty();
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink contents$7e9r = MetaAdapterFactory.getContainmentLink(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x71280102b4ce9cdL, 0x71280102b4ce9ceL, "contents");
    /*package*/ static final SReferenceLink outerPort$ffZi = MetaAdapterFactory.getReferenceLink(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x32f64a31a0a561cL, 0x32f64a31a0a561fL, "outerPort");
    /*package*/ static final SReferenceLink outerPort$3H4p = MetaAdapterFactory.getReferenceLink(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x32f64a31a05d2c1L, 0x32f64a31a05d2cbL, "outerPort");
    /*package*/ static final SContainmentLink category$WD4l = MetaAdapterFactory.getContainmentLink(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x6c4f9fd23e51937cL, 0x5aed9484f65f1e5L, "category");
    /*package*/ static final SContainmentLink type$5Gl6 = MetaAdapterFactory.getContainmentLink(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x6c4f9fd23e51937cL, 0x6c4f9fd23e566372L, "type");
    /*package*/ static final SContainmentLink component$xlLY = MetaAdapterFactory.getContainmentLink(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x2fa41bd61d1549deL, 0x2fa41bd61d154b21L, "component");
    /*package*/ static final SReferenceLink ref$KPLr = MetaAdapterFactory.getReferenceLink(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x6c4f9fd23e4b67eeL, 0x6c4f9fd23e4b67efL, "ref");
    /*package*/ static final SContainmentLink connectorType$8zQx = MetaAdapterFactory.getContainmentLink(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x3a8867c74e876c3fL, 0x3a8867c74e88330cL, "connectorType");
    /*package*/ static final SContainmentLink sourceInstance$LjmV = MetaAdapterFactory.getContainmentLink(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x7fdf70a1447d7f1aL, 0x7fdf70a1447e06a1L, "sourceInstance");
    /*package*/ static final SReferenceLink ref$H$FL = MetaAdapterFactory.getReferenceLink(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x7fdf70a1447d7f29L, 0x7fdf70a1447d7f36L, "ref");
    /*package*/ static final SReferenceLink sourcePort$ZLvQ = MetaAdapterFactory.getReferenceLink(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x7fdf70a1447d7f1aL, 0x32f64a31a05d502L, "sourcePort");
    /*package*/ static final SContainmentLink targetInstance$RipR = MetaAdapterFactory.getContainmentLink(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x7fdf70a1447d7f1aL, 0x7fdf70a1447f1d65L, "targetInstance");
    /*package*/ static final SReferenceLink targetPort$ZZ$M = MetaAdapterFactory.getReferenceLink(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x7fdf70a1447d7f1aL, 0x32f64a31a05d514L, "targetPort");
  }

  private static final class CONCEPTS {
    /*package*/ static final SInterfaceConcept IEmpty$6_ = MetaAdapterFactory.getInterfaceConcept(0xd4280a54f6df4383L, 0xaa41d1b2bffa7eb1L, 0xe900768cf47dcc3L, "com.mbeddr.core.base.structure.IEmpty");
    /*package*/ static final SConcept ExportConnector$hw = MetaAdapterFactory.getConcept(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x32f64a31a0a561cL, "org.iets3.components.core.structure.ExportConnector");
    /*package*/ static final SConcept ImportConnector$8o = MetaAdapterFactory.getConcept(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x32f64a31a05d2c1L, "org.iets3.components.core.structure.ImportConnector");
    /*package*/ static final SConcept Component$gR = MetaAdapterFactory.getConcept(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x6c4f9fd23e484601L, "org.iets3.components.core.structure.Component");
    /*package*/ static final SConcept Port$gs = MetaAdapterFactory.getConcept(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x6c4f9fd23e51937cL, "org.iets3.components.core.structure.Port");
    /*package*/ static final SConcept AbstractComponentInstanceBase$QW = MetaAdapterFactory.getConcept(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x71edfb21ed616471L, "org.iets3.components.core.structure.AbstractComponentInstanceBase");
    /*package*/ static final SConcept ComponentSubstructure$oB = MetaAdapterFactory.getConcept(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x71280102b4ce9cdL, "org.iets3.components.core.structure.ComponentSubstructure");
    /*package*/ static final SConcept AssemblyConnector$qU = MetaAdapterFactory.getConcept(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x7fdf70a1447d7f1aL, "org.iets3.components.core.structure.AssemblyConnector");
    /*package*/ static final SInterfaceConcept IVisibleElementProvider$$O = MetaAdapterFactory.getInterfaceConcept(0xd4280a54f6df4383L, 0xaa41d1b2bffa7eb1L, 0x6315bcc6eff580a3L, "com.mbeddr.core.base.structure.IVisibleElementProvider");
    /*package*/ static final SConcept ComponentInstance$7c = MetaAdapterFactory.getConcept(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x6c4f9fd23e558729L, "org.iets3.components.core.structure.ComponentInstance");
    /*package*/ static final SConcept Chunk$sT = MetaAdapterFactory.getConcept(0xd4280a54f6df4383L, 0xaa41d1b2bffa7eb1L, 0x6315bcc6effb4ea6L, "com.mbeddr.core.base.structure.Chunk");
    /*package*/ static final SConcept PropertyAttribute$Gb = MetaAdapterFactory.getConcept(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x2eb1ad060897da56L, "jetbrains.mps.lang.core.structure.PropertyAttribute");
    /*package*/ static final SInterfaceConcept IPortType$DL = MetaAdapterFactory.getInterfaceConcept(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x6c4f9fd23e566371L, "org.iets3.components.core.structure.IPortType");
    /*package*/ static final SConcept PortCategory$Wm = MetaAdapterFactory.getConcept(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x71280102d0186c2L, "org.iets3.components.core.structure.PortCategory");
    /*package*/ static final SInterfaceConcept IConnectorType$F7 = MetaAdapterFactory.getInterfaceConcept(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x4c293bba48709df1L, "org.iets3.components.core.structure.IConnectorType");
    /*package*/ static final SConcept InstanceRef$Gm = MetaAdapterFactory.getConcept(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x7fdf70a1447d7f29L, "org.iets3.components.core.structure.InstanceRef");
    /*package*/ static final SConcept ComponentRef$BR = MetaAdapterFactory.getConcept(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x6c4f9fd23e4b67eeL, "org.iets3.components.core.structure.ComponentRef");
  }

  private static final class PROPS {
    /*package*/ static final SProperty name$MnvL = MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name");
  }
}
