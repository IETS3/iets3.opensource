package org.iets3.components.core.behavior;

/*Generated by MPS */

import jetbrains.mps.core.aspects.behaviour.BaseBHDescriptor;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import jetbrains.mps.core.aspects.behaviour.api.SMethod;
import jetbrains.mps.core.aspects.behaviour.SMethodBuilder;
import jetbrains.mps.core.aspects.behaviour.SJavaCompoundTypeImpl;
import jetbrains.mps.core.aspects.behaviour.AccessPrivileges;
import org.jetbrains.mps.openapi.model.SNode;
import java.util.List;
import java.util.Arrays;
import org.jetbrains.annotations.NotNull;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import java.util.Objects;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.baseLanguage.tuples.runtime.Tuples;
import jetbrains.mps.core.aspects.behaviour.api.SConstructor;
import org.jetbrains.annotations.Nullable;
import jetbrains.mps.core.aspects.behaviour.api.BHMethodNotFoundException;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import org.jetbrains.mps.openapi.language.SConcept;

public final class Port__BehaviorDescriptor extends BaseBHDescriptor {
  private static final SAbstractConcept CONCEPT = MetaAdapterFactory.getConcept(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x6c4f9fd23e51937cL, "org.iets3.components.core.structure.Port");

  public static final SMethod<String> getAutomaticName_idcJpacq408C = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("getAutomaticName").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(229512757698888232L).languageId(0xbd9c05c0f8725a35L, 0x7b68d745a7b848b9L).build2();
  public static final SMethod<Boolean> isOptional_idmIQkxf$r$2 = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.TYPE)).name("isOptional").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(409503520733116674L).languageId(0xb6713d118449c6e7L, 0xf0fd486f857743e9L).build2();
  public static final SMethod<Boolean> isUnlimitedMulti_id7Atos1y4IiF = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.TYPE)).name("isUnlimitedMulti").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(8763267928839873707L).languageId(0xb6713d118449c6e7L, 0xf0fd486f857743e9L).build2();
  public static final SMethod<String> getConnectionMulitplicityError_id7Atos1y63VI = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("getConnectionMulitplicityError").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(8763267928840224494L).languageId(0xb6713d118449c6e7L, 0xf0fd486f857743e9L).build2(SMethodBuilder.createJavaParameter((Class<SNode>) ((Class) Object.class), ""), SMethodBuilder.createJavaParameter((Class<Iterable<SNode>>) ((Class) Object.class), ""));
  public static final SMethod<Iterable<SNode>> filterOwnConnections_id5RkEkmFo09K = new SMethodBuilder<Iterable<SNode>>(new SJavaCompoundTypeImpl((Class<Iterable<SNode>>) ((Class) Object.class))).name("filterOwnConnections").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6761215057282990704L).languageId(0xb6713d118449c6e7L, 0xf0fd486f857743e9L).build2(SMethodBuilder.createJavaParameter((Class<SNode>) ((Class) Object.class), ""), SMethodBuilder.createJavaParameter((Class<Iterable<SNode>>) ((Class) Object.class), ""));
  public static final SMethod<SNode> getTypedContextNode_id4fgA7QrKR89 = new SMethodBuilder<SNode>(new SJavaCompoundTypeImpl((Class<SNode>) ((Class) Object.class))).name("nodeToCalculateTypeFrom").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(4886573260948599305L).languageId(0xb66a309a6e1a7290L, 0xcfaa4966b7d54b69L).build2();

  private static final List<SMethod<?>> BH_METHODS = Arrays.<SMethod<?>>asList(getAutomaticName_idcJpacq408C, isOptional_idmIQkxf$r$2, isUnlimitedMulti_id7Atos1y4IiF, getConnectionMulitplicityError_id7Atos1y63VI, filterOwnConnections_id5RkEkmFo09K, getTypedContextNode_id4fgA7QrKR89);

  private static void ___init___(@NotNull SNode __thisNode__) {
  }

  /*package*/ static String getAutomaticName_idcJpacq408C(@NotNull final SNode __thisNode__) {
    final String defaultPortName = IPortType__BehaviorDescriptor.defaultPortName_idcJpacq4Df4.invoke(SLinkOperations.getTarget(__thisNode__, LINKS.type$5Gl6));
    List<SNode> similarPorts = Sequence.fromIterable(SNodeOperations.ofConcept(SNodeOperations.getAllSiblings(__thisNode__, true), CONCEPTS.Port$gs)).where((it) -> {
      String itPortName = IPortType__BehaviorDescriptor.defaultPortName_idcJpacq4Df4.invoke(SLinkOperations.getTarget(it, LINKS.type$5Gl6));
      return (itPortName != null && itPortName.length() > 0) && itPortName.equals(defaultPortName) && Objects.equals(SNodeOperations.getConcept(SLinkOperations.getTarget(it, LINKS.category$WD4l)), SNodeOperations.getConcept(SLinkOperations.getTarget(__thisNode__, LINKS.category$WD4l)));
    }).toList();

    String autoIndexSuffix = (((ListSequence.fromList(similarPorts).count() > 1) ? ("_" + ListSequence.fromList(similarPorts).indexOf(__thisNode__)) : ""));

    String name = defaultPortName;
    if (isNotEmptyString(PortCategory__BehaviorDescriptor.portNameSuffix_id3v9srRUC3fV.invoke(SLinkOperations.getTarget(__thisNode__, LINKS.category$WD4l)))) {
      name += "_" + PortCategory__BehaviorDescriptor.portNameSuffix_id3v9srRUC3fV.invoke(SLinkOperations.getTarget(__thisNode__, LINKS.category$WD4l));
    }
    name += autoIndexSuffix;
    return name;
  }
  /*package*/ static boolean isOptional_idmIQkxf$r$2(@NotNull SNode __thisNode__) {
    return (int) PortCategory__BehaviorDescriptor.multiplicity_id7Atos1y391f.invoke(SLinkOperations.getTarget(__thisNode__, LINKS.category$WD4l))._0() == 0;
  }
  /*package*/ static boolean isUnlimitedMulti_id7Atos1y4IiF(@NotNull SNode __thisNode__) {
    return (int) PortCategory__BehaviorDescriptor.multiplicity_id7Atos1y391f.invoke(SLinkOperations.getTarget(__thisNode__, LINKS.category$WD4l))._1() == -1;
  }
  /*package*/ static String getConnectionMulitplicityError_id7Atos1y63VI(@NotNull SNode __thisNode__, SNode instance, Iterable<SNode> allConnectors) {
    Iterable<SNode> connectedToMe = Port__BehaviorDescriptor.filterOwnConnections_id5RkEkmFo09K.invoke(__thisNode__, instance, allConnectors);
    int count = Sequence.fromIterable(connectedToMe).count();
    Tuples._2<Integer, Integer> mult = PortCategory__BehaviorDescriptor.multiplicity_id7Atos1y391f.invoke(SLinkOperations.getTarget(__thisNode__, LINKS.category$WD4l));
    if (count < (int) mult._0()) {
      return Messages.TOO_FEW_CONNECTORS + "; " + (int) mult._0() + " required.";
    }
    if ((int) mult._1() > 0 && count > (int) mult._1()) {
      return Messages.TOO_MANY_CONNECTORS + "; " + (int) mult._1() + " allowed.";
    }
    return null;
  }
  /*package*/ static Iterable<SNode> filterOwnConnections_id5RkEkmFo09K(@NotNull final SNode __thisNode__, final SNode instance, Iterable<SNode> allConnectors) {
    return Sequence.fromIterable(allConnectors).where((it) -> {
      Tuples._2<SNode, SNode> ports = AbstractPortToPortConnector__BehaviorDescriptor.getPorts_idmIQkxg5ZT6.invoke(it);
      return ((ports._0() == __thisNode__) && (AbstractPortToPortConnector__BehaviorDescriptor.getInstanceForPort_id4VHfdEqkeO4.invoke(it, ports._0()) == instance)) || ((ports._1() == __thisNode__) && (AbstractPortToPortConnector__BehaviorDescriptor.getInstanceForPort_id4VHfdEqkeO4.invoke(it, ports._1()) == instance));
    });
  }
  /*package*/ static SNode getTypedContextNode_id4fgA7QrKR89(@NotNull SNode __thisNode__) {
    return __thisNode__;
  }

  /*package*/ Port__BehaviorDescriptor() {
  }

  @Override
  protected void initNode(@NotNull SNode node, @NotNull SConstructor constructor, @Nullable Object[] parameters) {
    ___init___(node);
  }

  @Override
  protected <T> T invokeSpecial0(@NotNull SNode node, @NotNull SMethod<T> method, @Nullable Object[] parameters) {
    int methodIndex = BH_METHODS.indexOf(method);
    if (methodIndex < 0) {
      throw new BHMethodNotFoundException(this, method);
    }
    switch (methodIndex) {
      case 0:
        return (T) ((String) getAutomaticName_idcJpacq408C(node));
      case 1:
        return (T) ((Boolean) isOptional_idmIQkxf$r$2(node));
      case 2:
        return (T) ((Boolean) isUnlimitedMulti_id7Atos1y4IiF(node));
      case 3:
        return (T) ((String) getConnectionMulitplicityError_id7Atos1y63VI(node, (SNode) parameters[0], (Iterable<SNode>) parameters[1]));
      case 4:
        return (T) ((Iterable<SNode>) filterOwnConnections_id5RkEkmFo09K(node, (SNode) parameters[0], (Iterable<SNode>) parameters[1]));
      case 5:
        return (T) ((SNode) getTypedContextNode_id4fgA7QrKR89(node));
      default:
        throw new BHMethodNotFoundException(this, method);
    }
  }

  @Override
  protected <T> T invokeSpecial0(@NotNull SAbstractConcept concept, @NotNull SMethod<T> method, @Nullable Object[] parameters) {
    int methodIndex = BH_METHODS.indexOf(method);
    if (methodIndex < 0) {
      throw new BHMethodNotFoundException(this, method);
    }
    switch (methodIndex) {
      default:
        throw new BHMethodNotFoundException(this, method);
    }
  }

  @NotNull
  @Override
  public List<SMethod<?>> getDeclaredMethods() {
    return BH_METHODS;
  }

  @NotNull
  @Override
  public SAbstractConcept getConcept() {
    return CONCEPT;
  }
  private static boolean isNotEmptyString(String str) {
    return str != null && str.length() > 0;
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink type$5Gl6 = MetaAdapterFactory.getContainmentLink(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x6c4f9fd23e51937cL, 0x6c4f9fd23e566372L, "type");
    /*package*/ static final SContainmentLink category$WD4l = MetaAdapterFactory.getContainmentLink(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x6c4f9fd23e51937cL, 0x5aed9484f65f1e5L, "category");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept Port$gs = MetaAdapterFactory.getConcept(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x6c4f9fd23e51937cL, "org.iets3.components.core.structure.Port");
  }
}
