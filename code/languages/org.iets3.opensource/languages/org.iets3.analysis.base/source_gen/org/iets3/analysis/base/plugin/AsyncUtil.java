package org.iets3.analysis.base.plugin;

/*Generated by MPS */

import java.util.concurrent.Callable;
import org.jetbrains.mps.openapi.module.SRepository;
import jetbrains.mps.baseLanguage.closures.runtime.Wrappers;

public class AsyncUtil {

  public static <Y> Y callWithWriteAction(final Callable<Y> executionCode, final SRepository repository) {
    final Wrappers._T<Y> runWithin = new Wrappers._T<Y>();
    repository.getModelAccess().runWriteAction(() -> {
      try {
        runWithin.value = executionCode.call();
      } catch (Exception e) {
        throw new RuntimeException(e);
      }
    });
    return runWithin.value;
  }

  public static <Y> Y callWithReadAction(final Callable<Y> executionCode, final SRepository repository) {
    final Wrappers._T<Y> runWithin = new Wrappers._T<Y>();

    repository.getModelAccess().runReadAction(() -> {
      try {
        runWithin.value = executionCode.call();
      } catch (Exception e) {
        throw new RuntimeException(e);
      }
    });
    return runWithin.value;
  }

}
