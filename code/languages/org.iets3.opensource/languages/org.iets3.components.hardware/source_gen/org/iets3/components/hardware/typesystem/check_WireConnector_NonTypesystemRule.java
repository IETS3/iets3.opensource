package org.iets3.components.hardware.typesystem;

/*Generated by MPS */

import jetbrains.mps.lang.typesystem.runtime.AbstractNonTypesystemRule_Runtime;
import jetbrains.mps.lang.typesystem.runtime.NonTypesystemRule_Runtime;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.typesystem.inference.TypeCheckingContext;
import jetbrains.mps.lang.typesystem.runtime.IsApplicableStatus;
import org.iets3.components.hardware.behavior.WireTarget__BehaviorDescriptor;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import java.util.Objects;
import jetbrains.mps.errors.messageTargets.MessageTarget;
import jetbrains.mps.errors.messageTargets.NodeMessageTarget;
import jetbrains.mps.errors.IErrorReporter;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SReferenceLink;
import org.jetbrains.mps.openapi.language.SConcept;

public class check_WireConnector_NonTypesystemRule extends AbstractNonTypesystemRule_Runtime implements NonTypesystemRule_Runtime {
  public check_WireConnector_NonTypesystemRule() {
  }
  public void applyRule(final SNode wireConnector, final TypeCheckingContext typeCheckingContext, IsApplicableStatus status) {
    SNode busType = WireTarget__BehaviorDescriptor.connectedBusType_id4lFnCmbEK5U.invoke(SLinkOperations.getTarget(wireConnector, LINKS.wireTarget$WCE5));
    SNode sourcePortType = SLinkOperations.getTarget(SLinkOperations.getTarget(wireConnector, LINKS.sourcePort$mT3n), LINKS.type$5Gl6);
    if ((busType != null) && (sourcePortType != null)) {
      if (SNodeOperations.isInstanceOf(sourcePortType, CONCEPTS.BusPortType$60)) {
        if (!(Objects.equals(SNodeOperations.getConcept(SLinkOperations.getTarget(SNodeOperations.cast(sourcePortType, CONCEPTS.BusPortType$60), LINKS.busType$HmsX)), SNodeOperations.getConcept(busType)))) {
          {
            final MessageTarget errorTarget = new NodeMessageTarget();
            IErrorReporter _reporter_2309309498 = typeCheckingContext.reportTypeError(wireConnector, "Port of type " + SNodeOperations.present(sourcePortType) + " does not matches bus kind " + busType, "r:2e73c92d-b9d8-45c3-9223-4903d8d52eeb(org.iets3.components.hardware.typesystem)", "3445907953730016751", null, errorTarget);
          }
        }
      }
    }
  }
  public SAbstractConcept getApplicableConcept() {
    return CONCEPTS.WireConnector$hh;
  }
  public IsApplicableStatus isApplicableAndPattern(SNode argument) {
    return new IsApplicableStatus(argument.getConcept().isSubConceptOf(getApplicableConcept()), null);
  }
  public boolean overrides() {
    return false;
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink wireTarget$WCE5 = MetaAdapterFactory.getContainmentLink(0xc35abfa80db04d42L, 0xbb3ff46112aeb888L, 0x2fd25306d6b99d15L, 0x443d0f2f0f405a2dL, "wireTarget");
    /*package*/ static final SReferenceLink sourcePort$mT3n = MetaAdapterFactory.getReferenceLink(0xc35abfa80db04d42L, 0xbb3ff46112aeb888L, 0x2fd25306d6b99d15L, 0x2fd25306d6b99e00L, "sourcePort");
    /*package*/ static final SContainmentLink type$5Gl6 = MetaAdapterFactory.getContainmentLink(0xf0fd486f857743e9L, 0xb6713d118449c6e7L, 0x6c4f9fd23e51937cL, 0x6c4f9fd23e566372L, "type");
    /*package*/ static final SContainmentLink busType$HmsX = MetaAdapterFactory.getContainmentLink(0xc35abfa80db04d42L, 0xbb3ff46112aeb888L, 0x74c0c1babfb4a1aL, 0x456b5e858baa35a7L, "busType");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept BusPortType$60 = MetaAdapterFactory.getConcept(0xc35abfa80db04d42L, 0xbb3ff46112aeb888L, 0x74c0c1babfb4a1aL, "org.iets3.components.hardware.structure.BusPortType");
    /*package*/ static final SConcept WireConnector$hh = MetaAdapterFactory.getConcept(0xc35abfa80db04d42L, 0xbb3ff46112aeb888L, 0x2fd25306d6b99d15L, "org.iets3.components.hardware.structure.WireConnector");
  }
}
