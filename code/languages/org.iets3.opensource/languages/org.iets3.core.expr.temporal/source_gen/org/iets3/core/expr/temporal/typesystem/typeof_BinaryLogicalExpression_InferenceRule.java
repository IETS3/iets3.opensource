package org.iets3.core.expr.temporal.typesystem;

/*Generated by MPS */

import jetbrains.mps.lang.typesystem.runtime.AbstractInferenceRule_Runtime;
import jetbrains.mps.lang.typesystem.runtime.InferenceRule_Runtime;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.lang.typesystem.runtime.IsApplicableStatus;
import jetbrains.mps.typesystem.inference.TypeCheckingContext;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import com.mbeddr.mpsutil.interpreter.behavior.IInterpreterWrapperType__BehaviorDescriptor;
import jetbrains.mps.errors.messageTargets.NodeMessageTarget;
import jetbrains.mps.typesystem.inference.EquationInfo;
import jetbrains.mps.errors.messageTargets.MessageTarget;
import jetbrains.mps.errors.IErrorReporter;
import org.iets3.core.base.behavior.ErrorCheckingUtil;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import jetbrains.mps.smodel.builder.SNodeBuilder;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SConcept;
import org.jetbrains.mps.openapi.language.SInterfaceConcept;

public class typeof_BinaryLogicalExpression_InferenceRule extends AbstractInferenceRule_Runtime implements InferenceRule_Runtime {
  public typeof_BinaryLogicalExpression_InferenceRule() {
  }
  public boolean overrides(final SNode binaryLogicalExpression, IsApplicableStatus status) {
    return true;
  }
  public void applyRule(final SNode binaryLogicalExpression, final TypeCheckingContext typeCheckingContext, IsApplicableStatus status) {
    {
      final SNode leftType = typeCheckingContext.typeOf(SLinkOperations.getTarget(binaryLogicalExpression, LINKS.left$zxUa), "r:782cab7d-c30f-4797-991c-cb17d0274086(org.iets3.core.expr.temporal.typesystem)", "7638810057883497001", true);
      typeCheckingContext.whenConcrete(leftType, () -> {
        {
          final SNode rightType = typeCheckingContext.typeOf(SLinkOperations.getTarget(binaryLogicalExpression, LINKS.right$zBjx), "r:782cab7d-c30f-4797-991c-cb17d0274086(org.iets3.core.expr.temporal.typesystem)", "7638810057883496997", true);
          typeCheckingContext.whenConcrete(rightType, () -> {
            SNode operationType;
            boolean wasOption = false;
            boolean wasTemporal = false;
            SNode lt = typeCheckingContext.getExpandedNode(leftType);
            SNode rt = typeCheckingContext.getExpandedNode(rightType);
            if (SNodeOperations.isInstanceOf(lt, CONCEPTS.TemporalType$oH)) {
              lt = SLinkOperations.getTarget(SNodeOperations.cast(lt, CONCEPTS.TemporalType$oH), LINKS.baseType$ZN4a);
              wasTemporal = true;
            }
            if (SNodeOperations.isInstanceOf(rt, CONCEPTS.TemporalType$oH)) {
              rt = SLinkOperations.getTarget(SNodeOperations.cast(rt, CONCEPTS.TemporalType$oH), LINKS.baseType$ZN4a);
              wasTemporal = true;
            }


            if (SNodeOperations.isInstanceOf(lt, CONCEPTS.IInterpreterWrapperType$KD)) {
              lt = IInterpreterWrapperType__BehaviorDescriptor.wrappedType_id6bG6MAFRDvi.invoke(SNodeOperations.cast(lt, CONCEPTS.IInterpreterWrapperType$KD));
              wasOption = true;
            }
            if (SNodeOperations.isInstanceOf(rt, CONCEPTS.IInterpreterWrapperType$KD)) {
              rt = IInterpreterWrapperType__BehaviorDescriptor.wrappedType_id6bG6MAFRDvi.invoke(SNodeOperations.cast(rt, CONCEPTS.IInterpreterWrapperType$KD));
              wasOption = true;
            }

            operationType = typeCheckingContext.getOverloadedOperationType(binaryLogicalExpression, lt, rt, (modelId, ruleId) -> typeCheckingContext.reportWarning(binaryLogicalExpression, "conflicting rules for overloaded operation type", modelId, ruleId, null, new NodeMessageTarget()));
            if (operationType != null) {
              if (wasOption) {
                {
                  SNode _nodeToCheck_1029348928467 = binaryLogicalExpression;
                  EquationInfo _info_12389875345 = new EquationInfo(_nodeToCheck_1029348928467, null, "r:782cab7d-c30f-4797-991c-cb17d0274086(org.iets3.core.expr.temporal.typesystem)", "7638810057883496958", 0, null);
                  typeCheckingContext.createEquation((SNode) typeCheckingContext.typeOf(_nodeToCheck_1029348928467, "r:782cab7d-c30f-4797-991c-cb17d0274086(org.iets3.core.expr.temporal.typesystem)", "7638810057883496968", true), (SNode) createOptionType_euyag4_a1a0c0a0a0n0b0a1a0a1a0b0a0c(SNodeOperations.cast(operationType, CONCEPTS.Type$WK)), _info_12389875345);
                }
              } else if (wasTemporal) {
                {
                  SNode _nodeToCheck_1029348928467 = binaryLogicalExpression;
                  EquationInfo _info_12389875345 = new EquationInfo(_nodeToCheck_1029348928467, null, "r:782cab7d-c30f-4797-991c-cb17d0274086(org.iets3.core.expr.temporal.typesystem)", "7638810057883496982", 0, null);
                  typeCheckingContext.createEquation((SNode) typeCheckingContext.typeOf(_nodeToCheck_1029348928467, "r:782cab7d-c30f-4797-991c-cb17d0274086(org.iets3.core.expr.temporal.typesystem)", "7638810057883496992", true), (SNode) createTemporalType_euyag4_a1a0c0a0a0a31a1a0b0a0b0a1a0a2(SNodeOperations.cast(operationType, CONCEPTS.Type$WK)), _info_12389875345);
                }
              } else {
                {
                  SNode _nodeToCheck_1029348928467 = binaryLogicalExpression;
                  EquationInfo _info_12389875345 = new EquationInfo(_nodeToCheck_1029348928467, null, "r:782cab7d-c30f-4797-991c-cb17d0274086(org.iets3.core.expr.temporal.typesystem)", "7638810057883496973", 0, null);
                  typeCheckingContext.createEquation((SNode) typeCheckingContext.typeOf(_nodeToCheck_1029348928467, "r:782cab7d-c30f-4797-991c-cb17d0274086(org.iets3.core.expr.temporal.typesystem)", "7638810057883496977", true), (SNode) operationType, _info_12389875345);
                }
              }
            } else {
              {
                final MessageTarget errorTarget = new NodeMessageTarget();
                IErrorReporter _reporter_2309309498 = typeCheckingContext.reportTypeError(binaryLogicalExpression, ErrorCheckingUtil.cannotBeAppliedToTypesMessage(SConceptOperations.conceptAlias(SNodeOperations.getConcept(binaryLogicalExpression)), typeCheckingContext.getExpandedNode(leftType), typeCheckingContext.getExpandedNode(rightType)), "r:782cab7d-c30f-4797-991c-cb17d0274086(org.iets3.core.expr.temporal.typesystem)", "7638810057883496939", null, errorTarget);
              }
              {
                SNode _nodeToCheck_1029348928467 = binaryLogicalExpression;
                EquationInfo _info_12389875345 = new EquationInfo(_nodeToCheck_1029348928467, null, "r:782cab7d-c30f-4797-991c-cb17d0274086(org.iets3.core.expr.temporal.typesystem)", "7638810057883496948", 0, null);
                typeCheckingContext.createEquation((SNode) typeCheckingContext.typeOf(_nodeToCheck_1029348928467, "r:782cab7d-c30f-4797-991c-cb17d0274086(org.iets3.core.expr.temporal.typesystem)", "7638810057883496953", true), (SNode) createRuntimeErrorType_euyag4_a1a0c0b0a31a1a0b0a0b0a1a0a2(), _info_12389875345);
              }
            }
          }, "r:782cab7d-c30f-4797-991c-cb17d0274086(org.iets3.core.expr.temporal.typesystem)", "7638810057883496831", false, false);
        }
      }, "r:782cab7d-c30f-4797-991c-cb17d0274086(org.iets3.core.expr.temporal.typesystem)", "7638810057883496827", false, false);
    }
  }
  public SAbstractConcept getApplicableConcept() {
    return CONCEPTS.BinaryLogicalExpression$W5;
  }
  public IsApplicableStatus isApplicableAndPattern(SNode argument) {
    return new IsApplicableStatus(argument.getConcept().isSubConceptOf(getApplicableConcept()), null);
  }
  private static SNode createRuntimeErrorType_euyag4_a1a0c0b0a31a1a0b0a0b0a1a0a2() {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.RuntimeErrorType$3c);
    return n0.getResult();
  }
  private static SNode createOptionType_euyag4_a1a0c0a0a0n0b0a1a0a1a0b0a0c(SNode p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.OptionType$eU);
    n0.forChild(LINKS.baseType$Cv_a).initNode(p0, CONCEPTS.Type$WK, true);
    return n0.getResult();
  }
  private static SNode createTemporalType_euyag4_a1a0c0a0a0a31a1a0b0a0b0a1a0a2(SNode p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.TemporalType$oH);
    n0.forChild(LINKS.baseType$ZN4a).initNode(p0, CONCEPTS.Type$WK, true);
    return n0.getResult();
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink left$zxUa = MetaAdapterFactory.getContainmentLink(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x46ff3b3d86c99c15L, 0x46ff3b3d86c99c16L, "left");
    /*package*/ static final SContainmentLink right$zBjx = MetaAdapterFactory.getContainmentLink(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x46ff3b3d86c99c15L, 0x46ff3b3d86c99c18L, "right");
    /*package*/ static final SContainmentLink baseType$ZN4a = MetaAdapterFactory.getContainmentLink(0x4621d3e3b8a34bbeL, 0xb7ac234b6e2d1d68L, 0x501c5b607b212209L, 0x501c5b607b21220aL, "baseType");
    /*package*/ static final SContainmentLink baseType$Cv_a = MetaAdapterFactory.getContainmentLink(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x26f4f2a81ca93310L, 0x26f4f2a81ca93311L, "baseType");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept TemporalType$oH = MetaAdapterFactory.getConcept(0x4621d3e3b8a34bbeL, 0xb7ac234b6e2d1d68L, 0x501c5b607b212209L, "org.iets3.core.expr.temporal.structure.TemporalType");
    /*package*/ static final SInterfaceConcept IInterpreterWrapperType$KD = MetaAdapterFactory.getInterfaceConcept(0x47f075a6558e4640L, 0xa6067ce0236c8023L, 0x62ec1b29abde62acL, "com.mbeddr.mpsutil.interpreter.structure.IInterpreterWrapperType");
    /*package*/ static final SConcept Type$WK = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x670d5e92f854a614L, "org.iets3.core.expr.base.structure.Type");
    /*package*/ static final SConcept BinaryLogicalExpression$W5 = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x46ff3b3d86cbdbe7L, "org.iets3.core.expr.base.structure.BinaryLogicalExpression");
    /*package*/ static final SConcept RuntimeErrorType$3c = MetaAdapterFactory.getConcept(0x7a5dda6291404668L, 0xab76d5ed1746f2b2L, 0x113f84956f9L, "jetbrains.mps.lang.typesystem.structure.RuntimeErrorType");
    /*package*/ static final SConcept OptionType$eU = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x26f4f2a81ca93310L, "org.iets3.core.expr.base.structure.OptionType");
  }
}
