package org.iets3.core.expr.math.plugin;

/*Generated by MPS */

import com.mbeddr.mpsutil.contextactions.runtime.AbstractContextActionsDescriptor;
import com.mbeddr.mpsutil.contextactions.runtime.IContextActionsDescriptor;
import java.util.List;
import com.mbeddr.mpsutil.contextactions.runtime.IContextActionSource;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import java.util.ArrayList;
import com.mbeddr.mpsutil.contextactions.runtime.WrapperActionSource;
import com.mbeddr.mpsutil.contextactions.runtime.SubstituteInfoActionSource;
import com.mbeddr.mpsutil.contextactions.runtime.ISubstituteAction;
import com.mbeddr.mpsutil.contextactions.runtime.IContext;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import com.mbeddr.mpsutil.contextactions.runtime.GenericActionSource;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import javax.swing.Icon;
import jetbrains.mps.ide.icons.GlobalIconManager;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.smodel.action.SNodeFactoryOperations;
import org.iets3.core.expr.base.behavior.IMainSlot__BehaviorDescriptor;
import com.mbeddr.mpsutil.contextactions.runtime.ContextActionId;
import com.mbeddr.mpsutil.contextactions.runtime.IContextAction;
import com.mbeddr.mpsutil.contextactions.runtime.GenericAction;
import org.jetbrains.mps.openapi.language.SConcept;
import org.jetbrains.mps.openapi.language.SInterfaceConcept;

public class ContextActionsDescriptor extends AbstractContextActionsDescriptor implements IContextActionsDescriptor {

  private static ContextActionsDescriptor INSTANCE = new ContextActionsDescriptor();

  @Override
  public List<IContextActionSource> getActionSources() {
    List<IContextActionSource> result = ListSequence.fromList(new ArrayList<IContextActionSource>());

    ListSequence.fromList(result).addElement(new WrapperActionSource(new SubstituteInfoActionSource() {
      @Override
      public String getFolder(ISubstituteAction action, IContext context) {
        return "Math Expressions";
      }
      @Override
      protected boolean includeAction(ISubstituteAction action, IContext context) {
        return check_gkynum_a0a1a0a0a0a0c0d(action.getOutputConceptLanguageName());
      }
    }) {
      @Override
      public boolean isApplicable(IContext context) {
        return SNodeOperations.isInstanceOf(context.getSNode(), CONCEPTS.Expression$D_) && (SNodeOperations.getConcept(context.getSNode()).isAbstract() || SNodeOperations.getConcept(context.getSNode()).getName().contains("EmptyExpression"));
      }
    });
    ListSequence.fromList(result).addElement(new WrapperActionSource(new GenericActionSource<SAbstractConcept>() {
      @Override
      public String getFolder(IContext context, SAbstractConcept parameterObject) {
        return "Math Expression (Wrap Selection)";
      }
      @Override
      public Icon getIcon(IContext context, SAbstractConcept parameterObject) {
        return GlobalIconManager.getInstance().getIconFor(parameterObject);
      }
      @Override
      public String getLabel(IContext context, SAbstractConcept parameterObject) {
        return SConceptOperations.conceptAlias(parameterObject);
      }
      @Override
      public Iterable<SAbstractConcept> queryParameterObjects(IContext context) {
        return Sequence.fromIterable(((Iterable<SAbstractConcept>) MetaAdapterFactory.getLanguage(0x6fadc44e69c24a4aL, 0x9d167ebf5f8d3ba0L, "org.iets3.core.expr.math").getConcepts())).where((it) -> SConceptOperations.isSubConceptOf(SNodeOperations.asSConcept(it), CONCEPTS.IMainSlot$uR) && !(it.isAbstract()));
      }
      @Override
      public void execute(IContext context, SAbstractConcept parameterObject) {
        SNode newExpr = SNodeFactoryOperations.createNewNode(parameterObject, null);
        SNode sNode = context.getSNode();
        SNodeOperations.replaceWithAnother(sNode, newExpr);
        IMainSlot__BehaviorDescriptor.addChildToMainSlot_id91pmpwTPqy.invoke(newExpr, sNode, "");
      }
      @Override
      protected ContextActionId getActionSourceId() {
        return new ContextActionId("1782300720840701202");
      }


      @Override
      protected IContextAction createAction(final SAbstractConcept parameterObject) {
        return new GenericAction(this, parameterObject) {

        };
      }
      @Override
      public String getOriginalActionSourceId() {
        return "";
      }
    }) {
      @Override
      public boolean isApplicable(IContext context) {
        return SNodeOperations.isInstanceOf(context.getSNode(), CONCEPTS.Expression$D_) && !(SNodeOperations.getConcept(context.getSNode()).isAbstract()) && !(SNodeOperations.getConcept(context.getSNode()).getName().contains("EmptyExpression"));
      }
    });

    return result;
  }

  @Override
  public boolean isApplicable(IContext context) {
    return true;
  }
  private static boolean check_gkynum_a0a1a0a0a0a0c0d(String checkedDotOperand) {
    if (null != checkedDotOperand) {
      return checkedDotOperand.contains("math");
    }
    return false;
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept Expression$D_ = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x670d5e92f854a047L, "org.iets3.core.expr.base.structure.Expression");
    /*package*/ static final SInterfaceConcept IMainSlot$uR = MetaAdapterFactory.getInterfaceConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x241656660e75685L, "org.iets3.core.expr.base.structure.IMainSlot");
  }
}
