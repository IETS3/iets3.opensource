package org.iets3.core.expr.datetime.runtime;

/*Generated by MPS */

import java.math.BigInteger;
import java.util.Objects;
import java.time.Period;
import java.time.LocalDate;

public class DateDeltaValue implements Comparable<DateDeltaValue> {

  private final BigInteger years;
  private final BigInteger months;
  private final BigInteger weeks;
  private final BigInteger days;

  public DateDeltaValue(BigInteger years, BigInteger months, BigInteger weeks, BigInteger days) {
    this.years = years;
    this.months = months;
    this.weeks = weeks;
    this.days = days;
  }

  @Override
  public int hashCode() {
    return Objects.hash(years, months, weeks, days);
  }

  @Override
  public boolean equals(Object object) {
    if (!(object instanceof DateDeltaValue)) {
      return false;
    }

    DateDeltaValue other = (DateDeltaValue) object;

    return other.years.equals(this.years) && other.months.equals(this.months) && other.weeks.equals(this.weeks) && other.days.equals(this.days);
  }

  @Override
  public String toString() {
    StringBuilder result = new StringBuilder();
    if (isNonZero(years)) {
      result.append(years).append(" years");
    }

    if (isNonZero(months)) {
      if (result.length() > 0) {
        result.append(" ");
      }
      result.append(months).append(" months");
    }

    if (isNonZero(weeks)) {
      if (result.length() > 0) {
        result.append(" ");
      }
      result.append(weeks).append(" weeks");
    }

    if (isNonZero(days)) {
      if (result.length() > 0) {
        result.append(" ");
      }
      result.append(days).append(" days");
    }

    if (result.length() == 0) {
      // Zero period
      result.append("0");
    }

    return result.toString();
  }

  private static boolean isZero(BigInteger n) {
    return n.equals(BigInteger.ZERO);
  }
  private static boolean isNonZero(BigInteger n) {
    return !(isZero(n));
  }

  public Period toPeriod() {
    return Period.of(years.intValueExact(), months.intValueExact(), weeks.multiply(BigInteger.valueOf(7L)).add(days).intValueExact());
  }

  public LocalDate addTo(LocalDate date) {
    return date.plus(toPeriod());
  }

  public LocalDate subtractFrom(LocalDate date) {
    return date.minus(toPeriod());
  }

  public DateDeltaValue negate() {
    return new DateDeltaValue(years.negate(), months.negate(), weeks.negate(), days.negate());
  }

  public DateDeltaValue plus(DateDeltaValue delta) {
    return new DateDeltaValue(this.years.add(delta.years), this.months.add(delta.months), this.weeks.add(delta.weeks), this.days.add(delta.days));
  }

  public DateDeltaValue minus(DateDeltaValue delta) {
    return new DateDeltaValue(this.years.subtract(delta.years), this.months.subtract(delta.months), this.weeks.subtract(delta.weeks), this.days.subtract(delta.days));
  }

  public DateDeltaValue multipliedBy(BigInteger factor) {
    return new DateDeltaValue(years.multiply(factor), months.multiply(factor), weeks.multiply(factor), days.multiply(factor));
  }

  public DateDeltaValue dividedBy(BigInteger factor) {
    return new DateDeltaValue(years.divide(factor), months.divide(factor), weeks.divide(factor), days.divide(factor));
  }


  public BigInteger toNumber() {
    if (!(isZero(this.years)) && isZero(this.months) && isZero(this.weeks) && isZero(this.days)) {
      return this.years;
    }
    if (isZero(this.years) && !(isZero(this.months)) && isZero(this.weeks) && isZero(this.days)) {
      return this.months;
    }
    if (isZero(this.years) && isZero(this.months) && !(isZero(this.weeks)) && isZero(this.days)) {
      return this.weeks;
    }
    if (isZero(this.years) && isZero(this.months) && isZero(this.weeks) && !(isZero(this.days))) {
      return this.days;
    }
    throw new RuntimeException("the value " + this.toString() + " is not discrete; cannot return a number.");
  }

  public static final DateDeltaValue ZERO = ofDays(BigInteger.ZERO);

  public static DateDeltaValue ofYears(BigInteger years) {
    return new DateDeltaValue(years, BigInteger.ZERO, BigInteger.ZERO, BigInteger.ZERO);
  }

  public static DateDeltaValue ofMonths(BigInteger months) {
    return new DateDeltaValue(BigInteger.ZERO, months, BigInteger.ZERO, BigInteger.ZERO);
  }

  public static DateDeltaValue ofWeeks(BigInteger weeks) {
    return new DateDeltaValue(BigInteger.ZERO, BigInteger.ZERO, weeks, BigInteger.ZERO);
  }

  public static DateDeltaValue ofDays(BigInteger days) {
    return new DateDeltaValue(BigInteger.ZERO, BigInteger.ZERO, BigInteger.ZERO, days);
  }


  @Override
  public int compareTo(DateDeltaValue value) {
    int yearsComparision = this.years.compareTo(value.years);

    if (yearsComparision != 0) {
      return yearsComparision;
    }

    int monthsComparision = this.months.compareTo(value.months);

    if (monthsComparision != 0) {
      return monthsComparision;
    }

    int weeksComparison = this.weeks.compareTo(value.weeks);

    if (weeksComparison != 0) {
      return weeksComparison;
    }

    int daysComparison = this.days.compareTo(value.days);

    return daysComparison;
  }
}
