package org.iets3.core.expr.plugin.plugin;

/*Generated by MPS */

import org.jetbrains.mps.openapi.module.SModule;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import com.mbeddr.mpsutil.spreferences.runtime.PreferenceModules;
import java.util.Objects;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import org.jetbrains.mps.openapi.language.SConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SContainmentLink;

public class TestExecutionSettings {
  public static ExecutionModePreference getExecutionModePreference(SModule module) {
    SNode tec = SNodeOperations.cast(PreferenceModules.getPreferencesRootInScope(module, "TestExecutionPreferences"), CONCEPTS.TestExecutionConfig$QC);
    ExecutionModePreference userPreference = TestExecutionWorkspaceSetting.getExecutionMode();
    if (!(Objects.equals(userPreference, ExecutionModePreference.NO_PREFERENCE))) {
      return userPreference;
    }
    if (SNodeOperations.isInstanceOf(SLinkOperations.getTarget(tec, LINKS.executionMode$y6nW), CONCEPTS.GeneratorExecutionMode$ha)) {
      return ExecutionModePreference.GENERATOR;
    } else {
      return ExecutionModePreference.INTERPRETER;
    }
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept TestExecutionConfig$QC = MetaAdapterFactory.getConcept(0x2022a47110ba4431L, 0xba5d622df898f3c6L, 0x3e144f9cc1c728afL, "org.iets3.core.expr.testExecution.structure.TestExecutionConfig");
    /*package*/ static final SConcept GeneratorExecutionMode$ha = MetaAdapterFactory.getConcept(0x2022a47110ba4431L, 0xba5d622df898f3c6L, 0x3e144f9cc1c797aaL, "org.iets3.core.expr.testExecution.structure.GeneratorExecutionMode");
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink executionMode$y6nW = MetaAdapterFactory.getContainmentLink(0x2022a47110ba4431L, 0xba5d622df898f3c6L, 0x3e144f9cc1c728afL, 0x3e144f9cc1c79776L, "executionMode");
  }
}
