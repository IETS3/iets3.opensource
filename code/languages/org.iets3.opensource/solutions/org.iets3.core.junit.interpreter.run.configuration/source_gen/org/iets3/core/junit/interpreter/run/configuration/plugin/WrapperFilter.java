package org.iets3.core.junit.interpreter.run.configuration.plugin;

/*Generated by MPS */

import org.jetbrains.mps.openapi.module.SRepository;
import java.util.List;
import jetbrains.mps.baseLanguage.unitTest.execution.client.ITestNodeWrapper;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.baseLanguage.closures.runtime._FunctionTypes;

public class WrapperFilter {

  public static void filterByConcecpt(final SRepository repo, final List<ITestNodeWrapper> given, final SAbstractConcept givenConcept) {
    repo.getModelAccess().runReadAction(() -> dofilterByConcecpt(repo, given, givenConcept));
  }

  /**
   * Currently we assume that all methods in test cases are of concepts 'givenConcept'
   */
  private static List<ITestNodeWrapper> dofilterByConcecpt(final SRepository repo, List<ITestNodeWrapper> given, final SAbstractConcept givenConcept) {
    ListSequence.fromList(given).removeWhere(new _FunctionTypes._return_P1_E0<Boolean, ITestNodeWrapper>() {
      public Boolean invoke(ITestNodeWrapper it) {
        return it.getNodePointer() == null || !(it.getNodePointer().resolve(repo).isInstanceOfConcept(givenConcept));
      }
    });
    return given;
  }


}
