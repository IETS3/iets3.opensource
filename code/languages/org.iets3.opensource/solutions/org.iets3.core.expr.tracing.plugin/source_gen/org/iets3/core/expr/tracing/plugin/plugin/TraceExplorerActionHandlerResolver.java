package org.iets3.core.expr.tracing.plugin.plugin;

/*Generated by MPS */

import org.iets3.core.expr.plugin.plugin.ITraceExplorerAction;
import com.intellij.openapi.project.Project;
import jetbrains.mps.project.MPSProject;
import jetbrains.mps.smodel.structure.ExtensionPoint;
import jetbrains.mps.internal.collections.runtime.Sequence;
import org.jetbrains.mps.openapi.model.SNode;
import com.intellij.openapi.actionSystem.AnActionEvent;

public class TraceExplorerActionHandlerResolver {

  private static ITraceExplorerAction traceExplorer = null;

  public static void resolveTraceExplorer(Project ideaProject, MPSProject mpsProject) {
    if (traceExplorer == null) {
      ExtensionPoint<ITraceExplorerAction> ep = new ExtensionPoint<ITraceExplorerAction>("org.iets3.core.expr.tracing.plugin.TraceExplorerExtensionPoint");
      ITraceExplorerAction action = Sequence.fromIterable(ep.getObjects()).sort((it) -> it.getPriority(), false).first();
      if (action != null) {
        action.initialize(ideaProject, mpsProject);
      } else {
        action = new DefaultTraceExplorerActionHandler();
        action.initialize(ideaProject, mpsProject);
      }
      traceExplorer = action;
    }
  }

  /*package*/ static void setNode(SNode node) {
    if (traceExplorer == null) {
      return;
    }
    traceExplorer.setNode(node);
  }

  /*package*/ static boolean isApplicable(AnActionEvent event) {
    if (traceExplorer == null) {
      return false;
    }
    return traceExplorer.isApplicable(event);
  }

  /*package*/ static void execute(AnActionEvent event) {
    if (traceExplorer == null) {
      return;
    }
    traceExplorer.execute(event);
  }
}
