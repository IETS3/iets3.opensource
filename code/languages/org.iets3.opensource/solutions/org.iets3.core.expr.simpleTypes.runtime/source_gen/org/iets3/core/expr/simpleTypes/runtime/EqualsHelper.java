package org.iets3.core.expr.simpleTypes.runtime;

/*Generated by MPS */

import java.math.BigDecimal;
import java.math.BigInteger;
import java.util.List;
import java.util.Iterator;
import java.util.Objects;
import java.util.Set;
import org.iets3.core.expr.toplevel.plugin.RecordValue;
import org.iets3.core.expr.toplevel.behavior.IRecordDeclaration__BehaviorDescriptor;
import jetbrains.mps.internal.collections.runtime.Sequence;

public class EqualsHelper {

  public static boolean equals(Object act, Object exp) {
    if (act == exp) {
      return true;
    } else if (act == null || exp == null) {
      return false;
    } else {
      if (act instanceof BigDecimal && exp instanceof BigDecimal) {
        BigDecimal bda = ((BigDecimal) act);
        BigDecimal bde = ((BigDecimal) exp);
        return bda.compareTo(bde) == 0;
      }
      if (act instanceof BigInteger && exp instanceof BigInteger) {
        BigInteger bda = ((BigInteger) act);
        BigInteger bde = ((BigInteger) exp);
        return bda.compareTo(bde) == 0;
      }
      if (act instanceof BigDecimal && exp instanceof BigInteger) {
        BigDecimal bda = ((BigDecimal) act);
        BigDecimal bde = new BigDecimal(((BigInteger) exp));
        return bda.compareTo(bde) == 0;
      }
      if (act instanceof BigInteger && exp instanceof BigDecimal) {
        BigDecimal bda = new BigDecimal(((BigInteger) act));
        BigDecimal bde = ((BigDecimal) exp);
        return bda.compareTo(bde) == 0;
      }
      if (act instanceof List && exp instanceof List) {
        Iterator<Object> iter1 = ((List) act).iterator();
        Iterator<Object> iter2 = ((List) exp).iterator();

        while (iter1.hasNext() && iter2.hasNext()) {
          Object obj1 = iter1.next();
          Object obj2 = iter2.next();
          if (!(equals(obj1, obj2))) {
            return false;
          }
        }
        return !(iter1.hasNext()) && !(iter2.hasNext());
      }

      if (act instanceof String && exp instanceof String) {
        return Objects.equals((String) act, (String) exp);
      }

      if (act instanceof Set && exp instanceof Set) {
        Set set1 = (Set) act;
        Set set2 = (Set) exp;

        if (set1.size() != set2.size()) {
          return false;
        }
        for (final Object elem2 : set2) {
          if (set1.stream().allMatch((Object elem1) -> !(EqualsHelper.equals(elem1, elem2)))) {
            return false;
          }
        }
        return true;
      }

      if (act instanceof RecordValue && exp instanceof RecordValue) {
        RecordValue rva = (RecordValue) act;
        RecordValue rve = (RecordValue) exp;

        if (!((boolean) IRecordDeclaration__BehaviorDescriptor.equals_id3i_T7GdgtPy.invoke(rva.recordDeclaration(), rve.recordDeclaration()))) {
          return false;
        }
        if (Sequence.fromIterable(rva.memberNames()).count() != Sequence.fromIterable(rve.memberNames()).count()) {
          return false;
        }
        if (Sequence.fromIterable(rva.memberNames()).disjunction(Sequence.fromIterable(rve.memberNames())).isNotEmpty()) {
          // Record values have values for different members
          return false;
        }

        for (String member : rve.memberNames()) {
          Object expectedMember = rve.getValueByName(member);
          Object actualMember = rva.getValueByName(member);

          if (!(equals(expectedMember, actualMember))) {
            return false;
          }
        }

        return true;
      }
      return act.equals(exp);
    }
  }

  public static boolean notEquals(Object act, Object exp) {
    return !(equals(act, exp));
  }

}
