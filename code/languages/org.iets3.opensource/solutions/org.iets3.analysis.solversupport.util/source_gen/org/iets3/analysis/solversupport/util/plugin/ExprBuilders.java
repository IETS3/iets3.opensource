package org.iets3.analysis.solversupport.util.plugin;

/*Generated by MPS */

import org.jetbrains.mps.openapi.model.SNode;
import java.util.List;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import java.util.ArrayList;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import org.apache.commons.lang3.RandomStringUtils;
import jetbrains.mps.baseLanguage.closures.runtime._FunctionTypes;
import java.util.Optional;
import java.util.function.BinaryOperator;
import jetbrains.mps.smodel.builder.SNodeBuilder;
import org.jetbrains.mps.openapi.language.SConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import org.jetbrains.mps.openapi.language.SProperty;

public class ExprBuilders {
  public static SNode listXor(List<? extends SNode> exprs) {
    return listAnd(Sequence.fromIterable(Sequence.singleton(listOr(exprs))).concat(ListSequence.fromList(notAndExpressions(exprs))).toList());
  }

  private static List<SNode> notAndExpressions(List<? extends SNode> exprs) {
    List<SNode> result = ListSequence.fromList(new ArrayList<>());
    for (int i = 0; i < ListSequence.fromList(exprs).count(); i++) {
      for (int j = i + 1; j < ListSequence.fromList(exprs).count(); j++) {
        SNode makeNandExpression = nand(SNodeOperations.copyNode(ListSequence.fromList(exprs).getElement(i)), SNodeOperations.copyNode(ListSequence.fromList(exprs).getElement(j)));
        ListSequence.fromList(result).addElement(makeNandExpression);
      }
    }
    return result;
  }

  public static SNode nand(SNode left, SNode right) {
    return not(parens(and(left, right)));
  }

  public static SNode nor(SNode left, SNode right) {
    return not(parens(or(left, right)));
  }

  public static SNode parens(SNode expr) {
    return createParensExpression_fzowc6_a0a8(expr);
  }

  public static SNode not(SNode expr) {
    return createLogicalNotExpression_fzowc6_a0a01(expr);
  }

  public static SNode and(SNode left, SNode right) {
    return createLogicalAndExpression_fzowc6_a0a21(left, right);
  }

  public static SNode or(SNode left, SNode right) {
    return createLogicalOrExpression_fzowc6_a0a41(left, right);
  }

  public static SNode trueLiteral() {
    return createTrueLiteral_fzowc6_a0a61();
  }

  public static SNode listToPlus(List<? extends SNode> expressions) {
    return toBinaryExpression(expressions, createNumberLiteral_fzowc6_b0a0s(), (SNode leftIn, SNode rightIn) -> createPlusExpression_fzowc6_a0a2a0a81(leftIn, rightIn));
  }

  public static SNode listOr(List<? extends SNode> exprs) {
    return toBinaryExpression(exprs, ExprBuilders.trueLiteral(), (SNode left, SNode right) -> or(left, right));
  }

  public static SNode listAnd(List<? extends SNode> exprs) {
    return toBinaryExpression(exprs, ExprBuilders.trueLiteral(), (SNode left, SNode right) -> and(left, right));
  }

  public static SNode ifThenElse(SNode iif, SNode then, SNode elsee) {
    return createIfExpression_fzowc6_a0a42(iif, then, createIfElseSection_fzowc6_a0c0a0a42(elsee));
  }

  public static SNode allDifferent(List<? extends SNode> exprs) {
    List<SNode> list = ListSequence.fromList(new ArrayList<SNode>());
    for (int i = 0; i < exprs.size(); i++) {
      for (int j = i + 1; j < exprs.size(); j++) {
        ListSequence.fromList(list).addElement(notEq(exprs.get(i), exprs.get(j)));
      }
    }
    return listAnd(list);
  }

  public static SNode string(String s) {
    return createStringLiteral_fzowc6_a0a82(s);
  }

  public static SNode number(String number) {
    return createNumberLiteral_fzowc6_a0a03(number);
  }

  public static SNode number(int number) {
    return createNumberLiteral_fzowc6_a0a23(String.valueOf(number));
  }

  public static SNode number(double number) {
    return createNumberLiteral_fzowc6_a0a43(String.valueOf(number));
  }

  public static SNode eq(SNode op1, SNode op2) {
    return createEqualsExpression_fzowc6_a0a63(op1, op2);
  }

  public static SNode notEq(SNode op1, SNode op2) {
    return createNotEqualsExpression_fzowc6_a0a83(op1, op2);
  }

  public static SNode ge(SNode op1, SNode op2) {
    return createGreaterEqualsExpression_fzowc6_a0a04(op1, op2);
  }

  public static SNode less(SNode op1, SNode op2) {
    return createLessExpression_fzowc6_a0a24(op1, op2);
  }

  public static SNode lessEq(SNode op1, SNode op2) {
    return createLessEqualsExpression_fzowc6_a0a44(op1, op2);
  }

  public static SNode implies(SNode op1, SNode op2) {
    return createLogicalImpliesExpression_fzowc6_a0a64(op1, op2);
  }

  public static SNode valIfAbsent(SNode n, SNode val) {
    return createOptionOrExpression_fzowc6_a0a84(n, val);
  }

  public static SNode random(int len) {
    String randomAlphanumeric = RandomStringUtils.randomAlphanumeric(len);
    return createStringLiteral_fzowc6_a1a05(randomAlphanumeric);
  }


  private static SNode toBinaryExpression(final List<? extends SNode> exprs, SNode neutralElement, final _FunctionTypes._return_P2_E0<? extends SNode, ? super SNode, ? super SNode> toBinaryExpression) {
    return toSimpleExpression(exprs, neutralElement).orElseGet(() -> toLogicalExpression(exprs, toBinaryExpression));
  }

  private static Optional<SNode> toSimpleExpression(List<? extends SNode> exprs, SNode neutralElement) {
    if (ListSequence.fromList(exprs).isEmpty()) {
      return Optional.<SNode>of(neutralElement);
    }
    if (ListSequence.fromList(exprs).count() == 1) {
      SNode expr = ListSequence.fromList(exprs).getElement(0);
      return Optional.of(expr);
    }
    return Optional.empty();
  }

  private static SNode toLogicalExpression(List<? extends SNode> exprs, _FunctionTypes._return_P2_E0<? extends SNode, ? super SNode, ? super SNode> toBinExpr) {
    if (ListSequence.fromList(exprs).count() <= 1) {
      throw new IllegalArgumentException("At least two elements necessary!");
    }
    SNode rootExpr = toBinExpr.invoke(ListSequence.fromList(exprs).getElement(0), ListSequence.fromList(exprs).getElement(1));
    final BinaryOperator<SNode> toBinOp = toBinaryOperator(toBinExpr);
    return ListSequence.fromList(exprs).subListSequence(2, ListSequence.fromList(exprs).count()).foldLeft(rootExpr, (SNode s, SNode it) -> toBinOp.apply(s, it));
  }

  private static BinaryOperator<SNode> toBinaryOperator(final _FunctionTypes._return_P2_E0<? extends SNode, ? super SNode, ? super SNode> toBinExpr) {
    return new BinaryOperator<SNode>() {
      public SNode apply(SNode accumulator, SNode newItem) {
        return toBinExpr.invoke(accumulator, newItem);
      }
    };
  }
  private static SNode createParensExpression_fzowc6_a0a8(SNode p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.ParensExpression$Tv);
    n0.forChild(LINKS.expr$CW3E).initNode(p0, CONCEPTS.Expression$D_, true);
    return n0.getResult();
  }
  private static SNode createLogicalNotExpression_fzowc6_a0a01(SNode p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.LogicalNotExpression$QD);
    n0.forChild(LINKS.expr$CW3E).initNode(p0, CONCEPTS.Expression$D_, true);
    return n0.getResult();
  }
  private static SNode createLogicalAndExpression_fzowc6_a0a21(SNode p0, SNode p1) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.LogicalAndExpression$m8);
    n0.forChild(LINKS.left$zxUa).initNode(p0, CONCEPTS.Expression$D_, true);
    n0.forChild(LINKS.right$zBjx).initNode(p1, CONCEPTS.Expression$D_, true);
    return n0.getResult();
  }
  private static SNode createLogicalOrExpression_fzowc6_a0a41(SNode p0, SNode p1) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.LogicalOrExpression$J2);
    n0.forChild(LINKS.left$zxUa).initNode(p0, CONCEPTS.Expression$D_, true);
    n0.forChild(LINKS.right$zBjx).initNode(p1, CONCEPTS.Expression$D_, true);
    return n0.getResult();
  }
  private static SNode createTrueLiteral_fzowc6_a0a61() {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.TrueLiteral$_K);
    return n0.getResult();
  }
  private static SNode createNumberLiteral_fzowc6_b0a0s() {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.NumberLiteral$wE);
    n0.setProperty(PROPS.value$iWTK, "0");
    return n0.getResult();
  }
  private static SNode createPlusExpression_fzowc6_a0a2a0a81(SNode p0, SNode p1) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.PlusExpression$mx);
    n0.forChild(LINKS.left$zxUa).initNode(p0, CONCEPTS.Expression$D_, true);
    n0.forChild(LINKS.right$zBjx).initNode(p1, CONCEPTS.Expression$D_, true);
    return n0.getResult();
  }
  private static SNode createIfExpression_fzowc6_a0a42(SNode p0, SNode p1, SNode p2) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.IfExpression$6$);
    n0.forChild(LINKS.condition$bVqa).initNode(p0, CONCEPTS.Expression$D_, true);
    n0.forChild(LINKS.thenPart$bVSc).initNode(p1, CONCEPTS.Expression$D_, true);
    n0.forChild(LINKS.elseSection$kbJ$).initNode(p2, CONCEPTS.IfElseSection$B4, true);
    return n0.getResult();
  }
  private static SNode createIfElseSection_fzowc6_a0c0a0a42(SNode p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.IfElseSection$B4);
    n0.forChild(LINKS.expr$CW3E).initNode(p0, CONCEPTS.Expression$D_, true);
    return n0.getResult();
  }
  private static SNode createStringLiteral_fzowc6_a0a82(String p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.StringLiteral$By);
    n0.setProperty(PROPS.value$zwlK, p0);
    return n0.getResult();
  }
  private static SNode createNumberLiteral_fzowc6_a0a03(String p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.NumberLiteral$wE);
    n0.setProperty(PROPS.value$iWTK, p0);
    return n0.getResult();
  }
  private static SNode createNumberLiteral_fzowc6_a0a23(String p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.NumberLiteral$wE);
    n0.setProperty(PROPS.value$iWTK, p0);
    return n0.getResult();
  }
  private static SNode createNumberLiteral_fzowc6_a0a43(String p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.NumberLiteral$wE);
    n0.setProperty(PROPS.value$iWTK, p0);
    return n0.getResult();
  }
  private static SNode createEqualsExpression_fzowc6_a0a63(SNode p0, SNode p1) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.EqualsExpression$k4);
    n0.forChild(LINKS.left$zxUa).initNode(p0, CONCEPTS.Expression$D_, true);
    n0.forChild(LINKS.right$zBjx).initNode(p1, CONCEPTS.Expression$D_, true);
    return n0.getResult();
  }
  private static SNode createNotEqualsExpression_fzowc6_a0a83(SNode p0, SNode p1) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.NotEqualsExpression$kz);
    n0.forChild(LINKS.left$zxUa).initNode(p0, CONCEPTS.Expression$D_, true);
    n0.forChild(LINKS.right$zBjx).initNode(p1, CONCEPTS.Expression$D_, true);
    return n0.getResult();
  }
  private static SNode createGreaterEqualsExpression_fzowc6_a0a04(SNode p0, SNode p1) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.GreaterEqualsExpression$TY);
    n0.forChild(LINKS.left$zxUa).initNode(p0, CONCEPTS.Expression$D_, true);
    n0.forChild(LINKS.right$zBjx).initNode(p1, CONCEPTS.Expression$D_, true);
    return n0.getResult();
  }
  private static SNode createLessExpression_fzowc6_a0a24(SNode p0, SNode p1) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.LessExpression$4C);
    n0.forChild(LINKS.left$zxUa).initNode(p0, CONCEPTS.Expression$D_, true);
    n0.forChild(LINKS.right$zBjx).initNode(p1, CONCEPTS.Expression$D_, true);
    return n0.getResult();
  }
  private static SNode createLessEqualsExpression_fzowc6_a0a44(SNode p0, SNode p1) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.LessEqualsExpression$57);
    n0.forChild(LINKS.left$zxUa).initNode(p0, CONCEPTS.Expression$D_, true);
    n0.forChild(LINKS.right$zBjx).initNode(p1, CONCEPTS.Expression$D_, true);
    return n0.getResult();
  }
  private static SNode createLogicalImpliesExpression_fzowc6_a0a64(SNode p0, SNode p1) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.LogicalImpliesExpression$87);
    n0.forChild(LINKS.left$zxUa).initNode(p0, CONCEPTS.Expression$D_, true);
    n0.forChild(LINKS.right$zBjx).initNode(p1, CONCEPTS.Expression$D_, true);
    return n0.getResult();
  }
  private static SNode createOptionOrExpression_fzowc6_a0a84(SNode p0, SNode p1) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.OptionOrExpression$lZ);
    n0.forChild(LINKS.left$zxUa).initNode(p0, CONCEPTS.Expression$D_, true);
    n0.forChild(LINKS.right$zBjx).initNode(p1, CONCEPTS.Expression$D_, true);
    return n0.getResult();
  }
  private static SNode createStringLiteral_fzowc6_a1a05(String p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.StringLiteral$By);
    n0.setProperty(PROPS.value$zwlK, p0);
    return n0.getResult();
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept ParensExpression$Tv = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x46ff3b3d86d2f11fL, "org.iets3.core.expr.base.structure.ParensExpression");
    /*package*/ static final SConcept Expression$D_ = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x670d5e92f854a047L, "org.iets3.core.expr.base.structure.Expression");
    /*package*/ static final SConcept LogicalNotExpression$QD = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x46ff3b3d86cd0f6aL, "org.iets3.core.expr.base.structure.LogicalNotExpression");
    /*package*/ static final SConcept LogicalAndExpression$m8 = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x46ff3b3d86cbdd39L, "org.iets3.core.expr.base.structure.LogicalAndExpression");
    /*package*/ static final SConcept LogicalOrExpression$J2 = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x46ff3b3d86cbdcbbL, "org.iets3.core.expr.base.structure.LogicalOrExpression");
    /*package*/ static final SConcept TrueLiteral$_K = MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x670d5e92f854cb59L, "org.iets3.core.expr.simpleTypes.structure.TrueLiteral");
    /*package*/ static final SConcept NumberLiteral$wE = MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x46ff3b3d86d0e6daL, "org.iets3.core.expr.simpleTypes.structure.NumberLiteral");
    /*package*/ static final SConcept PlusExpression$mx = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x46ff3b3d86c9a4f2L, "org.iets3.core.expr.base.structure.PlusExpression");
    /*package*/ static final SConcept IfExpression$6$ = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x6cef3d81a56f626aL, "org.iets3.core.expr.base.structure.IfExpression");
    /*package*/ static final SConcept IfElseSection$B4 = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x86c00f011503ffdL, "org.iets3.core.expr.base.structure.IfElseSection");
    /*package*/ static final SConcept StringLiteral$By = MetaAdapterFactory.getConcept(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x46ff3b3d86d3edc8L, "org.iets3.core.expr.simpleTypes.structure.StringLiteral");
    /*package*/ static final SConcept EqualsExpression$k4 = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x46ff3b3d86cc6dc9L, "org.iets3.core.expr.base.structure.EqualsExpression");
    /*package*/ static final SConcept NotEqualsExpression$kz = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x46ff3b3d86cc6dcaL, "org.iets3.core.expr.base.structure.NotEqualsExpression");
    /*package*/ static final SConcept GreaterEqualsExpression$TY = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x46ff3b3d86cb5011L, "org.iets3.core.expr.base.structure.GreaterEqualsExpression");
    /*package*/ static final SConcept LessExpression$4C = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x46ff3b3d86cb5012L, "org.iets3.core.expr.base.structure.LessExpression");
    /*package*/ static final SConcept LessEqualsExpression$57 = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x46ff3b3d86cb5013L, "org.iets3.core.expr.base.structure.LessEqualsExpression");
    /*package*/ static final SConcept LogicalImpliesExpression$87 = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x15035178cd135185L, "org.iets3.core.expr.base.structure.LogicalImpliesExpression");
    /*package*/ static final SConcept OptionOrExpression$lZ = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x3523822eb4da44aaL, "org.iets3.core.expr.base.structure.OptionOrExpression");
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink expr$CW3E = MetaAdapterFactory.getContainmentLink(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x3b256bb6ae8048d8L, 0x3b256bb6ae8048d9L, "expr");
    /*package*/ static final SContainmentLink left$zxUa = MetaAdapterFactory.getContainmentLink(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x46ff3b3d86c99c15L, 0x46ff3b3d86c99c16L, "left");
    /*package*/ static final SContainmentLink right$zBjx = MetaAdapterFactory.getContainmentLink(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x46ff3b3d86c99c15L, 0x46ff3b3d86c99c18L, "right");
    /*package*/ static final SContainmentLink condition$bVqa = MetaAdapterFactory.getContainmentLink(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x6cef3d81a56f626aL, 0x6cef3d81a56f626bL, "condition");
    /*package*/ static final SContainmentLink thenPart$bVSc = MetaAdapterFactory.getContainmentLink(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x6cef3d81a56f626aL, 0x6cef3d81a56f626dL, "thenPart");
    /*package*/ static final SContainmentLink elseSection$kbJ$ = MetaAdapterFactory.getContainmentLink(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x6cef3d81a56f626aL, 0x86c00f011503ff8L, "elseSection");
  }

  private static final class PROPS {
    /*package*/ static final SProperty value$iWTK = MetaAdapterFactory.getProperty(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x46ff3b3d86d0e6daL, 0x46ff3b3d86d0e6ddL, "value");
    /*package*/ static final SProperty value$zwlK = MetaAdapterFactory.getProperty(0x6b277d9ad52d416fL, 0xa2091919bd737f50L, 0x46ff3b3d86d3edc8L, 0x46ff3b3d86d3edcbL, "value");
  }
}
