package org.iets3.core.expr.mutable.interpreter.plugin;

/*Generated by MPS */

import com.mbeddr.mpsutil.interpreter.rt.InterpreterBase;
import java.util.List;
import com.mbeddr.mpsutil.interpreter.rt.IEvaluator;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import com.mbeddr.mpsutil.interpreter.rt.ConceptEvaluatorBase;
import org.jetbrains.mps.openapi.model.SNode;
import com.mbeddr.mpsutil.interpreter.rt.IContext;
import com.mbeddr.mpsutil.interpreter.rt.ICoverageAnalyzer;
import com.mbeddr.mpsutil.interpreter.rt.ComputationTrace;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.internal.collections.runtime.MapSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import com.mbeddr.mpsutil.interpreter.rt.StopAndReturnException;
import com.mbeddr.mpsutil.interpreter.rt.InterpreterEscapeException;
import com.mbeddr.mpsutil.interpreter.rt.InterpreterRuntimeException;
import com.mbeddr.mpsutil.interpreter.rt.EvaluatorInfo;
import org.iets3.core.expr.mutable.plugin.GlobalClockContainer;
import org.iets3.core.expr.base.behavior.IDotTarget__BehaviorDescriptor;
import org.iets3.core.expr.mutable.plugin.ArtificialClock;
import java.math.BigInteger;
import org.iets3.core.expr.mutable.plugin.AbstractClock;
import org.iets3.core.expr.mutable.plugin.SystemClock;
import org.iets3.core.expr.mutable.plugin.LiveValue;
import org.iets3.core.expr.mutable.plugin.InteractorValue;
import org.iets3.core.expr.base.behavior.IETS3ExprContext;
import jetbrains.mps.baseLanguage.closures.runtime._FunctionTypes;
import com.mbeddr.mpsutil.interpreter.rt.DummyComputationTrace;
import org.iets3.core.expr.mutable.plugin.IDValue;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import org.iets3.core.expr.mutable.plugin.ContextValue;
import org.iets3.core.expr.mutable.plugin.ContextCollector;
import org.iets3.core.expr.mutable.plugin.TranactionContext;
import org.iets3.core.expr.mutable.plugin.IDCommand;
import org.iets3.core.expr.base.plugin.NoneValue;
import org.iets3.core.expr.mutable.plugin.NoActiveTransactionException;
import org.iets3.core.expr.mutable.plugin.Transaction;
import org.iets3.core.expr.base.plugin.SpecificErrorValue;
import org.iets3.core.expr.mutable.plugin.BoxValue;
import java.util.Objects;
import org.iets3.core.expr.mutable.plugin.ContentHasChangedException;
import jetbrains.mps.typechecking.TypecheckingFacade;
import org.iets3.core.expr.base.plugin.TypeConstraintHelper;
import org.iets3.core.expr.base.behavior.Expression__BehaviorDescriptor;
import org.iets3.core.expr.base.plugin.ConstraintFailedException;
import com.mbeddr.mpsutil.interpreter.rt.ITypeMapper;
import com.mbeddr.mpsutil.interpreter.rt.IRelationship;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SConcept;
import org.jetbrains.mps.openapi.language.SProperty;

public class InterpreterExprMutateInterpreter extends InterpreterBase {
  public InterpreterExprMutateInterpreter() {
    init();
  }

  @Override
  public String getCategory() {
    return "arithmetic";
  }

  protected void populateEvaluators(List<? extends IEvaluator> evaluators) {
    ListSequence.fromList(((List<IEvaluator>) evaluators)).addElement(new ConceptEvaluatorBase(CONCEPTS.ContextArgExpr$Nt, "r:fbe318af-2afe-4858-8d66-a206b7f47bc8(org.iets3.core.expr.mutable.interpreter.plugin)/5456956546146487013", true) {
      public Object evaluateEvaluator(SNode node, IContext context, ICoverageAnalyzer coverage, ComputationTrace trace) {
        try {
          coverage.visitedEvaluator(this);
          coverage.visitedConcept(this.concept);
          coverage.visitedConcept(SNodeOperations.getConcept(node));
          return MapSequence.fromMap(context.getEnvironment()).get(SNodeOperations.asNode(SNodeOperations.getConcept(SLinkOperations.getTarget(node, LINKS.arg$fPVm))));
        } catch (StopAndReturnException stop) {
          return stop.value();
        } catch (InterpreterEscapeException ex) {
          throw ex;
        } catch (RuntimeException ex) {
          throw new InterpreterRuntimeException("ContextArgExpr()", node, ex, trace);
        }
      }
      public EvaluatorInfo getInfo() {
        return new EvaluatorInfo("ContextArgExpr", "http://127.0.0.1:63320/node?ref=2ebf29d4-079e-4021-80b1-37de974efa02%2Fi%3A10000001%28org.iets3.core.expr.mutable.interpreter%40transient36%2Forg.iets3.core.expr.mutable.interpreter.plugin%400%29%2F5456956546146487013");
      }

      @Override
      public String toString() {
        return "ContextArgExpr";
      }

      @Override
      public boolean canLookupBeCached() {
        return true;
      }
    });
    ListSequence.fromList(((List<IEvaluator>) evaluators)).addElement(new ConceptEvaluatorBase(CONCEPTS.WithContextExpression$ey, "r:fbe318af-2afe-4858-8d66-a206b7f47bc8(org.iets3.core.expr.mutable.interpreter.plugin)/5456956546146376815", true) {
      public Object evaluateEvaluator(SNode node, IContext context, ICoverageAnalyzer coverage, ComputationTrace trace) {
        try {
          coverage.visitedEvaluator(this);
          coverage.visitedConcept(this.concept);
          coverage.visitedConcept(SNodeOperations.getConcept(node));
          return ((Object) castUp(context.getRootInterpreter().evaluate(SLinkOperations.getTarget(node, LINKS.expr$6zVS), context, coverage, trace, false), Object.class));
        } catch (StopAndReturnException stop) {
          return stop.value();
        } catch (InterpreterEscapeException ex) {
          throw ex;
        } catch (RuntimeException ex) {
          throw new InterpreterRuntimeException("with context()", node, ex, trace);
        }
      }
      public EvaluatorInfo getInfo() {
        return new EvaluatorInfo("WithContextExpression", "http://127.0.0.1:63320/node?ref=2ebf29d4-079e-4021-80b1-37de974efa02%2Fi%3A10000001%28org.iets3.core.expr.mutable.interpreter%40transient36%2Forg.iets3.core.expr.mutable.interpreter.plugin%400%29%2F5456956546146376815");
      }

      @Override
      public String toString() {
        return "WithContextExpression";
      }

      @Override
      public boolean canLookupBeCached() {
        return true;
      }
    });
    ListSequence.fromList(((List<IEvaluator>) evaluators)).addElement(new ConceptEvaluatorBase(CONCEPTS.NowExpression$Ld, "r:fbe318af-2afe-4858-8d66-a206b7f47bc8(org.iets3.core.expr.mutable.interpreter.plugin)/3795092733479569961", true) {
      public Object evaluateEvaluator(SNode node, IContext context, ICoverageAnalyzer coverage, ComputationTrace trace) {
        try {
          coverage.visitedEvaluator(this);
          coverage.visitedConcept(this.concept);
          coverage.visitedConcept(SNodeOperations.getConcept(node));
          return GlobalClockContainer.clock().timeMillis();
        } catch (StopAndReturnException stop) {
          return stop.value();
        } catch (InterpreterEscapeException ex) {
          throw ex;
        } catch (RuntimeException ex) {
          throw new InterpreterRuntimeException("now()", node, ex, trace);
        }
      }
      public EvaluatorInfo getInfo() {
        return new EvaluatorInfo("NowExpression", "http://127.0.0.1:63320/node?ref=2ebf29d4-079e-4021-80b1-37de974efa02%2Fi%3A10000001%28org.iets3.core.expr.mutable.interpreter%40transient36%2Forg.iets3.core.expr.mutable.interpreter.plugin%400%29%2F3795092733479569961");
      }

      @Override
      public String toString() {
        return "NowExpression";
      }

      @Override
      public boolean canLookupBeCached() {
        return true;
      }
    });
    ListSequence.fromList(((List<IEvaluator>) evaluators)).addElement(new ConceptEvaluatorBase(CONCEPTS.AdvanceByTarget$Lh, "r:fbe318af-2afe-4858-8d66-a206b7f47bc8(org.iets3.core.expr.mutable.interpreter.plugin)/3795092733479717397", true) {
      public Object evaluateEvaluator(SNode node, IContext context, ICoverageAnalyzer coverage, ComputationTrace trace) {
        try {
          coverage.visitedEvaluator(this);
          coverage.visitedConcept(this.concept);
          coverage.visitedConcept(SNodeOperations.getConcept(node));
          Object o = MapSequence.fromMap(context.getEnvironment()).get(IDotTarget__BehaviorDescriptor.contextExpression_id6zmBjqUivyF.invoke(node));
          Object v = ((Object) castUp(context.getRootInterpreter().evaluate(SLinkOperations.getTarget(node, LINKS.expr$CW3E), context, coverage, trace, false), Object.class));
          if (o instanceof ArtificialClock && v instanceof BigInteger) {
            ArtificialClock clk = ((ArtificialClock) o);
            clk.advanceBy(((BigInteger) v));
            return clk;
          }
          return null;
        } catch (StopAndReturnException stop) {
          return stop.value();
        } catch (InterpreterEscapeException ex) {
          throw ex;
        } catch (RuntimeException ex) {
          throw new InterpreterRuntimeException("advance()", node, ex, trace);
        }
      }
      public EvaluatorInfo getInfo() {
        return new EvaluatorInfo("AdvanceByTarget", "http://127.0.0.1:63320/node?ref=2ebf29d4-079e-4021-80b1-37de974efa02%2Fi%3A10000001%28org.iets3.core.expr.mutable.interpreter%40transient36%2Forg.iets3.core.expr.mutable.interpreter.plugin%400%29%2F3795092733479717397");
      }

      @Override
      public String toString() {
        return "AdvanceByTarget";
      }

      @Override
      public boolean canLookupBeCached() {
        return true;
      }
    });
    ListSequence.fromList(((List<IEvaluator>) evaluators)).addElement(new ConceptEvaluatorBase(CONCEPTS.TickTarget$9y, "r:fbe318af-2afe-4858-8d66-a206b7f47bc8(org.iets3.core.expr.mutable.interpreter.plugin)/3795092733478979900", true) {
      public Object evaluateEvaluator(SNode node, IContext context, ICoverageAnalyzer coverage, ComputationTrace trace) {
        try {
          coverage.visitedEvaluator(this);
          coverage.visitedConcept(this.concept);
          coverage.visitedConcept(SNodeOperations.getConcept(node));
          Object o = MapSequence.fromMap(context.getEnvironment()).get(IDotTarget__BehaviorDescriptor.contextExpression_id6zmBjqUivyF.invoke(node));
          if (o instanceof ArtificialClock) {
            ArtificialClock clk = ((ArtificialClock) o);
            clk.tick();
            return clk;
          }
          return null;
        } catch (StopAndReturnException stop) {
          return stop.value();
        } catch (InterpreterEscapeException ex) {
          throw ex;
        } catch (RuntimeException ex) {
          throw new InterpreterRuntimeException("tick()", node, ex, trace);
        }
      }
      public EvaluatorInfo getInfo() {
        return new EvaluatorInfo("TickTarget", "http://127.0.0.1:63320/node?ref=2ebf29d4-079e-4021-80b1-37de974efa02%2Fi%3A10000001%28org.iets3.core.expr.mutable.interpreter%40transient36%2Forg.iets3.core.expr.mutable.interpreter.plugin%400%29%2F3795092733478979900");
      }

      @Override
      public String toString() {
        return "TickTarget";
      }

      @Override
      public boolean canLookupBeCached() {
        return true;
      }
    });
    ListSequence.fromList(((List<IEvaluator>) evaluators)).addElement(new ConceptEvaluatorBase(CONCEPTS.GlobalClockPragma$RB, "r:fbe318af-2afe-4858-8d66-a206b7f47bc8(org.iets3.core.expr.mutable.interpreter.plugin)/3795092733478519444", true) {
      public Object evaluateEvaluator(SNode node, IContext context, ICoverageAnalyzer coverage, ComputationTrace trace) {
        try {
          coverage.visitedEvaluator(this);
          coverage.visitedConcept(this.concept);
          coverage.visitedConcept(SNodeOperations.getConcept(node));
          GlobalClockContainer.setClock(((AbstractClock) ((Object) castUp(context.getRootInterpreter().evaluate(SLinkOperations.getTarget(node, LINKS.clock$eo0m), context, coverage, trace, false), Object.class))));
          return ((Object) castUp(context.getRootInterpreter().evaluate(SLinkOperations.getTarget(node, LINKS.expr$CW3E), context, coverage, trace, false), Object.class));
        } catch (StopAndReturnException stop) {
          return stop.value();
        } catch (InterpreterEscapeException ex) {
          throw ex;
        } catch (RuntimeException ex) {
          throw new InterpreterRuntimeException("Â§global-clock()", node, ex, trace);
        }
      }
      public EvaluatorInfo getInfo() {
        return new EvaluatorInfo("GlobalClockPragma", "http://127.0.0.1:63320/node?ref=2ebf29d4-079e-4021-80b1-37de974efa02%2Fi%3A10000001%28org.iets3.core.expr.mutable.interpreter%40transient36%2Forg.iets3.core.expr.mutable.interpreter.plugin%400%29%2F3795092733478519444");
      }

      @Override
      public String toString() {
        return "GlobalClockPragma";
      }

      @Override
      public boolean canLookupBeCached() {
        return true;
      }
    });
    ListSequence.fromList(((List<IEvaluator>) evaluators)).addElement(new ConceptEvaluatorBase(CONCEPTS.CurrentTimeTarget$qP, "r:fbe318af-2afe-4858-8d66-a206b7f47bc8(org.iets3.core.expr.mutable.interpreter.plugin)/3795092733478185480", true) {
      public Object evaluateEvaluator(SNode node, IContext context, ICoverageAnalyzer coverage, ComputationTrace trace) {
        try {
          coverage.visitedEvaluator(this);
          coverage.visitedConcept(this.concept);
          coverage.visitedConcept(SNodeOperations.getConcept(node));
          Object o = MapSequence.fromMap(context.getEnvironment()).get(IDotTarget__BehaviorDescriptor.contextExpression_id6zmBjqUivyF.invoke(node));
          if (o instanceof AbstractClock) {
            return ((AbstractClock) o).timeMillis();
          }
          return null;
        } catch (StopAndReturnException stop) {
          return stop.value();
        } catch (InterpreterEscapeException ex) {
          throw ex;
        } catch (RuntimeException ex) {
          throw new InterpreterRuntimeException("time()", node, ex, trace);
        }
      }
      public EvaluatorInfo getInfo() {
        return new EvaluatorInfo("CurrentTimeTarget", "http://127.0.0.1:63320/node?ref=2ebf29d4-079e-4021-80b1-37de974efa02%2Fi%3A10000001%28org.iets3.core.expr.mutable.interpreter%40transient36%2Forg.iets3.core.expr.mutable.interpreter.plugin%400%29%2F3795092733478185480");
      }

      @Override
      public String toString() {
        return "CurrentTimeTarget";
      }

      @Override
      public boolean canLookupBeCached() {
        return true;
      }
    });
    ListSequence.fromList(((List<IEvaluator>) evaluators)).addElement(new ConceptEvaluatorBase(CONCEPTS.ArtificialClockExpr$mT, "r:fbe318af-2afe-4858-8d66-a206b7f47bc8(org.iets3.core.expr.mutable.interpreter.plugin)/3795092733479279377", true) {
      public Object evaluateEvaluator(SNode node, IContext context, ICoverageAnalyzer coverage, ComputationTrace trace) {
        try {
          coverage.visitedEvaluator(this);
          coverage.visitedConcept(this.concept);
          coverage.visitedConcept(SNodeOperations.getConcept(node));
          return new ArtificialClock((BigInteger) ((Object) castUp(context.getRootInterpreter().evaluate(SLinkOperations.getTarget(node, LINKS.expr$CW3E), context, coverage, trace, false), Object.class)));
        } catch (StopAndReturnException stop) {
          return stop.value();
        } catch (InterpreterEscapeException ex) {
          throw ex;
        } catch (RuntimeException ex) {
          throw new InterpreterRuntimeException("artificialclock()", node, ex, trace);
        }
      }
      public EvaluatorInfo getInfo() {
        return new EvaluatorInfo("ArtificialClockExpr", "http://127.0.0.1:63320/node?ref=2ebf29d4-079e-4021-80b1-37de974efa02%2Fi%3A10000001%28org.iets3.core.expr.mutable.interpreter%40transient36%2Forg.iets3.core.expr.mutable.interpreter.plugin%400%29%2F3795092733479279377");
      }

      @Override
      public String toString() {
        return "ArtificialClockExpr";
      }

      @Override
      public boolean canLookupBeCached() {
        return true;
      }
    });
    ListSequence.fromList(((List<IEvaluator>) evaluators)).addElement(new ConceptEvaluatorBase(CONCEPTS.SystemClockExpr$5d, "r:fbe318af-2afe-4858-8d66-a206b7f47bc8(org.iets3.core.expr.mutable.interpreter.plugin)/3795092733478176525", true) {
      public Object evaluateEvaluator(SNode node, IContext context, ICoverageAnalyzer coverage, ComputationTrace trace) {
        try {
          coverage.visitedEvaluator(this);
          coverage.visitedConcept(this.concept);
          coverage.visitedConcept(SNodeOperations.getConcept(node));
          return new SystemClock();
        } catch (StopAndReturnException stop) {
          return stop.value();
        } catch (InterpreterEscapeException ex) {
          throw ex;
        } catch (RuntimeException ex) {
          throw new InterpreterRuntimeException("systemclock()", node, ex, trace);
        }
      }
      public EvaluatorInfo getInfo() {
        return new EvaluatorInfo("SystemClockExpr", "http://127.0.0.1:63320/node?ref=2ebf29d4-079e-4021-80b1-37de974efa02%2Fi%3A10000001%28org.iets3.core.expr.mutable.interpreter%40transient36%2Forg.iets3.core.expr.mutable.interpreter.plugin%400%29%2F3795092733478176525");
      }

      @Override
      public String toString() {
        return "SystemClockExpr";
      }

      @Override
      public boolean canLookupBeCached() {
        return true;
      }
    });
    ListSequence.fromList(((List<IEvaluator>) evaluators)).addElement(new ConceptEvaluatorBase(CONCEPTS.LiveExpression$9H, "r:fbe318af-2afe-4858-8d66-a206b7f47bc8(org.iets3.core.expr.mutable.interpreter.plugin)/8272305014738274071", true) {
      public Object evaluateEvaluator(final SNode node, IContext context, ICoverageAnalyzer coverage, final ComputationTrace trace) {
        try {
          coverage.visitedEvaluator(this);
          coverage.visitedConcept(this.concept);
          coverage.visitedConcept(SNodeOperations.getConcept(node));
          Object contained = ((Object) castUp(context.getRootInterpreter().evaluate(SLinkOperations.getTarget(node, LINKS.expr$CW3E), context, coverage, trace, false), Object.class));
          LiveValue live = new LiveValue((InteractorValue) contained, context);
          live.prepareSnapshot((IETS3ExprContext) context, coverage, ((_FunctionTypes._return_P0_E0<ComputationTrace>) () -> {
            if (trace != null) {
              return trace;
            } else {
              return new DummyComputationTrace(node);
            }
          }).invoke());
          return live;
        } catch (StopAndReturnException stop) {
          return stop.value();
        } catch (InterpreterEscapeException ex) {
          throw ex;
        } catch (RuntimeException ex) {
          throw new InterpreterRuntimeException("live()", node, ex, trace);
        }
      }
      public EvaluatorInfo getInfo() {
        return new EvaluatorInfo("LiveExpression", "http://127.0.0.1:63320/node?ref=2ebf29d4-079e-4021-80b1-37de974efa02%2Fi%3A10000001%28org.iets3.core.expr.mutable.interpreter%40transient36%2Forg.iets3.core.expr.mutable.interpreter.plugin%400%29%2F8272305014738274071");
      }

      @Override
      public String toString() {
        return "LiveExpression";
      }

      @Override
      public boolean canLookupBeCached() {
        return true;
      }
    });
    ListSequence.fromList(((List<IEvaluator>) evaluators)).addElement(new ConceptEvaluatorBase(CONCEPTS.InteractorValueTarget$97, "r:fbe318af-2afe-4858-8d66-a206b7f47bc8(org.iets3.core.expr.mutable.interpreter.plugin)/1136100386040243042", true) {
      public Object evaluateEvaluator(final SNode node, IContext context, ICoverageAnalyzer coverage, final ComputationTrace trace) {
        try {
          coverage.visitedEvaluator(this);
          coverage.visitedConcept(this.concept);
          coverage.visitedConcept(SNodeOperations.getConcept(node));
          Object o = MapSequence.fromMap(context.getEnvironment()).get(IDotTarget__BehaviorDescriptor.contextExpression_id6zmBjqUivyF.invoke(node));
          if (o instanceof InteractorValue) {
            InteractorValue iv = (InteractorValue) o;
            IDValue v = Sequence.fromIterable(iv.getDescriptor().values()).findFirst((it) -> it.name.equals(SPropertyOperations.getString(node, PROPS.value$ZaAF)));
            Iterable<ContextValue> contextArgs = ContextCollector.collect(node, context, ((_FunctionTypes._return_P0_E0<ComputationTrace>) () -> {
              if (trace != null) {
                return trace;
              } else {
                return new DummyComputationTrace(node);
              }
            }).invoke());
            for (ContextValue cv : Sequence.fromIterable(contextArgs)) {
              MapSequence.fromMap(context.getEnvironment()).put(SNodeOperations.asNode(SNodeOperations.getConcept(cv.arg)), cv.value);
            }
            return iv.handleElement(v, null, Sequence.fromIterable(contextArgs).toList(), (IETS3ExprContext) context, coverage, ((_FunctionTypes._return_P0_E0<ComputationTrace>) () -> {
              if (trace != null) {
                return trace;
              } else {
                return new DummyComputationTrace(node);
              }
            }).invoke());
          }
          return null;
        } catch (StopAndReturnException stop) {
          return stop.value();
        } catch (InterpreterEscapeException ex) {
          throw ex;
        } catch (RuntimeException ex) {
          throw new InterpreterRuntimeException("InteractorValueTarget()", node, ex, trace);
        }
      }
      public EvaluatorInfo getInfo() {
        return new EvaluatorInfo("InteractorValueTarget", "http://127.0.0.1:63320/node?ref=2ebf29d4-079e-4021-80b1-37de974efa02%2Fi%3A10000001%28org.iets3.core.expr.mutable.interpreter%40transient36%2Forg.iets3.core.expr.mutable.interpreter.plugin%400%29%2F1136100386040243042");
      }

      @Override
      public String toString() {
        return "InteractorValueTarget";
      }

      @Override
      public boolean canLookupBeCached() {
        return true;
      }
    });
    ListSequence.fromList(((List<IEvaluator>) evaluators)).addElement(new ConceptEvaluatorBase(CONCEPTS.InteractorCommandTarget$GV, "r:fbe318af-2afe-4858-8d66-a206b7f47bc8(org.iets3.core.expr.mutable.interpreter.plugin)/1136100386040232454", true) {
      public Object evaluateEvaluator(final SNode node, final IContext context, final ICoverageAnalyzer coverage, final ComputationTrace trace) {
        try {
          coverage.visitedEvaluator(this);
          coverage.visitedConcept(this.concept);
          coverage.visitedConcept(SNodeOperations.getConcept(node));
          Object o = MapSequence.fromMap(context.getEnvironment()).get(IDotTarget__BehaviorDescriptor.contextExpression_id6zmBjqUivyF.invoke(node));
          if (o instanceof InteractorValue) {
            InteractorValue iv = (InteractorValue) o;
            TranactionContext.registerWithCurrentTx(context.getEnvironment(), iv);
            IDCommand command = Sequence.fromIterable(iv.getDescriptor().commands()).findFirst((it) -> it.name.equals(SPropertyOperations.getString(node, PROPS.command$ndav)));
            List<Object> evaledArgs = Sequence.fromIterable((ListSequence.fromList(SLinkOperations.getChildren(node, LINKS.args$KTc5)).select((it) -> (context.getRootInterpreter().evaluate(it, context, coverage, trace, false))))).toList();
            Iterable<ContextValue> contextArgs = ContextCollector.collect(node, context, ((_FunctionTypes._return_P0_E0<ComputationTrace>) () -> {
              if (trace != null) {
                return trace;
              } else {
                return new DummyComputationTrace(node);
              }
            }).invoke());
            for (ContextValue cv : Sequence.fromIterable(contextArgs)) {
              MapSequence.fromMap(context.getEnvironment()).put(SNodeOperations.asNode(SNodeOperations.getConcept(cv.arg)), cv.value);
            }
            Object res = iv.handleElement(command, evaledArgs, Sequence.fromIterable(contextArgs).toList(), (IETS3ExprContext) context, coverage, ((_FunctionTypes._return_P0_E0<ComputationTrace>) () -> {
              if (trace != null) {
                return trace;
              } else {
                return new DummyComputationTrace(node);
              }
            }).invoke());
            if (res == null) {
              return new NoneValue();
            }
            return res;
          }
          return null;
        } catch (StopAndReturnException stop) {
          return stop.value();
        } catch (InterpreterEscapeException ex) {
          throw ex;
        } catch (RuntimeException ex) {
          throw new InterpreterRuntimeException("InteractorCommandTarget()", node, ex, trace);
        }
      }
      public EvaluatorInfo getInfo() {
        return new EvaluatorInfo("InteractorCommandTarget", "http://127.0.0.1:63320/node?ref=2ebf29d4-079e-4021-80b1-37de974efa02%2Fi%3A10000001%28org.iets3.core.expr.mutable.interpreter%40transient36%2Forg.iets3.core.expr.mutable.interpreter.plugin%400%29%2F1136100386040232454");
      }

      @Override
      public String toString() {
        return "InteractorCommandTarget";
      }

      @Override
      public boolean canLookupBeCached() {
        return true;
      }
    });
    ListSequence.fromList(((List<IEvaluator>) evaluators)).addElement(new ConceptEvaluatorBase(CONCEPTS.InTxBlock$fa, "r:fbe318af-2afe-4858-8d66-a206b7f47bc8(org.iets3.core.expr.mutable.interpreter.plugin)/2153658728442743508", true) {
      public Object evaluateEvaluator(final SNode node, IContext context, ICoverageAnalyzer coverage, final ComputationTrace trace) {
        try {
          coverage.visitedEvaluator(this);
          coverage.visitedConcept(this.concept);
          coverage.visitedConcept(SNodeOperations.getConcept(node));
          if (!(TranactionContext.isTxActive(context.getEnvironment()))) {
            throw new NoActiveTransactionException(node, context, ((_FunctionTypes._return_P0_E0<ComputationTrace>) () -> {
              if (trace != null) {
                return trace;
              } else {
                return new DummyComputationTrace(node);
              }
            }).invoke());
          }
          return ((Object) castUp(context.getRootInterpreter().evaluate(SLinkOperations.getTarget(node, LINKS.body$OzSD), context, coverage, trace, false), Object.class));
        } catch (StopAndReturnException stop) {
          return stop.value();
        } catch (InterpreterEscapeException ex) {
          throw ex;
        } catch (RuntimeException ex) {
          throw new InterpreterRuntimeException("intx()", node, ex, trace);
        }
      }
      public EvaluatorInfo getInfo() {
        return new EvaluatorInfo("InTxBlock", "http://127.0.0.1:63320/node?ref=2ebf29d4-079e-4021-80b1-37de974efa02%2Fi%3A10000001%28org.iets3.core.expr.mutable.interpreter%40transient36%2Forg.iets3.core.expr.mutable.interpreter.plugin%400%29%2F2153658728442743508");
      }

      @Override
      public String toString() {
        return "InTxBlock";
      }

      @Override
      public boolean canLookupBeCached() {
        return true;
      }
    });
    ListSequence.fromList(((List<IEvaluator>) evaluators)).addElement(new ConceptEvaluatorBase(CONCEPTS.NewTxBlock$YR, "r:fbe318af-2afe-4858-8d66-a206b7f47bc8(org.iets3.core.expr.mutable.interpreter.plugin)/4255172619715965647", true) {
      public Object evaluateEvaluator(SNode node, IContext context, ICoverageAnalyzer coverage, ComputationTrace trace) {
        try {
          coverage.visitedEvaluator(this);
          coverage.visitedConcept(this.concept);
          coverage.visitedConcept(SNodeOperations.getConcept(node));
          Transaction tx = new Transaction(node);
          MapSequence.fromMap(context.getEnvironment()).put(Transaction.KEY, tx);
          Object res = null;
          try {
            res = ((Object) castUp(context.getRootInterpreter().evaluate(SLinkOperations.getTarget(node, LINKS.body$lrCm), context, coverage, trace, false), Object.class));
            tx.commit();
            return res;
          } catch (InterpreterEscapeException ex) {
            tx.rollback();
            return new SpecificErrorValue("failed");
          } finally {
            MapSequence.fromMap(context.getEnvironment()).put(Transaction.KEY, null);
          }
        } catch (StopAndReturnException stop) {
          return stop.value();
        } catch (InterpreterEscapeException ex) {
          throw ex;
        } catch (RuntimeException ex) {
          throw new InterpreterRuntimeException("newtx()", node, ex, trace);
        }
      }
      public EvaluatorInfo getInfo() {
        return new EvaluatorInfo("NewTxBlock", "http://127.0.0.1:63320/node?ref=2ebf29d4-079e-4021-80b1-37de974efa02%2Fi%3A10000001%28org.iets3.core.expr.mutable.interpreter%40transient36%2Forg.iets3.core.expr.mutable.interpreter.plugin%400%29%2F4255172619715965647");
      }

      @Override
      public String toString() {
        return "NewTxBlock";
      }

      @Override
      public boolean canLookupBeCached() {
        return true;
      }
    });
    ListSequence.fromList(((List<IEvaluator>) evaluators)).addElement(new ConceptEvaluatorBase(CONCEPTS.UpdateItExpression$4a, "r:fbe318af-2afe-4858-8d66-a206b7f47bc8(org.iets3.core.expr.mutable.interpreter.plugin)/4255172619715463447", true) {
      public Object evaluateEvaluator(SNode node, IContext context, ICoverageAnalyzer coverage, ComputationTrace trace) {
        try {
          coverage.visitedEvaluator(this);
          coverage.visitedConcept(this.concept);
          coverage.visitedConcept(SNodeOperations.getConcept(node));
          Object o = MapSequence.fromMap(context.getEnvironment()).get(IDotTarget__BehaviorDescriptor.contextExpression_id6zmBjqUivyF.invoke(SNodeOperations.getNodeAncestor(node, CONCEPTS.BoxUpdateTarget$$K, false, false)));
          if (o instanceof BoxValue) {
            return ((BoxValue) o).getValue();
          }
          return null;
        } catch (StopAndReturnException stop) {
          return stop.value();
        } catch (InterpreterEscapeException ex) {
          throw ex;
        } catch (RuntimeException ex) {
          throw new InterpreterRuntimeException("it()", node, ex, trace);
        }
      }
      public EvaluatorInfo getInfo() {
        return new EvaluatorInfo("UpdateItExpression", "http://127.0.0.1:63320/node?ref=2ebf29d4-079e-4021-80b1-37de974efa02%2Fi%3A10000001%28org.iets3.core.expr.mutable.interpreter%40transient36%2Forg.iets3.core.expr.mutable.interpreter.plugin%400%29%2F4255172619715463447");
      }

      @Override
      public String toString() {
        return "UpdateItExpression";
      }

      @Override
      public boolean canLookupBeCached() {
        return true;
      }
    });
    ListSequence.fromList(((List<IEvaluator>) evaluators)).addElement(new ConceptEvaluatorBase(CONCEPTS.BoxExpression$VK, "r:fbe318af-2afe-4858-8d66-a206b7f47bc8(org.iets3.core.expr.mutable.interpreter.plugin)/4255172619711206420", true) {
      public Object evaluateEvaluator(SNode node, IContext context, ICoverageAnalyzer coverage, ComputationTrace trace) {
        try {
          coverage.visitedEvaluator(this);
          coverage.visitedConcept(this.concept);
          coverage.visitedConcept(SNodeOperations.getConcept(node));
          return new BoxValue(((Object) castUp(context.getRootInterpreter().evaluate(SLinkOperations.getTarget(node, LINKS.expr$CW3E), context, coverage, trace, false), Object.class)));
        } catch (StopAndReturnException stop) {
          return stop.value();
        } catch (InterpreterEscapeException ex) {
          throw ex;
        } catch (RuntimeException ex) {
          throw new InterpreterRuntimeException("box()", node, ex, trace);
        }
      }
      public EvaluatorInfo getInfo() {
        return new EvaluatorInfo("BoxExpression", "http://127.0.0.1:63320/node?ref=2ebf29d4-079e-4021-80b1-37de974efa02%2Fi%3A10000001%28org.iets3.core.expr.mutable.interpreter%40transient36%2Forg.iets3.core.expr.mutable.interpreter.plugin%400%29%2F4255172619711206420");
      }

      @Override
      public String toString() {
        return "BoxExpression";
      }

      @Override
      public boolean canLookupBeCached() {
        return true;
      }
    });
    ListSequence.fromList(((List<IEvaluator>) evaluators)).addElement(new ConceptEvaluatorBase(CONCEPTS.BoxValueTarget$sF, "r:fbe318af-2afe-4858-8d66-a206b7f47bc8(org.iets3.core.expr.mutable.interpreter.plugin)/4255172619711201187", true) {
      public Object evaluateEvaluator(SNode node, IContext context, ICoverageAnalyzer coverage, ComputationTrace trace) {
        try {
          coverage.visitedEvaluator(this);
          coverage.visitedConcept(this.concept);
          coverage.visitedConcept(SNodeOperations.getConcept(node));
          Object o = MapSequence.fromMap(context.getEnvironment()).get(IDotTarget__BehaviorDescriptor.contextExpression_id6zmBjqUivyF.invoke(node));
          if (o instanceof BoxValue) {
            return ((BoxValue) o).getValue();
          }
          return null;
        } catch (StopAndReturnException stop) {
          return stop.value();
        } catch (InterpreterEscapeException ex) {
          throw ex;
        } catch (RuntimeException ex) {
          throw new InterpreterRuntimeException("val()", node, ex, trace);
        }
      }
      public EvaluatorInfo getInfo() {
        return new EvaluatorInfo("BoxValueTarget", "http://127.0.0.1:63320/node?ref=2ebf29d4-079e-4021-80b1-37de974efa02%2Fi%3A10000001%28org.iets3.core.expr.mutable.interpreter%40transient36%2Forg.iets3.core.expr.mutable.interpreter.plugin%400%29%2F4255172619711201187");
      }

      @Override
      public String toString() {
        return "BoxValueTarget";
      }

      @Override
      public boolean canLookupBeCached() {
        return true;
      }
    });
    ListSequence.fromList(((List<IEvaluator>) evaluators)).addElement(new ConceptEvaluatorBase(CONCEPTS.BoxUpdateTarget$$K, "r:fbe318af-2afe-4858-8d66-a206b7f47bc8(org.iets3.core.expr.mutable.interpreter.plugin)/4255172619711281950", true) {
      public Object evaluateEvaluator(final SNode node, IContext context, ICoverageAnalyzer coverage, final ComputationTrace trace) {
        try {
          coverage.visitedEvaluator(this);
          coverage.visitedConcept(this.concept);
          coverage.visitedConcept(SNodeOperations.getConcept(node));
          Object o = MapSequence.fromMap(context.getEnvironment()).get(IDotTarget__BehaviorDescriptor.contextExpression_id6zmBjqUivyF.invoke(node));
          if (o instanceof BoxValue) {
            BoxValue box = ((BoxValue) o);
            TranactionContext.registerWithCurrentTx(context.getEnvironment(), box);
            if (SLinkOperations.getTarget(node, LINKS.currency$Sx$I) != null) {
              Object expected = context.getRootInterpreter().evaluate(SLinkOperations.getTarget(SLinkOperations.getTarget(node, LINKS.currency$Sx$I), LINKS.expr$CW3E), context, coverage, trace, false);
              if (!(Objects.equals(box.getValue(), expected))) {
                throw new ContentHasChangedException(SNodeOperations.cast(SNodeOperations.getParent(node), CONCEPTS.Expression$D_), context, ((_FunctionTypes._return_P0_E0<ComputationTrace>) () -> {
                  if (trace != null) {
                    return trace;
                  } else {
                    return new DummyComputationTrace(node);
                  }
                }).invoke());
              }
            }
            Object v = ((Object) castUp(context.getRootInterpreter().evaluate(SLinkOperations.getTarget(node, LINKS.expr$CW3E), context, coverage, trace, false), Object.class));
            SNode typeWithConstraints = SLinkOperations.getTarget(SNodeOperations.cast(TypecheckingFacade.getFromContext().getTypeOf(IDotTarget__BehaviorDescriptor.contextExpression_id6zmBjqUivyF.invoke(node)), CONCEPTS.BoxType$Bc), LINKS.baseType$ofMQ);
            TypeConstraintHelper.isValidFatal(typeWithConstraints, Expression__BehaviorDescriptor.renderReadable_id4Y0vh0cfqjE.invoke(SLinkOperations.getTarget(node, LINKS.expr$CW3E)), v, context, ConstraintFailedException.PLAIN, coverage, ((_FunctionTypes._return_P0_E0<ComputationTrace>) () -> {
              if (trace != null) {
                return trace;
              } else {
                return new DummyComputationTrace(node);
              }
            }).invoke());
            box.setValue(v);
            return v;
          }
          return null;
        } catch (StopAndReturnException stop) {
          return stop.value();
        } catch (InterpreterEscapeException ex) {
          throw ex;
        } catch (RuntimeException ex) {
          throw new InterpreterRuntimeException("update()", node, ex, trace);
        }
      }
      public EvaluatorInfo getInfo() {
        return new EvaluatorInfo("BoxUpdateTarget", "http://127.0.0.1:63320/node?ref=2ebf29d4-079e-4021-80b1-37de974efa02%2Fi%3A10000001%28org.iets3.core.expr.mutable.interpreter%40transient36%2Forg.iets3.core.expr.mutable.interpreter.plugin%400%29%2F4255172619711281950");
      }

      @Override
      public String toString() {
        return "BoxUpdateTarget";
      }

      @Override
      public boolean canLookupBeCached() {
        return true;
      }
    });
  }


  protected void populateTypeMappers(List<? extends ITypeMapper> typeMappers) {
  }



  protected void populateRelationships(List<? extends IRelationship> relationships) {
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink arg$fPVm = MetaAdapterFactory.getContainmentLink(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x4bbb011107b0c81cL, 0x4bbb011107b0c81dL, "arg");
    /*package*/ static final SContainmentLink expr$6zVS = MetaAdapterFactory.getContainmentLink(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x4bbb011107bcb0f0L, 0x4bbb011107bcb0f3L, "expr");
    /*package*/ static final SContainmentLink expr$CW3E = MetaAdapterFactory.getContainmentLink(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x3b256bb6ae8048d8L, 0x3b256bb6ae8048d9L, "expr");
    /*package*/ static final SContainmentLink clock$eo0m = MetaAdapterFactory.getContainmentLink(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x34aae0bbdca66966L, 0x34aae0bbdca66967L, "clock");
    /*package*/ static final SContainmentLink args$KTc5 = MetaAdapterFactory.getContainmentLink(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x7f2b47dbd5e22e64L, 0xfc43d48232ade9eL, "args");
    /*package*/ static final SContainmentLink body$OzSD = MetaAdapterFactory.getContainmentLink(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x1de35533f43fa62dL, 0x3b0d68f3e822d911L, "body");
    /*package*/ static final SContainmentLink body$lrCm = MetaAdapterFactory.getContainmentLink(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x3b0d68f3e822d910L, 0x3b0d68f3e822d911L, "body");
    /*package*/ static final SContainmentLink currency$Sx$I = MetaAdapterFactory.getContainmentLink(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x3b0d68f3e7dbeae2L, 0x3067c5830d059de5L, "currency");
    /*package*/ static final SContainmentLink baseType$ofMQ = MetaAdapterFactory.getContainmentLink(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x3b0d68f3e7c18996L, 0x3b0d68f3e7c18997L, "baseType");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept ContextArgExpr$Nt = MetaAdapterFactory.getConcept(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x4bbb011107b0c81cL, "org.iets3.core.expr.mutable.structure.ContextArgExpr");
    /*package*/ static final SConcept WithContextExpression$ey = MetaAdapterFactory.getConcept(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x4bbb011107bcb0f0L, "org.iets3.core.expr.mutable.structure.WithContextExpression");
    /*package*/ static final SConcept NowExpression$Ld = MetaAdapterFactory.getConcept(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x34aae0bbdcb72740L, "org.iets3.core.expr.mutable.structure.NowExpression");
    /*package*/ static final SConcept AdvanceByTarget$Lh = MetaAdapterFactory.getConcept(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x34aae0bbdcb95902L, "org.iets3.core.expr.mutable.structure.AdvanceByTarget");
    /*package*/ static final SConcept TickTarget$9y = MetaAdapterFactory.getConcept(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x34aae0bbdcadf7e0L, "org.iets3.core.expr.mutable.structure.TickTarget");
    /*package*/ static final SConcept GlobalClockPragma$RB = MetaAdapterFactory.getConcept(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x34aae0bbdca66966L, "org.iets3.core.expr.mutable.structure.GlobalClockPragma");
    /*package*/ static final SConcept CurrentTimeTarget$qP = MetaAdapterFactory.getConcept(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x34aae0bbdca1af63L, "org.iets3.core.expr.mutable.structure.CurrentTimeTarget");
    /*package*/ static final SConcept ArtificialClockExpr$mT = MetaAdapterFactory.getConcept(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x34aae0bbdcabe63cL, "org.iets3.core.expr.mutable.structure.ArtificialClockExpr");
    /*package*/ static final SConcept SystemClockExpr$5d = MetaAdapterFactory.getConcept(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x34aae0bbdca1dad1L, "org.iets3.core.expr.mutable.structure.SystemClockExpr");
    /*package*/ static final SConcept LiveExpression$9H = MetaAdapterFactory.getConcept(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x72cd2195151deac5L, "org.iets3.core.expr.mutable.structure.LiveExpression");
    /*package*/ static final SConcept InteractorValueTarget$97 = MetaAdapterFactory.getConcept(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0xfc43d48231b3c65L, "org.iets3.core.expr.mutable.structure.InteractorValueTarget");
    /*package*/ static final SConcept InteractorCommandTarget$GV = MetaAdapterFactory.getConcept(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x7f2b47dbd5e22e64L, "org.iets3.core.expr.mutable.structure.InteractorCommandTarget");
    /*package*/ static final SConcept InTxBlock$fa = MetaAdapterFactory.getConcept(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x1de35533f43fa62dL, "org.iets3.core.expr.mutable.structure.InTxBlock");
    /*package*/ static final SConcept NewTxBlock$YR = MetaAdapterFactory.getConcept(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x3b0d68f3e822d910L, "org.iets3.core.expr.mutable.structure.NewTxBlock");
    /*package*/ static final SConcept BoxUpdateTarget$$K = MetaAdapterFactory.getConcept(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x3b0d68f3e7dbeae2L, "org.iets3.core.expr.mutable.structure.BoxUpdateTarget");
    /*package*/ static final SConcept UpdateItExpression$4a = MetaAdapterFactory.getConcept(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x3b0d68f3e81b1540L, "org.iets3.core.expr.mutable.structure.UpdateItExpression");
    /*package*/ static final SConcept BoxExpression$VK = MetaAdapterFactory.getConcept(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x3b0d68f3e7d3b81eL, "org.iets3.core.expr.mutable.structure.BoxExpression");
    /*package*/ static final SConcept BoxValueTarget$sF = MetaAdapterFactory.getConcept(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x3b0d68f3e7d54368L, "org.iets3.core.expr.mutable.structure.BoxValueTarget");
    /*package*/ static final SConcept Expression$D_ = MetaAdapterFactory.getConcept(0xcfaa4966b7d54b69L, 0xb66a309a6e1a7290L, 0x670d5e92f854a047L, "org.iets3.core.expr.base.structure.Expression");
    /*package*/ static final SConcept BoxType$Bc = MetaAdapterFactory.getConcept(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x3b0d68f3e7c18996L, "org.iets3.core.expr.mutable.structure.BoxType");
  }

  private static final class PROPS {
    /*package*/ static final SProperty value$ZaAF = MetaAdapterFactory.getProperty(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0xfc43d48231b3c65L, 0x7f2b47dbd5e230aaL, "value");
    /*package*/ static final SProperty command$ndav = MetaAdapterFactory.getProperty(0xfbba51185fc649ffL, 0x9c3b0b4469830440L, 0x7f2b47dbd5e22e64L, 0x7f2b47dbd5e230aaL, "command");
  }
}
