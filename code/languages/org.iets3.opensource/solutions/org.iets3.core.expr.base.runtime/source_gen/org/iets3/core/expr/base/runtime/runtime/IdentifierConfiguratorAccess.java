package org.iets3.core.expr.base.runtime.runtime;

/*Generated by MPS */

import org.iets3.core.expr.base.plugin.IdentifierConfigurator;
import jetbrains.mps.smodel.structure.ExtensionPoint;
import jetbrains.mps.internal.collections.runtime.Sequence;
import org.iets3.core.expr.base.plugin.DefaultIdentifierConfigurator;
import org.jetbrains.mps.openapi.language.SAbstractConcept;

public class IdentifierConfiguratorAccess {
  private static IdentifierConfigurator identConfig = null;

  /**
   * This method will chose from the available Extension Point (EP) implementations the one with the highest priority or fall back to the DefaultIdentifierConfigurator implementation
   * 
   * @return IdentifierConfigurator, the EP implementation with the highest priority or the DefaultIdentifierConfigurator as fall back
   */
  public static IdentifierConfigurator resolveIdentConfig() {
    if (IdentifierConfiguratorAccess.identConfig == null) {
      ExtensionPoint<IdentifierConfigurator> ep = new ExtensionPoint<IdentifierConfigurator>("org.iets3.core.expr.base.identifierConfigurator");
      IdentifierConfigurator config = Sequence.fromIterable(ep.getObjects()).sort((it) -> it.getPriorityLevel(), false).first();
      if (config == null) {
        IdentifierConfiguratorAccess.identConfig = new DefaultIdentifierConfigurator();
      } else {
        IdentifierConfiguratorAccess.identConfig = config;
      }
    }
    return IdentifierConfiguratorAccess.identConfig;
  }

  public static boolean allowUmlautsInIdentifiers(SAbstractConcept concept) {
    return IdentifierConfiguratorAccess.resolveIdentConfig().allowUmlautsInIdentifiers(concept);
  }

  public static boolean allowParagraphsInIdentifiers(SAbstractConcept concept) {
    return IdentifierConfiguratorAccess.resolveIdentConfig().allowParagraphsInIdentifiers(concept);
  }

  /**
   * This method is only intended for testing purposes!
   * 
   * It allows to reset the chosen ExtensionPoint implementation for the EP identifierConfigurator
   * For more information see TestingIdentifierConfiguratorEP: 
   * http://127.0.0.1:63320/node?ref=r%3A6a32786e-0823-4465-b671-9705159d21d5%28test.in.expr.os.messages%40tests%29%2F3338854161630853284
   */
  public static void reset() {
    identConfig = null;
  }
}
